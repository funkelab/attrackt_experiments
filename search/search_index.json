{"config":{"lang":["en"],"separator":"[\\s\\u200b\\-_,:!=\\[\\]()\"`/]+|\\.(?!\\d)|&[lg]t;|(?!\\b)(?=[A-Z][a-z])","pipeline":["stopWordFilter"]},"docs":[{"location":"examples/Bacteria/01-preprocessing/","title":"01 \u2013 Preprocessing Data","text":"In\u00a0[1]: Copied! <pre>from attrackt.scripts import extract_data, create_zarr, create_csv\nfrom attrackt.scripts.motile import motile_infer\nfrom attrackt.scripts.cumulate_scores import cumulate_scores\n</pre> from attrackt.scripts import extract_data, create_zarr, create_csv from attrackt.scripts.motile import motile_infer from attrackt.scripts.cumulate_scores import cumulate_scores In\u00a0[2]: Copied! <pre>suffix = \"Bacteria-v1\"  # just a string placeholder to identify the results, in case running multiple experiments. You can modify as needed.\ndata_dir = \"./data/Bacteria/\"\nzip_url = \"https://drive.google.com/uc?id=1OUj5LtG8SGJZN_M6g63SVs6_54O7oFEK\"\n</pre> suffix = \"Bacteria-v1\"  # just a string placeholder to identify the results, in case running multiple experiments. You can modify as needed. data_dir = \"./data/Bacteria/\" zip_url = \"https://drive.google.com/uc?id=1OUj5LtG8SGJZN_M6g63SVs6_54O7oFEK\" In\u00a0[3]: Copied! <pre>extract_data(\n    zip_url=zip_url,\n    data_dir=data_dir,\n)\n</pre> extract_data(     zip_url=zip_url,     data_dir=data_dir, ) <pre>INFO:root:Directory already exists at data/Bacteria\n</pre> In\u00a0[4]: Copied! <pre>detections_csv_file_name = data_dir + \"/detections.csv\"\nsequence_names = [\n    \"140408-02\",\n    \"140408-04\",\n    \"140408-10\",\n    \"140409-03\",\n    \"140415-08\",\n    \"151027-05\",\n    \"151027-06\",\n    \"151027-10\",\n    \"151028-01\",\n    \"151029-05\",\n    \"151029-11\",\n    \"151029_E1-6\",\n    \"151101_E2-1\",\n    \"151101_E2-2\",\n    \"151101_E3-11\",\n    \"151101_E4-12\",\n    \"151101_E4-19\",\n    \"151101_E4-20\",\n    \"150317-07\",\n    \"150318-06\",\n    \"150331-12\",\n    \"151222-10\",\n    \"151222-11\",\n    \"150324-03\",\n    \"150324-05\",\n    \"150325-04\",\n    \"160112-04\",\n    \"150303-01\",\n    \"150428-08\",\n    \"151021-11\",\n    \"140415-13\",\n    \"151031-03\",\n    \"150309-04\",\n    \"150310-11\",\n    \"151029_E1-1\",\n    \"151029_E1-5\",\n    \"151101_E3-12\",\n    \"160112-06\",\n]\n</pre> detections_csv_file_name = data_dir + \"/detections.csv\" sequence_names = [     \"140408-02\",     \"140408-04\",     \"140408-10\",     \"140409-03\",     \"140415-08\",     \"151027-05\",     \"151027-06\",     \"151027-10\",     \"151028-01\",     \"151029-05\",     \"151029-11\",     \"151029_E1-6\",     \"151101_E2-1\",     \"151101_E2-2\",     \"151101_E3-11\",     \"151101_E4-12\",     \"151101_E4-19\",     \"151101_E4-20\",     \"150317-07\",     \"150318-06\",     \"150331-12\",     \"151222-10\",     \"151222-11\",     \"150324-03\",     \"150324-05\",     \"150325-04\",     \"160112-04\",     \"150303-01\",     \"150428-08\",     \"151021-11\",     \"140415-13\",     \"151031-03\",     \"150309-04\",     \"150310-11\",     \"151029_E1-1\",     \"151029_E1-5\",     \"151101_E3-12\",     \"160112-06\", ] In\u00a0[5]: Copied! <pre>test_sequence_names = [\n    \"150309-04\",\n    \"150310-11\",\n    \"151029_E1-1\",\n    \"151029_E1-5\",\n    \"151101_E3-12\",\n    \"160112-06\",\n]\n</pre> test_sequence_names = [     \"150309-04\",     \"150310-11\",     \"151029_E1-1\",     \"151029_E1-5\",     \"151101_E3-12\",     \"160112-06\", ] In\u00a0[6]: Copied! <pre>mask_dir_names = [\n    data_dir + \"/Bacteria/train/140408-02/TRA\",\n    data_dir + \"/Bacteria/train/140408-04/TRA\",\n    data_dir + \"/Bacteria/train/140408-10/TRA\",\n    data_dir + \"/Bacteria/train/140409-03/TRA\",\n    data_dir + \"/Bacteria/train/140415-08/TRA\",\n    data_dir + \"/Bacteria/train/151027-05/TRA\",\n    data_dir + \"/Bacteria/train/151027-06/TRA\",\n    data_dir + \"/Bacteria/train/151027-10/TRA\",\n    data_dir + \"/Bacteria/train/151028-01/TRA\",\n    data_dir + \"/Bacteria/train/151029-05/TRA\",\n    data_dir + \"/Bacteria/train/151029-11/TRA\",\n    data_dir + \"/Bacteria/train/151029_E1-6/TRA\",\n    data_dir + \"/Bacteria/train/151101_E2-1/TRA\",\n    data_dir + \"/Bacteria/train/151101_E2-2/TRA\",\n    data_dir + \"/Bacteria/train/151101_E3-11/TRA\",\n    data_dir + \"/Bacteria/train/151101_E4-12/TRA\",\n    data_dir + \"/Bacteria/train/151101_E4-19/TRA\",\n    data_dir + \"/Bacteria/train/151101_E4-20/TRA\",\n    data_dir + \"/Bacteria/train/150317-07/TRA\",\n    data_dir + \"/Bacteria/train/150318-06/TRA\",\n    data_dir + \"/Bacteria/train/150331-12/TRA\",\n    data_dir + \"/Bacteria/train/151222-10/TRA\",\n    data_dir + \"/Bacteria/train/151222-11/TRA\",\n    data_dir + \"/Bacteria/train/150324-03/TRA\",\n    data_dir + \"/Bacteria/train/150324-05/TRA\",\n    data_dir + \"/Bacteria/train/150325-04/TRA\",\n    data_dir + \"/Bacteria/train/160112-04/TRA\",\n    data_dir + \"/Bacteria/train/150303-01/TRA\",\n    data_dir + \"/Bacteria/train/150428-08/TRA\",\n    data_dir + \"/Bacteria/train/151021-11/TRA\",\n    data_dir + \"/Bacteria/val/140415-13/TRA\",\n    data_dir + \"/Bacteria/val/151031-03/TRA\",\n    data_dir + \"/Bacteria/test/150309-04/TRA\",\n    data_dir + \"/Bacteria/test/150310-11/TRA\",\n    data_dir + \"/Bacteria/test/151029_E1-1/TRA\",\n    data_dir + \"/Bacteria/test/151029_E1-5/TRA\",\n    data_dir + \"/Bacteria/test/151101_E3-12/TRA\",\n    data_dir + \"/Bacteria/test/160112-06/TRA\",\n]\n</pre> mask_dir_names = [     data_dir + \"/Bacteria/train/140408-02/TRA\",     data_dir + \"/Bacteria/train/140408-04/TRA\",     data_dir + \"/Bacteria/train/140408-10/TRA\",     data_dir + \"/Bacteria/train/140409-03/TRA\",     data_dir + \"/Bacteria/train/140415-08/TRA\",     data_dir + \"/Bacteria/train/151027-05/TRA\",     data_dir + \"/Bacteria/train/151027-06/TRA\",     data_dir + \"/Bacteria/train/151027-10/TRA\",     data_dir + \"/Bacteria/train/151028-01/TRA\",     data_dir + \"/Bacteria/train/151029-05/TRA\",     data_dir + \"/Bacteria/train/151029-11/TRA\",     data_dir + \"/Bacteria/train/151029_E1-6/TRA\",     data_dir + \"/Bacteria/train/151101_E2-1/TRA\",     data_dir + \"/Bacteria/train/151101_E2-2/TRA\",     data_dir + \"/Bacteria/train/151101_E3-11/TRA\",     data_dir + \"/Bacteria/train/151101_E4-12/TRA\",     data_dir + \"/Bacteria/train/151101_E4-19/TRA\",     data_dir + \"/Bacteria/train/151101_E4-20/TRA\",     data_dir + \"/Bacteria/train/150317-07/TRA\",     data_dir + \"/Bacteria/train/150318-06/TRA\",     data_dir + \"/Bacteria/train/150331-12/TRA\",     data_dir + \"/Bacteria/train/151222-10/TRA\",     data_dir + \"/Bacteria/train/151222-11/TRA\",     data_dir + \"/Bacteria/train/150324-03/TRA\",     data_dir + \"/Bacteria/train/150324-05/TRA\",     data_dir + \"/Bacteria/train/150325-04/TRA\",     data_dir + \"/Bacteria/train/160112-04/TRA\",     data_dir + \"/Bacteria/train/150303-01/TRA\",     data_dir + \"/Bacteria/train/150428-08/TRA\",     data_dir + \"/Bacteria/train/151021-11/TRA\",     data_dir + \"/Bacteria/val/140415-13/TRA\",     data_dir + \"/Bacteria/val/151031-03/TRA\",     data_dir + \"/Bacteria/test/150309-04/TRA\",     data_dir + \"/Bacteria/test/150310-11/TRA\",     data_dir + \"/Bacteria/test/151029_E1-1/TRA\",     data_dir + \"/Bacteria/test/151029_E1-5/TRA\",     data_dir + \"/Bacteria/test/151101_E3-12/TRA\",     data_dir + \"/Bacteria/test/160112-06/TRA\", ] In\u00a0[7]: Copied! <pre>man_track_file_names = [\n    data_dir + \"/Bacteria/train/140408-02/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/140408-04/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/140408-10/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/140409-03/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/140415-08/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151027-05/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151027-06/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151027-10/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151028-01/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151029-05/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151029-11/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151029_E1-6/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151101_E2-1/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151101_E2-2/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151101_E3-11/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151101_E4-12/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151101_E4-19/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151101_E4-20/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/150317-07/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/150318-06/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/150331-12/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151222-10/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151222-11/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/150324-03/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/150324-05/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/150325-04/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/160112-04/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/150303-01/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/150428-08/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/train/151021-11/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/val/140415-13/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/val/151031-03/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/test/150309-04/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/test/150310-11/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/test/151029_E1-1/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/test/151029_E1-5/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/test/151101_E3-12/TRA/man_track.txt\",\n    data_dir + \"/Bacteria/test/160112-06/TRA/man_track.txt\",\n]\n</pre> man_track_file_names = [     data_dir + \"/Bacteria/train/140408-02/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/140408-04/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/140408-10/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/140409-03/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/140415-08/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151027-05/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151027-06/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151027-10/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151028-01/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151029-05/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151029-11/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151029_E1-6/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151101_E2-1/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151101_E2-2/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151101_E3-11/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151101_E4-12/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151101_E4-19/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151101_E4-20/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/150317-07/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/150318-06/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/150331-12/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151222-10/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151222-11/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/150324-03/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/150324-05/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/150325-04/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/160112-04/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/150303-01/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/150428-08/TRA/man_track.txt\",     data_dir + \"/Bacteria/train/151021-11/TRA/man_track.txt\",     data_dir + \"/Bacteria/val/140415-13/TRA/man_track.txt\",     data_dir + \"/Bacteria/val/151031-03/TRA/man_track.txt\",     data_dir + \"/Bacteria/test/150309-04/TRA/man_track.txt\",     data_dir + \"/Bacteria/test/150310-11/TRA/man_track.txt\",     data_dir + \"/Bacteria/test/151029_E1-1/TRA/man_track.txt\",     data_dir + \"/Bacteria/test/151029_E1-5/TRA/man_track.txt\",     data_dir + \"/Bacteria/test/151101_E3-12/TRA/man_track.txt\",     data_dir + \"/Bacteria/test/160112-06/TRA/man_track.txt\", ] In\u00a0[8]: Copied! <pre>img_dir_names = [\n    data_dir + \"/Bacteria/train/140408-02/img\",\n    data_dir + \"/Bacteria/train/140408-04/img\",\n    data_dir + \"/Bacteria/train/140408-10/img\",\n    data_dir + \"/Bacteria/train/140409-03/img\",\n    data_dir + \"/Bacteria/train/140415-08/img\",\n    data_dir + \"/Bacteria/train/151027-05/img\",\n    data_dir + \"/Bacteria/train/151027-06/img\",\n    data_dir + \"/Bacteria/train/151027-10/img\",\n    data_dir + \"/Bacteria/train/151028-01/img\",\n    data_dir + \"/Bacteria/train/151029-05/img\",\n    data_dir + \"/Bacteria/train/151029-11/img\",\n    data_dir + \"/Bacteria/train/151029_E1-6/img\",\n    data_dir + \"/Bacteria/train/151101_E2-1/img\",\n    data_dir + \"/Bacteria/train/151101_E2-2/img\",\n    data_dir + \"/Bacteria/train/151101_E3-11/img\",\n    data_dir + \"/Bacteria/train/151101_E4-12/img\",\n    data_dir + \"/Bacteria/train/151101_E4-19/img\",\n    data_dir + \"/Bacteria/train/151101_E4-20/img\",\n    data_dir + \"/Bacteria/train/150317-07/img\",\n    data_dir + \"/Bacteria/train/150318-06/img\",\n    data_dir + \"/Bacteria/train/150331-12/img\",\n    data_dir + \"/Bacteria/train/151222-10/img\",\n    data_dir + \"/Bacteria/train/151222-11/img\",\n    data_dir + \"/Bacteria/train/150324-03/img\",\n    data_dir + \"/Bacteria/train/150324-05/img\",\n    data_dir + \"/Bacteria/train/150325-04/img\",\n    data_dir + \"/Bacteria/train/160112-04/img\",\n    data_dir + \"/Bacteria/train/150303-01/img\",\n    data_dir + \"/Bacteria/train/150428-08/img\",\n    data_dir + \"/Bacteria/train/151021-11/img\",\n    data_dir + \"/Bacteria/val/140415-13/img\",\n    data_dir + \"/Bacteria/val/151031-03/img\",\n    data_dir + \"/Bacteria/test/150309-04/img\",\n    data_dir + \"/Bacteria/test/150310-11/img\",\n    data_dir + \"/Bacteria/test/151029_E1-1/img\",\n    data_dir + \"/Bacteria/test/151029_E1-5/img\",\n    data_dir + \"/Bacteria/test/151101_E3-12/img\",\n    data_dir + \"/Bacteria/test/160112-06/img\",\n]\n</pre> img_dir_names = [     data_dir + \"/Bacteria/train/140408-02/img\",     data_dir + \"/Bacteria/train/140408-04/img\",     data_dir + \"/Bacteria/train/140408-10/img\",     data_dir + \"/Bacteria/train/140409-03/img\",     data_dir + \"/Bacteria/train/140415-08/img\",     data_dir + \"/Bacteria/train/151027-05/img\",     data_dir + \"/Bacteria/train/151027-06/img\",     data_dir + \"/Bacteria/train/151027-10/img\",     data_dir + \"/Bacteria/train/151028-01/img\",     data_dir + \"/Bacteria/train/151029-05/img\",     data_dir + \"/Bacteria/train/151029-11/img\",     data_dir + \"/Bacteria/train/151029_E1-6/img\",     data_dir + \"/Bacteria/train/151101_E2-1/img\",     data_dir + \"/Bacteria/train/151101_E2-2/img\",     data_dir + \"/Bacteria/train/151101_E3-11/img\",     data_dir + \"/Bacteria/train/151101_E4-12/img\",     data_dir + \"/Bacteria/train/151101_E4-19/img\",     data_dir + \"/Bacteria/train/151101_E4-20/img\",     data_dir + \"/Bacteria/train/150317-07/img\",     data_dir + \"/Bacteria/train/150318-06/img\",     data_dir + \"/Bacteria/train/150331-12/img\",     data_dir + \"/Bacteria/train/151222-10/img\",     data_dir + \"/Bacteria/train/151222-11/img\",     data_dir + \"/Bacteria/train/150324-03/img\",     data_dir + \"/Bacteria/train/150324-05/img\",     data_dir + \"/Bacteria/train/150325-04/img\",     data_dir + \"/Bacteria/train/160112-04/img\",     data_dir + \"/Bacteria/train/150303-01/img\",     data_dir + \"/Bacteria/train/150428-08/img\",     data_dir + \"/Bacteria/train/151021-11/img\",     data_dir + \"/Bacteria/val/140415-13/img\",     data_dir + \"/Bacteria/val/151031-03/img\",     data_dir + \"/Bacteria/test/150309-04/img\",     data_dir + \"/Bacteria/test/150310-11/img\",     data_dir + \"/Bacteria/test/151029_E1-1/img\",     data_dir + \"/Bacteria/test/151029_E1-5/img\",     data_dir + \"/Bacteria/test/151101_E3-12/img\",     data_dir + \"/Bacteria/test/160112-06/img\", ] In\u00a0[9]: Copied! <pre>create_csv(\n    mask_dir_names=mask_dir_names,\n    sequence_names=sequence_names,\n    man_track_file_names=man_track_file_names,\n    output_csv_file_name=detections_csv_file_name,\n)\n</pre> create_csv(     mask_dir_names=mask_dir_names,     sequence_names=sequence_names,     man_track_file_names=man_track_file_names,     output_csv_file_name=detections_csv_file_name, ) <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/140408-02/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/140408-04/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/140408-10/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/140409-03/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/140415-08/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151027-05/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151027-06/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151027-10/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151028-01/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151029-05/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151029-11/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151029_E1-6/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151101_E2-1/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151101_E2-2/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151101_E3-11/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151101_E4-12/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151101_E4-19/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151101_E4-20/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/150317-07/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/150318-06/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/150331-12/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151222-10/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151222-11/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/150324-03/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/150324-05/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/150325-04/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/160112-04/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/150303-01/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/150428-08/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/train/151021-11/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/val/140415-13/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/val/151031-03/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/test/150309-04/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/test/150310-11/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/test/151029_E1-1/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/test/151029_E1-5/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/test/151101_E3-12/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/Bacteria//Bacteria/test/160112-06/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Saving output CSVs to: ./data/Bacteria//detections.csv\n</pre> <pre>INFO:attrackt.scripts.create_csv:CSV creation complete.\n</pre> In\u00a0[10]: Copied! <pre>container_path = data_dir + \"/Bacteria.zarr\"\n</pre> container_path = data_dir + \"/Bacteria.zarr\" In\u00a0[11]: Copied! <pre>create_zarr(\n    container_path=container_path,\n    img_dir_names=img_dir_names,\n    mask_dir_names=mask_dir_names,\n    sequence_names=sequence_names,\n    mapping_csv_file_name=detections_csv_file_name,\n)\n</pre> create_zarr(     container_path=container_path,     img_dir_names=img_dir_names,     mask_dir_names=mask_dir_names,     sequence_names=sequence_names,     mapping_csv_file_name=detections_csv_file_name, ) <pre>INFO:attrackt.scripts.create_zarr:Sequence '140408-02': using 1600 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140408-02': relabeled masks written. Unique labels: 352 -&gt; 1601\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140408-04': using 3786 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140408-04': relabeled masks written. Unique labels: 616 -&gt; 3787\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140408-10': using 3307 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140408-10': relabeled masks written. Unique labels: 562 -&gt; 3308\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140409-03': using 3434 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140409-03': relabeled masks written. Unique labels: 482 -&gt; 3435\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140415-08': using 1798 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140415-08': relabeled masks written. Unique labels: 248 -&gt; 1799\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151027-05': using 630 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151027-05': relabeled masks written. Unique labels: 269 -&gt; 631\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151027-06': using 965 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151027-06': relabeled masks written. Unique labels: 467 -&gt; 966\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151027-10': using 1242 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151027-10': relabeled masks written. Unique labels: 535 -&gt; 1243\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151028-01': using 614 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151028-01': relabeled masks written. Unique labels: 257 -&gt; 615\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151029-05': using 855 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151029-05': relabeled masks written. Unique labels: 378 -&gt; 856\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151029-11': using 1204 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151029-11': relabeled masks written. Unique labels: 511 -&gt; 1205\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151029_E1-6': using 2429 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151029_E1-6': relabeled masks written. Unique labels: 471 -&gt; 2430\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E2-1': using 1619 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E2-1': relabeled masks written. Unique labels: 301 -&gt; 1620\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E2-2': using 1707 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E2-2': relabeled masks written. Unique labels: 289 -&gt; 1708\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E3-11': using 1511 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E3-11': relabeled masks written. Unique labels: 258 -&gt; 1512\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E4-12': using 2202 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E4-12': relabeled masks written. Unique labels: 430 -&gt; 2203\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E4-19': using 1974 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E4-19': relabeled masks written. Unique labels: 343 -&gt; 1975\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E4-20': using 2716 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E4-20': relabeled masks written. Unique labels: 484 -&gt; 2717\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150317-07': using 1326 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150317-07': relabeled masks written. Unique labels: 381 -&gt; 1327\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150318-06': using 1709 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150318-06': relabeled masks written. Unique labels: 671 -&gt; 1710\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150331-12': using 3945 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150331-12': relabeled masks written. Unique labels: 608 -&gt; 3946\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151222-10': using 4131 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151222-10': relabeled masks written. Unique labels: 770 -&gt; 4132\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151222-11': using 4758 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151222-11': relabeled masks written. Unique labels: 919 -&gt; 4759\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150324-03': using 4114 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150324-03': relabeled masks written. Unique labels: 423 -&gt; 4115\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150324-05': using 4760 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150324-05': relabeled masks written. Unique labels: 672 -&gt; 4761\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150325-04': using 2480 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150325-04': relabeled masks written. Unique labels: 358 -&gt; 2481\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '160112-04': using 1816 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '160112-04': relabeled masks written. Unique labels: 342 -&gt; 1817\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150303-01': using 938 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150303-01': relabeled masks written. Unique labels: 134 -&gt; 939\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150428-08': using 2599 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150428-08': relabeled masks written. Unique labels: 456 -&gt; 2600\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151021-11': using 3595 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151021-11': relabeled masks written. Unique labels: 610 -&gt; 3596\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140415-13': using 2616 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '140415-13': relabeled masks written. Unique labels: 416 -&gt; 2617\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151031-03': using 417 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151031-03': relabeled masks written. Unique labels: 184 -&gt; 418\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150309-04': using 6387 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150309-04': relabeled masks written. Unique labels: 704 -&gt; 6388\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150310-11': using 550 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '150310-11': relabeled masks written. Unique labels: 151 -&gt; 551\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151029_E1-1': using 3519 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151029_E1-1': relabeled masks written. Unique labels: 715 -&gt; 3520\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151029_E1-5': using 2868 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151029_E1-5': relabeled masks written. Unique labels: 513 -&gt; 2869\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E3-12': using 2526 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '151101_E3-12': relabeled masks written. Unique labels: 493 -&gt; 2527\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '160112-06': using 1633 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '160112-06': relabeled masks written. Unique labels: 284 -&gt; 1634\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Created/updated container at ./data/Bacteria//Bacteria.zarr.\n</pre> In\u00a0[12]: Copied! <pre>result_dir_name = f\"results-position-only-{suffix}\"\nargs = {\n    \"num_nearest_neighbours\": 10,\n    \"direction_candidate_graph\": \"backward\",\n    \"pin_nodes\": True,\n    \"use_edge_distance\": True,\n    \"edge_embedding_exists\": False,\n    \"use_different_weights_hyper\": True,\n    \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},\n    \"test_csv_file_name\": detections_csv_file_name,\n    \"sequence_names\": test_sequence_names,\n    \"result_dir_name\": result_dir_name,\n    \"verbose\": False,\n}\n</pre> result_dir_name = f\"results-position-only-{suffix}\" args = {     \"num_nearest_neighbours\": 10,     \"direction_candidate_graph\": \"backward\",     \"pin_nodes\": True,     \"use_edge_distance\": True,     \"edge_embedding_exists\": False,     \"use_different_weights_hyper\": True,     \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},     \"test_csv_file_name\": detections_csv_file_name,     \"sequence_names\": test_sequence_names,     \"result_dir_name\": result_dir_name,     \"verbose\": False, } In\u00a0[13]: Copied! <pre>motile_infer(args)\n</pre> motile_infer(args) <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 150309-04\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 6387\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 92/92 [00:00&lt;00:00, 1107.23it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 63363\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 382454\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 46.66863321787835\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 21.828665413474187\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 32.74583982931663\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 16.856507768282484\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 231, max in edges: 161\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 6035\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/6385 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6385/6385 [00:00&lt;00:00, 311979.49it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 6387 out of 6387 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 6387 out of 6387 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/6387 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6387/6387 [00:00&lt;00:00, 596916.59it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/6385 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6385/6385 [00:00&lt;00:00, 948154.75it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/6386 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6386/6386 [00:00&lt;00:00, 991039.53it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 337.5,\n              'DET': 1.0,\n              'LNK': 0.9647666771061697,\n              'TRA': 0.9954049748805294,\n              'fn_edges': 107,\n              'fn_nodes': 0,\n              'fp_edges': 106,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 71},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.8302425106990015,\n                                 'Division Precision': 0.8314285714285714,\n                                 'Division Recall': 0.8290598290598291,\n                                 'False Negative Divisions': 47,\n                                 'False Positive Divisions': 46,\n                                 'Mitotic Branching Correctness': 0.7329974811083123,\n                                 'Total GT Divisions': 351,\n                                 'Total Predicted Divisions': 350,\n                                 'True Positive Divisions': 291,\n                                 'Wrong Children Divisions': 13}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-only-Bacteria-v1/150309-04/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 150309-04\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 150310-11\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 550\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 29/29 [00:00&lt;00:00, 4977.69it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 5157\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 34766\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 53.21799456985325\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 25.15642099619311\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 39.28573919870244\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 20.89419060346398\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 351, max in edges: 186\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 473\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                               | 0/543 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 543/543 [00:00&lt;00:00, 273115.13it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 550 out of 550 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 550 out of 550 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                             | 0/550 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 550/550 [00:00&lt;00:00, 601843.78it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                          | 0/543 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 543/543 [00:00&lt;00:00, 934937.22it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                          | 0/548 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 548/548 [00:00&lt;00:00, 966559.54it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 364.5,\n              'DET': 1.0,\n              'LNK': 0.5565693430656935,\n              'TRA': 0.9423441948750395,\n              'fn_edges': 133,\n              'fn_nodes': 0,\n              'fp_edges': 128,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 37},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.3055555555555555,\n                                 'Division Precision': 0.3142857142857143,\n                                 'Division Recall': 0.2972972972972973,\n                                 'False Negative Divisions': 33,\n                                 'False Positive Divisions': 29,\n                                 'Mitotic Branching Correctness': 0.21359223300970873,\n                                 'Total GT Divisions': 74,\n                                 'Total Predicted Divisions': 70,\n                                 'True Positive Divisions': 22,\n                                 'Wrong Children Divisions': 19}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-only-Bacteria-v1/150310-11/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 150310-11\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151029_E1-1\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 3519\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 53/53 [00:00&lt;00:00, 1776.44it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 34764\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 223483\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 54.977630344171835\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 29.493654973523615\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 40.21937014949374\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 24.1673141110037\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 300, max in edges: 187\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 3141\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/3511 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3511/3511 [00:00&lt;00:00, 284196.33it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 3519 out of 3519 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 3519 out of 3519 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/3519 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3519/3519 [00:00&lt;00:00, 596136.99it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/3511 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3511/3511 [00:00&lt;00:00, 893417.54it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/3517 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3517/3517 [00:00&lt;00:00, 882100.53it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 1964.0,\n              'DET': 1.0,\n              'LNK': 0.6277130129845512,\n              'TRA': 0.951464828063412,\n              'fn_edges': 716,\n              'fn_nodes': 0,\n              'fp_edges': 710,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 180},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.40771349862258954,\n                                 'Division Precision': 0.4,\n                                 'Division Recall': 0.4157303370786517,\n                                 'False Negative Divisions': 157,\n                                 'False Positive Divisions': 171,\n                                 'Mitotic Branching Correctness': 0.2808349146110057,\n                                 'Total GT Divisions': 356,\n                                 'Total Predicted Divisions': 370,\n                                 'True Positive Divisions': 148,\n                                 'Wrong Children Divisions': 51}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-only-Bacteria-v1/151029_E1-1/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151029_E1-1\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151029_E1-5\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 2868\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 53/53 [00:00&lt;00:00, 2191.53it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 28242\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 177199\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 50.44153575203126\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 24.798470682141513\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 36.37385187823484\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 19.90996249605498\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 231, max in edges: 160\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 2608\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/2866 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2866/2866 [00:00&lt;00:00, 291797.15it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2868 out of 2868 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2868 out of 2868 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/2868 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2868/2868 [00:00&lt;00:00, 600502.39it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/2866 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2866/2866 [00:00&lt;00:00, 969894.73it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/2866 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2866/2866 [00:00&lt;00:00, 951545.58it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 826.5,\n              'DET': 1.0,\n              'LNK': 0.8077459874389393,\n              'TRA': 0.974938597289184,\n              'fn_edges': 297,\n              'fn_nodes': 0,\n              'fp_edges': 297,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 84},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.5925925925925926,\n                                 'Division Precision': 0.5891472868217055,\n                                 'Division Recall': 0.596078431372549,\n                                 'False Negative Divisions': 75,\n                                 'False Positive Divisions': 78,\n                                 'Mitotic Branching Correctness': 0.45645645645645644,\n                                 'Total GT Divisions': 255,\n                                 'Total Predicted Divisions': 258,\n                                 'True Positive Divisions': 152,\n                                 'Wrong Children Divisions': 28}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-only-Bacteria-v1/151029_E1-5/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151029_E1-5\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151101_E3-12\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 2526\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 55/55 [00:00&lt;00:00, 2520.17it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 24747\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 159056\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 58.07910323942435\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 33.97910604140836\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 43.344790661411494\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 27.59030250825304\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 300, max in edges: 176\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 2279\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/2523 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2523/2523 [00:00&lt;00:00, 280086.52it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2526 out of 2526 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2526 out of 2526 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/2526 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2526/2526 [00:00&lt;00:00, 595314.49it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/2523 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2523/2523 [00:00&lt;00:00, 948058.50it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/2524 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2524/2524 [00:00&lt;00:00, 966620.10it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 630.5,\n              'DET': 1.0,\n              'LNK': 0.8334653988378236,\n              'TRA': 0.9782930523996419,\n              'fn_edges': 213,\n              'fn_nodes': 0,\n              'fp_edges': 212,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 99},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.5971370143149284,\n                                 'Division Precision': 0.5983606557377049,\n                                 'Division Recall': 0.5959183673469388,\n                                 'False Negative Divisions': 74,\n                                 'False Positive Divisions': 73,\n                                 'Mitotic Branching Correctness': 0.4591194968553459,\n                                 'Total GT Divisions': 245,\n                                 'Total Predicted Divisions': 244,\n                                 'True Positive Divisions': 146,\n                                 'Wrong Children Divisions': 25}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-only-Bacteria-v1/151101_E3-12/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151101_E3-12\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 160112-06\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 1633\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 55/55 [00:00&lt;00:00, 3679.45it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 15851\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 100439\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 36.420020364149636\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 19.695178950638855\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 26.820009069607462\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 15.641332439978912\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 276, max in edges: 161\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 1491\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/1632 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1632/1632 [00:00&lt;00:00, 273782.26it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 1633 out of 1633 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 1633 out of 1633 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/1633 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1633/1633 [00:00&lt;00:00, 596680.76it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/1632 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1632/1632 [00:00&lt;00:00, 949522.00it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/1632 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1632/1632 [00:00&lt;00:00, 1049540.65it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 154.5,\n              'DET': 1.0,\n              'LNK': 0.9368872549019608,\n              'TRA': 0.9917722867185004,\n              'fn_edges': 49,\n              'fn_nodes': 0,\n              'fp_edges': 49,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 32},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.7730496453900709,\n                                 'Division Precision': 0.7730496453900709,\n                                 'Division Recall': 0.7730496453900709,\n                                 'False Negative Divisions': 20,\n                                 'False Positive Divisions': 20,\n                                 'Mitotic Branching Correctness': 0.6770186335403726,\n                                 'Total GT Divisions': 141,\n                                 'Total Predicted Divisions': 141,\n                                 'True Positive Divisions': 109,\n                                 'Wrong Children Divisions': 12}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-only-Bacteria-v1/160112-06/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 160112-06\n</pre> In\u00a0[14]: Copied! <pre>result_test_sequences = [\n    result_dir_name + \"/\" + test_sequence_name\n    for test_sequence_name in test_sequence_names\n]\n</pre> result_test_sequences = [     result_dir_name + \"/\" + test_sequence_name     for test_sequence_name in test_sequence_names ] In\u00a0[15]: Copied! <pre>cumulate_scores(sequence_names=result_test_sequences)\n</pre> cumulate_scores(sequence_names=result_test_sequences) <pre>AOGM | MBC | division_f1 | fp_divs | fn_divs | tp_divs | ws_edges | fp_edges | fn_edges | TRA\n712.917 | 0.470 | 0.584 | 69.500 | 67.667 | 144.667 | 83.833 | 250.333 | 252.500 | 0.972\n</pre>"},{"location":"examples/Bacteria/01-preprocessing/#01-preprocessing-data","title":"01 \u2013 Preprocessing Data\u00b6","text":"<p>This notebook performs the following steps:</p> <ol> <li>Download data</li> <li>(Optional) Combine instance segmentation masks from silver and gold ground truth</li> <li>Convert image and label data to Zarr format</li> <li>Save detections into a CSV file</li> <li>Compute tracking accuracy metrics with only d(position) as edge cost</li> </ol>"},{"location":"examples/Bacteria/01-preprocessing/#download-data","title":"Download Data\u00b6","text":"<p>The raw <code>.tif</code> images are first downloaded to the directory specified by <code>data_dir</code>.</p>"},{"location":"examples/Bacteria/01-preprocessing/#export-detection-data-to-csv","title":"Export Detection Data to CSV\u00b6","text":"<p>Next, we generate a single CSV file containing the locations of all detected instances. Each detection is assigned a unique ID.</p> <p>The CSV includes the following columns: <code>sequence</code>, <code>id</code>, <code>t</code>, <code>[z]</code>, <code>y</code>, <code>x</code>, <code>parent_id</code>, <code>original_id</code></p> <p>Note: The <code>man_track_file_names</code> input is optional. It is used here solely for evaluation purposes (e.g., assigning the values in the parent_id column), and is not required for model training or for solving the ILP.</p>"},{"location":"examples/Bacteria/01-preprocessing/#convert-data-to-zarr-format","title":"Convert Data to Zarr Format\u00b6","text":"<p>Then, we convert the data into a single Zarr file. This file contains one group for each sequence in the dataset.</p> <p>Within each sequence group, you'll find two datasets:</p> <ul> <li><code>img</code> \u2013 the raw image data</li> <li><code>mask</code> \u2013 the corresponding instance segmentation masks All the masks will be relabeled to ensure unique instance IDs across the entire dataset.</li> </ul>"},{"location":"examples/Bacteria/01-preprocessing/#compute-tracking-performance-using-only-dposition-as-edge-cost","title":"Compute Tracking Performance using only d(position) as edge cost\u00b6","text":"<p>Finally, to understand how well we perform using only position as a feature, we compute the tracking performance using only d(position) as edge cost. Please ensure <code>gurobi</code> is installed for a faster solving experience.</p>"},{"location":"examples/Bacteria/01-preprocessing/#cumulate-scores","title":"Cumulate scores\u00b6","text":""},{"location":"examples/Bacteria/02-autoencoder/","title":"02 - Train auto-encoder model.","text":"In\u00a0[1]: Copied! <pre>import torch\nimport csv\nfrom attrackt.autoencoder import (\n    ZarrCsvDatasetAutoencoder,\n    AutoencoderModel,\n    AutoencoderModel3d,\n)\nfrom attrackt.scripts.autoencoder.train_autoencoder import train_autoencoder\nfrom attrackt.scripts.autoencoder.infer_autoencoder import infer_autoencoder\nfrom attrackt.scripts.motile import motile_infer\nfrom attrackt.scripts.cumulate_scores import cumulate_scores\n</pre> import torch import csv from attrackt.autoencoder import (     ZarrCsvDatasetAutoencoder,     AutoencoderModel,     AutoencoderModel3d, ) from attrackt.scripts.autoencoder.train_autoencoder import train_autoencoder from attrackt.scripts.autoencoder.infer_autoencoder import infer_autoencoder from attrackt.scripts.motile import motile_infer from attrackt.scripts.cumulate_scores import cumulate_scores In\u00a0[2]: Copied! <pre>suffix = \"Bacteria-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed.\ndata_dir = \"./data/Bacteria/\"\ncontainer_path = data_dir + \"/Bacteria.zarr\"\ndetections_csv_file_name = data_dir + \"/detections.csv\"\ncrop_size = [64, 64]\nnum_spatial_dims = 2\n</pre> suffix = \"Bacteria-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed. data_dir = \"./data/Bacteria/\" container_path = data_dir + \"/Bacteria.zarr\" detections_csv_file_name = data_dir + \"/detections.csv\" crop_size = [64, 64] num_spatial_dims = 2 In\u00a0[3]: Copied! <pre>train_dataset = ZarrCsvDatasetAutoencoder(\n    zarr_container_name=container_path,\n    detections_csv_file_name=detections_csv_file_name,\n    num_spatial_dims=num_spatial_dims,\n    crop_size=crop_size,\n    length=None,\n)\n</pre> train_dataset = ZarrCsvDatasetAutoencoder(     zarr_container_name=container_path,     detections_csv_file_name=detections_csv_file_name,     num_spatial_dims=num_spatial_dims,     crop_size=crop_size,     length=None, ) <pre>INFO:attrackt.autoencoder.zarr_csv_dataset_autoencoder:Loaded detections file ./data/Bacteria//detections.csv.\n</pre> In\u00a0[4]: Copied! <pre>val_dataset = ZarrCsvDatasetAutoencoder(\n    zarr_container_name=container_path,\n    detections_csv_file_name=detections_csv_file_name,\n    num_spatial_dims=num_spatial_dims,\n    crop_size=crop_size,\n    length=100,\n    shuffle=True,\n)\n</pre> val_dataset = ZarrCsvDatasetAutoencoder(     zarr_container_name=container_path,     detections_csv_file_name=detections_csv_file_name,     num_spatial_dims=num_spatial_dims,     crop_size=crop_size,     length=100,     shuffle=True, ) <pre>INFO:attrackt.autoencoder.zarr_csv_dataset_autoencoder:Loaded detections file ./data/Bacteria//detections.csv.\n</pre> In\u00a0[5]: Copied! <pre>num_in_out_channels = 1  # Number of input and output channels, e.g. 1 for gray-scale images, 3 for RGB images.\nnum_intermediate_channels = 32\nnum_z_channels = 4\nattention_resolutions = [16]  # resolution level at which attention is applied.\nnum_res_blocks = 2\nchannels_multiply_factor = [\n    1,\n    1,\n    2,\n    2,\n    4,\n]  # how number of channels increase at each resolution level.\nvariational = False\nembedding_dimension = 4  # Dimension of the embedding vector, used for VAE. If variational is False, this is ignored.\n</pre> num_in_out_channels = 1  # Number of input and output channels, e.g. 1 for gray-scale images, 3 for RGB images. num_intermediate_channels = 32 num_z_channels = 4 attention_resolutions = [16]  # resolution level at which attention is applied. num_res_blocks = 2 channels_multiply_factor = [     1,     1,     2,     2,     4, ]  # how number of channels increase at each resolution level. variational = False embedding_dimension = 4  # Dimension of the embedding vector, used for VAE. If variational is False, this is ignored. In\u00a0[6]: Copied! <pre>kwargs = dict(\n    num_in_out_channels=num_in_out_channels,\n    num_intermediate_channels=num_intermediate_channels,\n    num_z_channels=num_z_channels,\n    attention_resolutions=attention_resolutions,\n    num_res_blocks=num_res_blocks,\n    resolution=crop_size[-1],\n    channels_multiply_factor=channels_multiply_factor,\n    device=\"cuda\" if torch.cuda.is_available() else \"mps\",\n    variational=variational,\n    embedding_dimension=embedding_dimension,  # Used for VAE.\n)\n</pre> kwargs = dict(     num_in_out_channels=num_in_out_channels,     num_intermediate_channels=num_intermediate_channels,     num_z_channels=num_z_channels,     attention_resolutions=attention_resolutions,     num_res_blocks=num_res_blocks,     resolution=crop_size[-1],     channels_multiply_factor=channels_multiply_factor,     device=\"cuda\" if torch.cuda.is_available() else \"mps\",     variational=variational,     embedding_dimension=embedding_dimension,  # Used for VAE. ) In\u00a0[7]: Copied! <pre>ModelClass = AutoencoderModel if num_spatial_dims == 2 else AutoencoderModel3d\nmodel = ModelClass(**kwargs)\n</pre> ModelClass = AutoencoderModel if num_spatial_dims == 2 else AutoencoderModel3d model = ModelClass(**kwargs) In\u00a0[8]: Copied! <pre>num_iterations = 100_000\nlearning_rate = 5e-5\nbatch_size = 8\nnum_workers = 2 if torch.cuda.is_available() else 0\n</pre> num_iterations = 100_000 learning_rate = 5e-5 batch_size = 8 num_workers = 2 if torch.cuda.is_available() else 0 <p>Now we can begin the training!  Uncomment the next few lines to train the model.</p> In\u00a0[9]: Copied! <pre># train_autoencoder(\n#    dataset=train_dataset,\n#    dataset_val=val_dataset,\n#    model=model,\n#    batch_size=batch_size,\n#    learning_rate=learning_rate,\n#    device=\"cuda\" if torch.cuda.is_available() else \"mps\",\n#    num_iterations=num_iterations,\n#    num_workers=num_workers,\n#    suffix=suffix,\n# )\n</pre> # train_autoencoder( #    dataset=train_dataset, #    dataset_val=val_dataset, #    model=model, #    batch_size=batch_size, #    learning_rate=learning_rate, #    device=\"cuda\" if torch.cuda.is_available() else \"mps\", #    num_iterations=num_iterations, #    num_workers=num_workers, #    suffix=suffix, # ) In\u00a0[10]: Copied! <pre>model_checkpoint = f\"autoencoder-2025-10-11-{suffix}/models_autoencoder/best.pth\"  # Path to a saved model checkpoint.\n</pre> model_checkpoint = f\"autoencoder-2025-10-11-{suffix}/models_autoencoder/best.pth\"  # Path to a saved model checkpoint. In\u00a0[11]: Copied! <pre>with open(detections_csv_file_name, newline=\"\") as f:\n    reader = csv.reader(f)\n    num_rows = sum(1 for row in reader) - 1  # subtract header row\nprint(f\"Number of detections in dataset is {num_rows}.\")\n</pre> with open(detections_csv_file_name, newline=\"\") as f:     reader = csv.reader(f)     num_rows = sum(1 for row in reader) - 1  # subtract header row print(f\"Number of detections in dataset is {num_rows}.\") <pre>Number of detections in dataset is 90280.\n</pre> In\u00a0[12]: Copied! <pre>test_dataset = ZarrCsvDatasetAutoencoder(\n    zarr_container_name=container_path,\n    detections_csv_file_name=detections_csv_file_name,\n    num_spatial_dims=num_spatial_dims,\n    crop_size=crop_size,\n    length=num_rows,\n    shuffle=False,\n)\n</pre> test_dataset = ZarrCsvDatasetAutoencoder(     zarr_container_name=container_path,     detections_csv_file_name=detections_csv_file_name,     num_spatial_dims=num_spatial_dims,     crop_size=crop_size,     length=num_rows,     shuffle=False, ) <pre>INFO:attrackt.autoencoder.zarr_csv_dataset_autoencoder:Loaded detections file ./data/Bacteria//detections.csv.\n</pre> In\u00a0[13]: Copied! <pre>node_embedding_file_name = f\"embeddings-{suffix}.csv\"\n</pre> node_embedding_file_name = f\"embeddings-{suffix}.csv\" <p>Now we can begin the inference!  Uncomment the next few lines to run the inference.</p> In\u00a0[14]: Copied! <pre># infer_autoencoder(\n#    dataset=test_dataset,\n#    model=model,\n#    model_checkpoint=model_checkpoint,\n#    device=\"cuda\" if torch.cuda.is_available() else \"mps\",\n#    output_csv_file_name=node_embedding_file_name,\n# )\n</pre> # infer_autoencoder( #    dataset=test_dataset, #    model=model, #    model_checkpoint=model_checkpoint, #    device=\"cuda\" if torch.cuda.is_available() else \"mps\", #    output_csv_file_name=node_embedding_file_name, # ) In\u00a0[15]: Copied! <pre>result_dir_name = f\"results-position-and-embeddings-{suffix}\"\ntest_sequence_names = [\n    \"150309-04\",\n    \"150310-11\",\n    \"151029_E1-1\",\n    \"151029_E1-5\",\n    \"151101_E3-12\",\n    \"160112-06\",\n]\nargs = {\n    \"num_nearest_neighbours\": 10,\n    \"direction_candidate_graph\": \"backward\",\n    \"pin_nodes\": True,\n    \"use_edge_distance\": True,\n    \"edge_embedding_exists\": True,\n    \"use_different_weights_hyper\": True,\n    \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},\n    \"test_csv_file_name\": detections_csv_file_name,\n    \"node_embedding_file_name\": node_embedding_file_name,\n    \"embedding_type\": \"distance\",\n    \"sequence_names\": test_sequence_names,\n    \"result_dir_name\": result_dir_name,\n    \"verbose\": False,\n}\n</pre> result_dir_name = f\"results-position-and-embeddings-{suffix}\" test_sequence_names = [     \"150309-04\",     \"150310-11\",     \"151029_E1-1\",     \"151029_E1-5\",     \"151101_E3-12\",     \"160112-06\", ] args = {     \"num_nearest_neighbours\": 10,     \"direction_candidate_graph\": \"backward\",     \"pin_nodes\": True,     \"use_edge_distance\": True,     \"edge_embedding_exists\": True,     \"use_different_weights_hyper\": True,     \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},     \"test_csv_file_name\": detections_csv_file_name,     \"node_embedding_file_name\": node_embedding_file_name,     \"embedding_type\": \"distance\",     \"sequence_names\": test_sequence_names,     \"result_dir_name\": result_dir_name,     \"verbose\": False, } In\u00a0[16]: Copied! <pre>motile_infer(args)\n</pre> motile_infer(args) <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 150309-04\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 6387\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 92/92 [00:00&lt;00:00, 1729.62it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 63363\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 382454\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 46.66863321787835\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 21.828665413474187\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 32.74583982931663\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 16.856507768282484\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 6.224736213684082\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 1.6969331502914429\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 5.339291572570801\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 1.1942392587661743\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 231, max in edges: 161\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 6035\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/6384 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6384/6384 [00:00&lt;00:00, 310653.14it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 6387 out of 6387 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 6387 out of 6387 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/6387 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6387/6387 [00:00&lt;00:00, 588562.70it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/6384 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6384/6384 [00:00&lt;00:00, 938273.07it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/6386 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6386/6386 [00:00&lt;00:00, 995163.49it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 140.5,\n              'DET': 1.0,\n              'LNK': 0.985332498173087,\n              'TRA': 0.9980871080613759,\n              'fn_edges': 41,\n              'fn_nodes': 0,\n              'fp_edges': 39,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 40},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.9085714285714286,\n                                 'Division Precision': 0.9111747851002865,\n                                 'Division Recall': 0.905982905982906,\n                                 'False Negative Divisions': 22,\n                                 'False Positive Divisions': 20,\n                                 'Mitotic Branching Correctness': 0.8571428571428571,\n                                 'Total GT Divisions': 351,\n                                 'Total Predicted Divisions': 349,\n                                 'True Positive Divisions': 318,\n                                 'Wrong Children Divisions': 11}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-embeddings-Bacteria-v1/150309-04/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 150309-04\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 150310-11\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 550\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 29/29 [00:00&lt;00:00, 4853.55it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 5157\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 34766\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 53.21799456985325\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 25.15642099619311\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 39.28573919870244\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 20.89419060346398\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 7.9725236892700195\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 1.4942744970321655\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 6.860898017883301\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 1.0452460050582886\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 351, max in edges: 186\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 474\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                               | 0/545 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 545/545 [00:00&lt;00:00, 275143.92it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 550 out of 550 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 550 out of 550 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                             | 0/550 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 550/550 [00:00&lt;00:00, 599809.46it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                          | 0/545 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 545/545 [00:00&lt;00:00, 983603.99it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                          | 0/548 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 548/548 [00:00&lt;00:00, 925313.44it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 177.5,\n              'DET': 1.0,\n              'LNK': 0.7840632603406326,\n              'TRA': 0.9719234419487504,\n              'fn_edges': 59,\n              'fn_nodes': 0,\n              'fp_edges': 56,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 33},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.5379310344827587,\n                                 'Division Precision': 0.5492957746478874,\n                                 'Division Recall': 0.527027027027027,\n                                 'False Negative Divisions': 22,\n                                 'False Positive Divisions': 19,\n                                 'Mitotic Branching Correctness': 0.41935483870967744,\n                                 'Total GT Divisions': 74,\n                                 'Total Predicted Divisions': 71,\n                                 'True Positive Divisions': 39,\n                                 'Wrong Children Divisions': 13}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-embeddings-Bacteria-v1/150310-11/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 150310-11\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151029_E1-1\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 3519\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 53/53 [00:00&lt;00:00, 1775.37it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 34764\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 223483\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 54.977630344171835\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 29.493654973523615\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 40.21937014949374\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 24.1673141110037\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 8.795785903930664\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 2.1049413681030273\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 7.637543201446533\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 1.591598629951477\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 300, max in edges: 187\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 3159\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/3511 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3511/3511 [00:00&lt;00:00, 282598.38it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 3519 out of 3519 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 3519 out of 3519 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/3519 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3519/3519 [00:00&lt;00:00, 602389.84it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/3511 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3511/3511 [00:00&lt;00:00, 940550.64it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/3517 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3517/3517 [00:00&lt;00:00, 1012100.66it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 605.5,\n              'DET': 1.0,\n              'LNK': 0.8852241493697279,\n              'TRA': 0.9850366361468411,\n              'fn_edges': 191,\n              'fn_nodes': 0,\n              'fp_edges': 185,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 134},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.6666666666666666,\n                                 'Division Precision': 0.6704545454545454,\n                                 'Division Recall': 0.6629213483146067,\n                                 'False Negative Divisions': 83,\n                                 'False Positive Divisions': 79,\n                                 'Mitotic Branching Correctness': 0.542528735632184,\n                                 'Total GT Divisions': 356,\n                                 'Total Predicted Divisions': 352,\n                                 'True Positive Divisions': 236,\n                                 'Wrong Children Divisions': 37}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-embeddings-Bacteria-v1/151029_E1-1/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151029_E1-1\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151029_E1-5\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 2868\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 53/53 [00:00&lt;00:00, 2136.52it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 28242\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 177199\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 50.44153575203126\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 24.798470682141513\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 36.37385187823484\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 19.90996249605498\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 9.576563835144043\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 2.080282211303711\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 8.323134422302246\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 1.5467475652694702\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 231, max in edges: 160\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 2610\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/2864 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2864/2864 [00:00&lt;00:00, 294315.49it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2868 out of 2868 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2868 out of 2868 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/2868 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2868/2868 [00:00&lt;00:00, 572358.75it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/2864 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2864/2864 [00:00&lt;00:00, 920638.16it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/2866 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2866/2866 [00:00&lt;00:00, 961054.95it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 311.5,\n              'DET': 1.0,\n              'LNK': 0.9275412886717841,\n              'TRA': 0.9905545953485552,\n              'fn_edges': 101,\n              'fn_nodes': 0,\n              'fp_edges': 99,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 61},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.7347740667976423,\n                                 'Division Precision': 0.7362204724409449,\n                                 'Division Recall': 0.7333333333333333,\n                                 'False Negative Divisions': 37,\n                                 'False Positive Divisions': 36,\n                                 'Mitotic Branching Correctness': 0.6426116838487973,\n                                 'Total GT Divisions': 255,\n                                 'Total Predicted Divisions': 254,\n                                 'True Positive Divisions': 187,\n                                 'Wrong Children Divisions': 31}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-embeddings-Bacteria-v1/151029_E1-5/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151029_E1-5\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151101_E3-12\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 2526\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 55/55 [00:00&lt;00:00, 2490.95it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 24747\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 159056\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 58.07910323942435\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 33.97910604140836\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 43.344790661411494\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 27.59030250825304\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 9.49998950958252\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 2.197802782058716\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 8.261516571044922\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 1.6233735084533691\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 300, max in edges: 176\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 2279\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/2522 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2522/2522 [00:00&lt;00:00, 287415.35it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2526 out of 2526 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2526 out of 2526 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/2526 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2526/2526 [00:00&lt;00:00, 586450.34it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/2522 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2522/2522 [00:00&lt;00:00, 874434.54it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/2524 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2524/2524 [00:00&lt;00:00, 973016.85it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 389.0,\n              'DET': 1.0,\n              'LNK': 0.8972530375066032,\n              'TRA': 0.9866074502513255,\n              'fn_edges': 116,\n              'fn_nodes': 0,\n              'fp_edges': 114,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 101},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.6557377049180327,\n                                 'Division Precision': 0.6584362139917695,\n                                 'Division Recall': 0.6530612244897959,\n                                 'False Negative Divisions': 57,\n                                 'False Positive Divisions': 55,\n                                 'Mitotic Branching Correctness': 0.5333333333333333,\n                                 'Total GT Divisions': 245,\n                                 'Total Predicted Divisions': 243,\n                                 'True Positive Divisions': 160,\n                                 'Wrong Children Divisions': 28}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-embeddings-Bacteria-v1/151101_E3-12/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151101_E3-12\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 160112-06\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 1633\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 55/55 [00:00&lt;00:00, 3699.75it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 15851\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 100439\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 36.420020364149636\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 19.695178950638855\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 26.820009069607462\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 15.641332439978912\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 7.054508209228516\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 1.4812242984771729\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 6.124548435211182\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 1.0667351484298706\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 276, max in edges: 161\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 1491\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/1630 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1630/1630 [00:00&lt;00:00, 241264.62it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 1633 out of 1633 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 1633 out of 1633 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/1633 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1633/1633 [00:00&lt;00:00, 561095.96it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/1630 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1630/1630 [00:00&lt;00:00, 959404.37it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/1632 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1632/1632 [00:00&lt;00:00, 1015744.79it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 81.5,\n              'DET': 1.0,\n              'LNK': 0.9667075163398693,\n              'TRA': 0.9956598146767494,\n              'fn_edges': 23,\n              'fn_nodes': 0,\n              'fp_edges': 21,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 26},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.8571428571428571,\n                                 'Division Precision': 0.8633093525179856,\n                                 'Division Recall': 0.851063829787234,\n                                 'False Negative Divisions': 15,\n                                 'False Positive Divisions': 13,\n                                 'Mitotic Branching Correctness': 0.7792207792207793,\n                                 'Total GT Divisions': 141,\n                                 'Total Predicted Divisions': 139,\n                                 'True Positive Divisions': 120,\n                                 'Wrong Children Divisions': 6}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-embeddings-Bacteria-v1/160112-06/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 160112-06\n</pre> In\u00a0[17]: Copied! <pre>result_test_sequences = [\n    result_dir_name + \"/\" + test_sequence_name\n    for test_sequence_name in test_sequence_names\n]\ncumulate_scores(sequence_names=result_test_sequences)\n</pre> result_test_sequences = [     result_dir_name + \"/\" + test_sequence_name     for test_sequence_name in test_sequence_names ] cumulate_scores(sequence_names=result_test_sequences) <pre>AOGM | MBC | division_f1 | fp_divs | fn_divs | tp_divs | ws_edges | fp_edges | fn_edges | TRA\n284.250 | 0.629 | 0.727 | 37.000 | 39.333 | 176.667 | 65.833 | 85.667 | 88.500 | 0.988\n</pre>"},{"location":"examples/Bacteria/02-autoencoder/#02-train-auto-encoder-model","title":"02 - Train auto-encoder model.\u00b6","text":"<p>This notebook performs the following steps:</p> <ol> <li>Train an autoencoder model Image crops centered on detections are extracted from the raw dataset and used to train the model. You can choose between:</li> </ol> <ul> <li>A standard autoencoder, trained using a reconstruction loss to reproduce the input crops.</li> <li>A variational autoencoder (VAE), trained using a combination of negative log-likelihood and KL divergence loss.</li> </ul> <ol> <li>Infer embeddings using the trained encoder</li> </ol> <ul> <li>For a standard autoencoder, the encoder\u2019s output is directly used as the embedding.</li> <li>For a variational autoencoder, the posterior mean is used as the embedding representation.</li> </ul>"},{"location":"examples/Bacteria/02-autoencoder/#create-an-iterable-train-dataset","title":"Create an iterable, train dataset.\u00b6","text":"<p>It samples a random row from the detections file and extracts the image crop at that position.</p>"},{"location":"examples/Bacteria/02-autoencoder/#create-model","title":"Create model\u00b6","text":""},{"location":"examples/Bacteria/02-autoencoder/#train-model","title":"Train model\u00b6","text":""},{"location":"examples/Bacteria/02-autoencoder/#infer-embeddings","title":"Infer embeddings\u00b6","text":"<p>Next, we use the trained model weights to infer the embeddings for each detection in the dataset.</p>"},{"location":"examples/Bacteria/02-autoencoder/#compute-tracking-performance-using-dposition-and-dembedding-as-edge-costs","title":"Compute Tracking Performance using d(position) and d(embedding) as edge costs.\u00b6","text":"<p>Please ensure <code>gurobi</code> is installed for a faster solving experience.</p>"},{"location":"examples/Bacteria/02-autoencoder/#cumulate-scores","title":"Cumulate scores\u00b6","text":""},{"location":"examples/Bacteria/03-attrackt-unsupervised/","title":"03 - Train trackastra model with attrackt unsupervised loss.","text":"<p>Create a new dataset class that takes in the zarr container and the image and mask datasets.</p> In\u00a0[1]: Copied! <pre>from attrackt.trackastra.data import CTCZarrData\nimport torch\nfrom torch.utils.data import ConcatDataset\nfrom attrackt.trackastra.model import TrackingTransformer\nfrom functools import partial\nfrom attrackt.scripts.trackastra.train_fully_unsupervised import train\nfrom attrackt.scripts.trackastra.infer import infer\nfrom attrackt.scripts.motile import motile_infer\nfrom attrackt.scripts.cumulate_scores import cumulate_scores\nfrom attrackt.scripts.sort import sort\n</pre> from attrackt.trackastra.data import CTCZarrData import torch from torch.utils.data import ConcatDataset from attrackt.trackastra.model import TrackingTransformer from functools import partial from attrackt.scripts.trackastra.train_fully_unsupervised import train from attrackt.scripts.trackastra.infer import infer from attrackt.scripts.motile import motile_infer from attrackt.scripts.cumulate_scores import cumulate_scores from attrackt.scripts.sort import sort <pre>/Users/lalitm/miniforge3/envs/attrackt/lib/python3.10/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n  from .autonotebook import tqdm as notebook_tqdm\n</pre> In\u00a0[2]: Copied! <pre>suffix = \"Bacteria-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed.\ndata_dir = \"./data/Bacteria/\"\ndetections_csv = data_dir + \"/detections.csv\"\nembeddings_csv = f\"embeddings-{suffix}.csv\"\nsequences = [\n    \"140408-02\",\n    \"140408-04\",\n    \"140408-10\",\n    \"140409-03\",\n    \"140415-08\",\n    \"151027-05\",\n    \"151027-06\",\n    \"151027-10\",\n    \"151028-01\",\n    \"151029-05\",\n    \"151029-11\",\n    \"151029_E1-6\",\n    \"151101_E2-1\",\n    \"151101_E2-2\",\n    \"151101_E3-11\",\n    \"151101_E4-12\",\n    \"151101_E4-19\",\n    \"151101_E4-20\",\n    \"150317-07\",\n    \"150318-06\",\n    \"150331-12\",\n    \"151222-10\",\n    \"151222-11\",\n    \"150324-03\",\n    \"150324-05\",\n    \"150325-04\",\n    \"160112-04\",\n    \"150303-01\",\n    \"150428-08\",\n    \"151021-11\",\n    \"140415-13\",\n    \"151031-03\",\n    \"150309-04\",\n    \"150310-11\",\n    \"151029_E1-1\",\n    \"151029_E1-5\",\n    \"151101_E3-12\",\n    \"160112-06\",\n]\n</pre> suffix = \"Bacteria-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed. data_dir = \"./data/Bacteria/\" detections_csv = data_dir + \"/detections.csv\" embeddings_csv = f\"embeddings-{suffix}.csv\" sequences = [     \"140408-02\",     \"140408-04\",     \"140408-10\",     \"140409-03\",     \"140415-08\",     \"151027-05\",     \"151027-06\",     \"151027-10\",     \"151028-01\",     \"151029-05\",     \"151029-11\",     \"151029_E1-6\",     \"151101_E2-1\",     \"151101_E2-2\",     \"151101_E3-11\",     \"151101_E4-12\",     \"151101_E4-19\",     \"151101_E4-20\",     \"150317-07\",     \"150318-06\",     \"150331-12\",     \"151222-10\",     \"151222-11\",     \"150324-03\",     \"150324-05\",     \"150325-04\",     \"160112-04\",     \"150303-01\",     \"150428-08\",     \"151021-11\",     \"140415-13\",     \"151031-03\",     \"150309-04\",     \"150310-11\",     \"151029_E1-1\",     \"151029_E1-5\",     \"151101_E3-12\",     \"160112-06\", ] In\u00a0[3]: Copied! <pre>test_sequences = [\n    \"150309-04\",\n    \"150310-11\",\n    \"151029_E1-1\",\n    \"151029_E1-5\",\n    \"151101_E3-12\",\n    \"160112-06\",\n]\n</pre> test_sequences = [     \"150309-04\",     \"150310-11\",     \"151029_E1-1\",     \"151029_E1-5\",     \"151101_E3-12\",     \"160112-06\", ] In\u00a0[4]: Copied! <pre>crop_size = (256, 256)\nzarr_path = data_dir + \"/Bacteria.zarr\"\n</pre> crop_size = (256, 256) zarr_path = data_dir + \"/Bacteria.zarr\" In\u00a0[5]: Copied! <pre>ndim = 2\nwindow = 6\nmax_tokens = 2048\naugment = 2\nzarr_img_key = \"img\"\nzarr_mask_key = \"mask\"\nzarr_img_channel = 0\nzarr_mask_channel = 0\nn_jobs = 8\n</pre> ndim = 2 window = 6 max_tokens = 2048 augment = 2 zarr_img_key = \"img\" zarr_mask_key = \"mask\" zarr_img_channel = 0 zarr_mask_channel = 0 n_jobs = 8 In\u00a0[6]: Copied! <pre>ds_factory = partial(\n    CTCZarrData,\n    ndim=ndim,\n    window_size=window,\n    max_tokens=max_tokens,\n    augment=augment,\n    crop_size=crop_size,\n    zarr_path=zarr_path,\n    zarr_img_key=zarr_img_key,\n    zarr_mask_key=zarr_mask_key,\n    zarr_img_channel=zarr_img_channel,\n    zarr_mask_channel=zarr_mask_channel,\n    embeddings_csv=embeddings_csv,\n    n_jobs=n_jobs,\n)\n</pre> ds_factory = partial(     CTCZarrData,     ndim=ndim,     window_size=window,     max_tokens=max_tokens,     augment=augment,     crop_size=crop_size,     zarr_path=zarr_path,     zarr_img_key=zarr_img_key,     zarr_mask_key=zarr_mask_key,     zarr_img_channel=zarr_img_channel,     zarr_mask_channel=zarr_mask_channel,     embeddings_csv=embeddings_csv,     n_jobs=n_jobs, ) In\u00a0[7]: Copied! <pre>train_datasets = [ds_factory(zarr_sequence=seq) for seq in sequences]\nval_datasets = [\n    ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in sequences\n]\n</pre> train_datasets = [ds_factory(zarr_sequence=seq) for seq in sequences] val_datasets = [     ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in sequences ] <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140408-02, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                  | 0/107 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  39%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                     | 42/107 [00:00&lt;00:00, 415.43it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                   | 84/107 [00:00&lt;00:00, 418.08it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                             | 0/102 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7357 objects in 102 windows (5.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140408-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/93 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  31%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                             | 29/93 [00:00&lt;00:00, 281.02it/s]</pre> <pre>\rNormalizing:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                 | 58/93 [00:00&lt;00:00, 271.08it/s]</pre> <pre>\rNormalizing:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 86/93 [00:00&lt;00:00, 269.89it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/88 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 18687 objects in 88 windows (1.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140408-10, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/97 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  29%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                               | 28/97 [00:00&lt;00:00, 274.22it/s]</pre> <pre>\rNormalizing:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                     | 56/97 [00:00&lt;00:00, 264.46it/s]</pre> <pre>\rNormalizing:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589          | 86/97 [00:00&lt;00:00, 279.89it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 16030 objects in 92 windows (1.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140409-03, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/84 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  36%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                         | 30/84 [00:00&lt;00:00, 294.57it/s]</pre> <pre>\rNormalizing:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                      | 63/84 [00:00&lt;00:00, 311.01it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/79 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 17372 objects in 79 windows (1.4s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140415-08, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/69 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                  | 30/69 [00:00&lt;00:00, 292.26it/s]</pre> <pre>\rNormalizing:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 63/69 [00:00&lt;00:00, 313.04it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/64 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 8989 objects in 64 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151027-05, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/20 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/15 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2162 objects in 15 windows (0.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151027-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/21 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                         | 15/21 [00:00&lt;00:00, 142.65it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/16 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 3286 objects in 16 windows (0.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151027-10, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/23 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                  | 10/23 [00:00&lt;00:00, 98.01it/s]</pre> <pre>\rNormalizing:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 22/23 [00:00&lt;00:00, 110.68it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/18 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 4319 objects in 18 windows (0.9s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151028-01, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/19 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 19/19 [00:00&lt;00:00, 181.80it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/14 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2110 objects in 14 windows (0.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029-05, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/23 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c               | 19/23 [00:00&lt;00:00, 184.71it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/18 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 3040 objects in 18 windows (0.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                             | 16/24 [00:00&lt;00:00, 149.78it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/19 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 4241 objects in 19 windows (0.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-6, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/51 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  22%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                                     | 11/51 [00:00&lt;00:00, 106.49it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                  | 22/51 [00:00&lt;00:00, 102.97it/s]</pre> <pre>\rNormalizing:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                               | 33/51 [00:00&lt;00:00, 105.84it/s]</pre> <pre>\rNormalizing:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e        | 46/51 [00:00&lt;00:00, 112.18it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/46 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 11433 objects in 46 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E2-1, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  18%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                         | 10/55 [00:00&lt;00:00, 97.24it/s]</pre> <pre>\rNormalizing:  36%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                         | 20/55 [00:00&lt;00:00, 94.85it/s]</pre> <pre>\rNormalizing:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                         | 30/55 [00:00&lt;00:00, 95.73it/s]</pre> <pre>\rNormalizing:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                        | 40/55 [00:00&lt;00:00, 96.35it/s]</pre> <pre>\rNormalizing:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d      | 51/55 [00:00&lt;00:00, 99.23it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7714 objects in 50 windows (1.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E2-2, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  29%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                                                               | 16/55 [00:00&lt;00:00, 148.89it/s]</pre> <pre>\rNormalizing:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                      | 31/55 [00:00&lt;00:00, 146.07it/s]</pre> <pre>\rNormalizing:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e         | 49/55 [00:00&lt;00:00, 159.64it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 8215 objects in 50 windows (1.3s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E3-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                     | 22/55 [00:00&lt;00:00, 214.20it/s]</pre> <pre>\rNormalizing:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d              | 46/55 [00:00&lt;00:00, 227.40it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7199 objects in 50 windows (1.1s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E4-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/63 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  21%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                      | 13/63 [00:00&lt;00:00, 126.44it/s]</pre> <pre>\rNormalizing:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                 | 28/63 [00:00&lt;00:00, 136.85it/s]</pre> <pre>\rNormalizing:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                          | 44/63 [00:00&lt;00:00, 145.43it/s]</pre> <pre>\rNormalizing:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a    | 60/63 [00:00&lt;00:00, 150.37it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/58 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 10555 objects in 58 windows (1.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E4-19, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/60 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  18%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                        | 11/60 [00:00&lt;00:00, 102.72it/s]</pre> <pre>\rNormalizing:  38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                                       | 23/60 [00:00&lt;00:00, 106.86it/s]</pre> <pre>\rNormalizing:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                                     | 35/60 [00:00&lt;00:00, 109.27it/s]</pre> <pre>\rNormalizing:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                 | 48/60 [00:00&lt;00:00, 114.29it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\r</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 9587 objects in 55 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E4-20, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/63 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  13%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                               | 8/63 [00:00&lt;00:00, 73.81it/s]</pre> <pre>\rNormalizing:  25%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                                   | 16/63 [00:00&lt;00:00, 72.87it/s]</pre> <pre>\rNormalizing:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                      | 25/63 [00:00&lt;00:00, 79.35it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                          | 33/63 [00:00&lt;00:00, 78.54it/s]</pre> <pre>\rNormalizing:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                            | 43/63 [00:00&lt;00:00, 83.79it/s]</pre> <pre>\rNormalizing:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b              | 53/63 [00:00&lt;00:00, 87.46it/s]</pre> <pre>\rNormalizing: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 63/63 [00:00&lt;00:00, 89.85it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/58 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 12999 objects in 58 windows (2.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150317-07, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/34 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                       | 19/34 [00:00&lt;00:00, 185.98it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 5561 objects in 29 windows (0.9s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150318-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                | 11/24 [00:00&lt;00:00, 107.22it/s]</pre> <pre>\rNormalizing:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c       | 22/24 [00:00&lt;00:00, 103.68it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/19 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 6325 objects in 19 windows (1.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150331-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/70 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  19%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                        | 13/70 [00:00&lt;00:00, 119.97it/s]</pre> <pre>\rNormalizing:  36%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                         | 25/70 [00:00&lt;00:00, 109.91it/s]</pre> <pre>\rNormalizing:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                          | 37/70 [00:00&lt;00:00, 110.72it/s]</pre> <pre>\rNormalizing:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                         | 50/70 [00:00&lt;00:00, 114.24it/s]</pre> <pre>\rNormalizing:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588         | 63/70 [00:00&lt;00:00, 117.10it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/65 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 19585 objects in 65 windows (2.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151222-10, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/54 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  41%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                    | 22/54 [00:00&lt;00:00, 217.32it/s]</pre> <pre>\rNormalizing:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                | 44/54 [00:00&lt;00:00, 216.40it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/49 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 19636 objects in 49 windows (1.1s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151222-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  34%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                          | 17/50 [00:00&lt;00:00, 165.67it/s]</pre> <pre>\rNormalizing:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                         | 36/50 [00:00&lt;00:00, 177.93it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/45 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 22357 objects in 45 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150324-03, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/77 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  14%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                                            | 11/77 [00:00&lt;00:00, 103.70it/s]</pre> <pre>\rNormalizing:  30%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                              | 23/77 [00:00&lt;00:00, 112.44it/s]</pre> <pre>\rNormalizing:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                              | 37/77 [00:00&lt;00:00, 122.21it/s]</pre> <pre>\rNormalizing:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                              | 51/77 [00:00&lt;00:00, 126.13it/s]</pre> <pre>\rNormalizing:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e            | 66/77 [00:00&lt;00:00, 131.08it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/72 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 21668 objects in 72 windows (2.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150324-05, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/69 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  16%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                                          | 11/69 [00:00&lt;00:00, 103.39it/s]</pre> <pre>\rNormalizing:  32%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                             | 22/69 [00:00&lt;00:00, 94.24it/s]</pre> <pre>\rNormalizing:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                               | 33/69 [00:00&lt;00:00, 97.77it/s]</pre> <pre>\rNormalizing:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                | 44/69 [00:00&lt;00:00, 101.26it/s]</pre> <pre>\rNormalizing:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                  | 55/69 [00:00&lt;00:00, 103.36it/s]</pre> <pre>\rNormalizing:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 68/69 [00:00&lt;00:00, 111.52it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/64 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 23877 objects in 64 windows (2.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150325-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/70 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  23%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                    | 16/70 [00:00&lt;00:00, 152.07it/s]</pre> <pre>\rNormalizing:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                | 32/70 [00:00&lt;00:00, 148.86it/s]</pre> <pre>\rNormalizing:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                          | 49/70 [00:00&lt;00:00, 158.09it/s]</pre> <pre>\rNormalizing:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b | 69/70 [00:00&lt;00:00, 172.75it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/65 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 12426 objects in 65 windows (1.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=160112-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/58 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                     | 23/58 [00:00&lt;00:00, 226.89it/s]</pre> <pre>\rNormalizing:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f             | 49/58 [00:00&lt;00:00, 242.54it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 8668 objects in 53 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150303-01, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/76 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  22%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                                                                     | 17/76 [00:00&lt;00:00, 169.99it/s]</pre> <pre>\rNormalizing:  47%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                              | 36/76 [00:00&lt;00:00, 178.38it/s]</pre> <pre>\rNormalizing:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                        | 55/76 [00:00&lt;00:00, 181.80it/s]</pre> <pre>\rNormalizing:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 74/76 [00:00&lt;00:00, 184.54it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/71 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 4712 objects in 71 windows (1.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150428-08, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/62 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  34%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                          | 21/62 [00:00&lt;00:00, 203.37it/s]</pre> <pre>\rNormalizing:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                            | 42/62 [00:00&lt;00:00, 206.95it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/57 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 12461 objects in 57 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151021-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/56 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                           | 29/56 [00:00&lt;00:00, 288.53it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/51 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 17428 objects in 51 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140415-13, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/79 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                 | 35/79 [00:00&lt;00:00, 349.83it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\r</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/74 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 13063 objects in 74 windows (1.3s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151031-03, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/23 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/18 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 1484 objects in 18 windows (0.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150309-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  12%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                                              | 11/92 [00:00&lt;00:00, 109.43it/s]</pre> <pre>\rNormalizing:  25%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                  | 23/92 [00:00&lt;00:00, 113.78it/s]</pre> <pre>\rNormalizing:  39%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                      | 36/92 [00:00&lt;00:00, 117.96it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                          | 48/92 [00:00&lt;00:00, 112.36it/s]</pre> <pre>\rNormalizing:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                              | 61/92 [00:00&lt;00:00, 114.31it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 73/92 [00:00&lt;00:00, 114.71it/s]</pre> <pre>\rNormalizing:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f    | 87/92 [00:00&lt;00:00, 121.54it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 33349 objects in 87 windows (2.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150310-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                        | 16/29 [00:00&lt;00:00, 152.91it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2300 objects in 24 windows (0.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-1, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  26%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                 | 14/53 [00:00&lt;00:00, 136.35it/s]</pre> <pre>\rNormalizing:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                          | 28/53 [00:00&lt;00:00, 131.09it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 42/53 [00:00&lt;00:00, 133.13it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\r</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 16592 objects in 48 windows (1.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-5, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                       | 20/53 [00:00&lt;00:00, 198.71it/s]</pre> <pre>\rNormalizing:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                     | 40/53 [00:00&lt;00:00, 195.36it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 13576 objects in 48 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E3-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  22%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                     | 12/55 [00:00&lt;00:00, 110.56it/s]</pre> <pre>\rNormalizing:  45%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                | 25/55 [00:00&lt;00:00, 115.81it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                             | 37/55 [00:00&lt;00:00, 117.04it/s]</pre> <pre>\rNormalizing:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589        | 50/55 [00:00&lt;00:00, 121.62it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 11832 objects in 50 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=160112-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                           | 28/55 [00:00&lt;00:00, 272.65it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7866 objects in 50 windows (1.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140408-02, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                  | 0/107 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                      | 41/107 [00:00&lt;00:00, 404.35it/s]</pre> <pre>\rNormalizing:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                    | 82/107 [00:00&lt;00:00, 407.10it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                             | 0/102 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7357 objects in 102 windows (1.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140408-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/93 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  31%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                             | 29/93 [00:00&lt;00:00, 280.36it/s]</pre> <pre>\rNormalizing:  62%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                 | 58/93 [00:00&lt;00:00, 273.31it/s]</pre> <pre>\rNormalizing:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 86/93 [00:00&lt;00:00, 276.17it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/88 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 18687 objects in 88 windows (1.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140408-10, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/97 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  29%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                               | 28/97 [00:00&lt;00:00, 277.91it/s]</pre> <pre>\rNormalizing:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                     | 56/97 [00:00&lt;00:00, 268.74it/s]</pre> <pre>\rNormalizing:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a         | 87/97 [00:00&lt;00:00, 284.79it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 16030 objects in 92 windows (1.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140409-03, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/84 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  36%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                         | 30/84 [00:00&lt;00:00, 297.25it/s]</pre> <pre>\rNormalizing:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                      | 63/84 [00:00&lt;00:00, 315.95it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/79 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 17372 objects in 79 windows (1.4s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140415-08, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/69 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  42%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                   | 29/69 [00:00&lt;00:00, 289.73it/s]</pre> <pre>\rNormalizing:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 63/69 [00:00&lt;00:00, 313.53it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/64 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 8989 objects in 64 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151027-05, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/20 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/15 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2162 objects in 15 windows (0.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151027-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/21 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                         | 15/21 [00:00&lt;00:00, 147.16it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/16 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 3286 objects in 16 windows (0.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151027-10, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/23 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                  | 10/23 [00:00&lt;00:00, 96.59it/s]</pre> <pre>\rNormalizing:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 22/23 [00:00&lt;00:00, 109.15it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/18 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 4319 objects in 18 windows (0.9s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151028-01, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/19 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e    | 18/19 [00:00&lt;00:00, 175.21it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/14 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2110 objects in 14 windows (0.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029-05, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/23 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c               | 19/23 [00:00&lt;00:00, 185.57it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/18 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 3040 objects in 18 windows (0.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                             | 16/24 [00:00&lt;00:00, 151.74it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/19 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 4241 objects in 19 windows (0.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-6, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/51 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  22%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                                     | 11/51 [00:00&lt;00:00, 107.76it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                  | 22/51 [00:00&lt;00:00, 104.38it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                             | 34/51 [00:00&lt;00:00, 107.44it/s]</pre> <pre>\rNormalizing:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588       | 47/51 [00:00&lt;00:00, 113.09it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/46 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 11433 objects in 46 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E2-1, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  18%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                         | 10/55 [00:00&lt;00:00, 98.53it/s]</pre> <pre>\rNormalizing:  36%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                         | 20/55 [00:00&lt;00:00, 94.93it/s]</pre> <pre>\rNormalizing:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                         | 30/55 [00:00&lt;00:00, 96.90it/s]</pre> <pre>\rNormalizing:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                        | 40/55 [00:00&lt;00:00, 97.41it/s]</pre> <pre>\rNormalizing:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c      | 51/55 [00:00&lt;00:00, 100.49it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7714 objects in 50 windows (1.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E2-2, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  27%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                | 15/55 [00:00&lt;00:00, 147.06it/s]</pre> <pre>\rNormalizing:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                        | 30/55 [00:00&lt;00:00, 146.36it/s]</pre> <pre>\rNormalizing:  87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b           | 48/55 [00:00&lt;00:00, 160.26it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 8215 objects in 50 windows (1.3s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E3-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                     | 22/55 [00:00&lt;00:00, 213.45it/s]</pre> <pre>\rNormalizing:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d              | 46/55 [00:00&lt;00:00, 227.24it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7199 objects in 50 windows (1.1s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E4-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/63 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  21%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                      | 13/63 [00:00&lt;00:00, 126.13it/s]</pre> <pre>\rNormalizing:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                 | 28/63 [00:00&lt;00:00, 136.30it/s]</pre> <pre>\rNormalizing:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                          | 44/63 [00:00&lt;00:00, 144.81it/s]</pre> <pre>\rNormalizing:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f  | 61/63 [00:00&lt;00:00, 150.91it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/58 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 10555 objects in 58 windows (1.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E4-19, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/60 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  18%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                        | 11/60 [00:00&lt;00:00, 104.19it/s]</pre> <pre>\rNormalizing:  38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                                       | 23/60 [00:00&lt;00:00, 107.73it/s]</pre> <pre>\rNormalizing:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                                     | 35/60 [00:00&lt;00:00, 109.39it/s]</pre> <pre>\rNormalizing:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                 | 48/60 [00:00&lt;00:00, 114.39it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\r</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 9587 objects in 55 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E4-20, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/63 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  13%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                               | 8/63 [00:00&lt;00:00, 76.76it/s]</pre> <pre>\rNormalizing:  25%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                                   | 16/63 [00:00&lt;00:00, 74.66it/s]</pre> <pre>\rNormalizing:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                      | 25/63 [00:00&lt;00:00, 81.25it/s]</pre> <pre>\rNormalizing:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                         | 34/63 [00:00&lt;00:00, 80.30it/s]</pre> <pre>\rNormalizing:  70%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                           | 44/63 [00:00&lt;00:00, 85.31it/s]</pre> <pre>\rNormalizing:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f            | 54/63 [00:00&lt;00:00, 87.05it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/58 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 12999 objects in 58 windows (2.1s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150317-07, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/34 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                       | 19/34 [00:00&lt;00:00, 187.21it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 5561 objects in 29 windows (0.9s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150318-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                | 11/24 [00:00&lt;00:00, 105.79it/s]</pre> <pre>\rNormalizing:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c       | 22/24 [00:00&lt;00:00, 102.20it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/19 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 6325 objects in 19 windows (1.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150331-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/70 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  19%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                        | 13/70 [00:00&lt;00:00, 120.02it/s]</pre> <pre>\rNormalizing:  37%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                                        | 26/70 [00:00&lt;00:00, 109.89it/s]</pre> <pre>\rNormalizing:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                        | 38/70 [00:00&lt;00:00, 109.55it/s]</pre> <pre>\rNormalizing:  73%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                        | 51/70 [00:00&lt;00:00, 113.01it/s]</pre> <pre>\rNormalizing:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 64/70 [00:00&lt;00:00, 117.75it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/65 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 19585 objects in 65 windows (2.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151222-10, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/54 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                                                   | 23/54 [00:00&lt;00:00, 219.65it/s]</pre> <pre>\rNormalizing:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f              | 45/54 [00:00&lt;00:00, 216.77it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/49 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 19636 objects in 49 windows (1.1s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151222-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  34%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                          | 17/50 [00:00&lt;00:00, 163.14it/s]</pre> <pre>\rNormalizing:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                         | 36/50 [00:00&lt;00:00, 178.14it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/45 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 22357 objects in 45 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150324-03, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/77 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  14%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                                            | 11/77 [00:00&lt;00:00, 102.36it/s]</pre> <pre>\rNormalizing:  30%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                              | 23/77 [00:00&lt;00:00, 111.89it/s]</pre> <pre>\rNormalizing:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                              | 37/77 [00:00&lt;00:00, 120.91it/s]</pre> <pre>\rNormalizing:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                              | 51/77 [00:00&lt;00:00, 124.92it/s]</pre> <pre>\rNormalizing:  86%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e            | 66/77 [00:00&lt;00:00, 130.50it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/72 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 21668 objects in 72 windows (2.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150324-05, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/69 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  16%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                                          | 11/69 [00:00&lt;00:00, 104.56it/s]</pre> <pre>\rNormalizing:  32%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                             | 22/69 [00:00&lt;00:00, 94.59it/s]</pre> <pre>\rNormalizing:  48%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                               | 33/69 [00:00&lt;00:00, 98.40it/s]</pre> <pre>\rNormalizing:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                | 44/69 [00:00&lt;00:00, 101.82it/s]</pre> <pre>\rNormalizing:  81%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                | 56/69 [00:00&lt;00:00, 104.76it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/64 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 23877 objects in 64 windows (2.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150325-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/70 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  23%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                    | 16/70 [00:00&lt;00:00, 151.83it/s]</pre> <pre>\rNormalizing:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                | 32/70 [00:00&lt;00:00, 148.82it/s]</pre> <pre>\rNormalizing:  71%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                         | 50/70 [00:00&lt;00:00, 159.90it/s]</pre> <pre>\rNormalizing: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 70/70 [00:00&lt;00:00, 173.90it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/65 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 12426 objects in 65 windows (1.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=160112-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/58 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                     | 23/58 [00:00&lt;00:00, 229.03it/s]</pre> <pre>\rNormalizing:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f             | 49/58 [00:00&lt;00:00, 243.67it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 8668 objects in 53 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150303-01, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/76 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  24%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                                                    | 18/76 [00:00&lt;00:00, 173.27it/s]</pre> <pre>\rNormalizing:  47%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                              | 36/76 [00:00&lt;00:00, 176.59it/s]</pre> <pre>\rNormalizing:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                        | 55/76 [00:00&lt;00:00, 181.75it/s]</pre> <pre>\rNormalizing:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b  | 74/76 [00:00&lt;00:00, 183.48it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/71 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 4712 objects in 71 windows (1.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150428-08, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/62 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  34%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                          | 21/62 [00:00&lt;00:00, 206.07it/s]</pre> <pre>\rNormalizing:  69%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                           | 43/62 [00:00&lt;00:00, 209.73it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/57 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 12461 objects in 57 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151021-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/56 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                           | 29/56 [00:00&lt;00:00, 287.85it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/51 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 17428 objects in 51 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=140415-13, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/79 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  46%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                | 36/79 [00:00&lt;00:00, 352.03it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\r</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/74 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 13063 objects in 74 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151031-03, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/23 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/18 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 1484 objects in 18 windows (0.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150309-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  13%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                             | 12/92 [00:00&lt;00:00, 108.37it/s]</pre> <pre>\rNormalizing:  27%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                                | 25/92 [00:00&lt;00:00, 117.30it/s]</pre> <pre>\rNormalizing:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                     | 37/92 [00:00&lt;00:00, 118.02it/s]</pre> <pre>\rNormalizing:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                         | 49/92 [00:00&lt;00:00, 113.10it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                             | 62/92 [00:00&lt;00:00, 115.22it/s]</pre> <pre>\rNormalizing:  80%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                 | 74/92 [00:00&lt;00:00, 115.47it/s]</pre> <pre>\rNormalizing:  97%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588   | 89/92 [00:00&lt;00:00, 123.89it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 33349 objects in 87 windows (2.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150310-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                        | 16/29 [00:00&lt;00:00, 152.51it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2300 objects in 24 windows (0.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-1, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  26%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                 | 14/53 [00:00&lt;00:00, 137.38it/s]</pre> <pre>\rNormalizing:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                          | 28/53 [00:00&lt;00:00, 133.23it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 42/53 [00:00&lt;00:00, 134.62it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 16592 objects in 48 windows (1.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-5, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                       | 20/53 [00:00&lt;00:00, 195.71it/s]</pre> <pre>\rNormalizing:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                     | 40/53 [00:00&lt;00:00, 193.28it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 13576 objects in 48 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E3-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  22%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                     | 12/55 [00:00&lt;00:00, 110.07it/s]</pre> <pre>\rNormalizing:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                  | 24/55 [00:00&lt;00:00, 113.67it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                             | 37/55 [00:00&lt;00:00, 115.54it/s]</pre> <pre>\rNormalizing:  93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c      | 51/55 [00:00&lt;00:00, 122.55it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 11832 objects in 50 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=160112-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                           | 28/55 [00:00&lt;00:00, 275.24it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7866 objects in 50 windows (1.0s)\n</pre> In\u00a0[8]: Copied! <pre>datasets = {\n    \"train\": ConcatDataset(train_datasets),\n    \"val\": ConcatDataset(val_datasets),\n}\n</pre> datasets = {     \"train\": ConcatDataset(train_datasets),     \"val\": ConcatDataset(val_datasets), } In\u00a0[9]: Copied! <pre>d_model = 256\nnum_encoder_layers = 6\nnum_decoder_layers = 6\nnhead = 4\npos_embed_per_dim = 32\nfeat_embed_per_dim = 8\nspatial_pos_cutoff = 256\nattn_positional_bias = \"rope\"\nattn_positional_bias_n_spatial = 16\ndropout = 0.1\ncausal_norm = \"quiet_softmax\"\n</pre> d_model = 256 num_encoder_layers = 6 num_decoder_layers = 6 nhead = 4 pos_embed_per_dim = 32 feat_embed_per_dim = 8 spatial_pos_cutoff = 256 attn_positional_bias = \"rope\" attn_positional_bias_n_spatial = 16 dropout = 0.1 causal_norm = \"quiet_softmax\" In\u00a0[10]: Copied! <pre>model = TrackingTransformer(\n    coord_dim=ndim,\n    feat_dim=datasets[\"train\"].datasets[0].feat_dim,\n    d_model=d_model,\n    pos_embed_per_dim=pos_embed_per_dim,\n    feat_embed_per_dim=feat_embed_per_dim,\n    num_encoder_layers=num_encoder_layers,\n    num_decoder_layers=num_decoder_layers,\n    dropout=dropout,\n    window=window,\n    spatial_pos_cutoff=spatial_pos_cutoff,\n    attn_positional_bias=attn_positional_bias,\n    attn_positional_bias_n_spatial=attn_positional_bias_n_spatial,\n    causal_norm=causal_norm,\n    nhead=nhead,\n)\n</pre> model = TrackingTransformer(     coord_dim=ndim,     feat_dim=datasets[\"train\"].datasets[0].feat_dim,     d_model=d_model,     pos_embed_per_dim=pos_embed_per_dim,     feat_embed_per_dim=feat_embed_per_dim,     num_encoder_layers=num_encoder_layers,     num_decoder_layers=num_decoder_layers,     dropout=dropout,     window=window,     spatial_pos_cutoff=spatial_pos_cutoff,     attn_positional_bias=attn_positional_bias,     attn_positional_bias_n_spatial=attn_positional_bias_n_spatial,     causal_norm=causal_norm,     nhead=nhead, ) In\u00a0[11]: Copied! <pre>num_iterations = 1000_000\nlearning_rate = 1e-4\nbatch_size = 8\nlambda_ = 0.1\nnum_workers = 2\nd_model = 64\n</pre> num_iterations = 1000_000 learning_rate = 1e-4 batch_size = 8 lambda_ = 0.1 num_workers = 2 d_model = 64 <p>Uncomment the next few lines to begin the training!</p> In\u00a0[12]: Copied! <pre># train(\n#    datasets=datasets,\n#    model=model,\n#    batch_size=batch_size,\n#    learning_rate=learning_rate,\n#    device=\"cuda\" if torch.cuda.is_available() else \"mps\",\n#    num_iterations=num_iterations,\n#    num_workers=num_workers,\n#    causal_norm=causal_norm,\n#    lambda_=lambda_,\n#    window=window,\n#    d_model=d_model,\n#    log_loss_every=1_000,\n#    suffix=suffix,\n# )\n</pre> # train( #    datasets=datasets, #    model=model, #    batch_size=batch_size, #    learning_rate=learning_rate, #    device=\"cuda\" if torch.cuda.is_available() else \"mps\", #    num_iterations=num_iterations, #    num_workers=num_workers, #    causal_norm=causal_norm, #    lambda_=lambda_, #    window=window, #    d_model=d_model, #    log_loss_every=1_000, #    suffix=suffix, # ) In\u00a0[13]: Copied! <pre>edge_embedding_file_name = f\"associations-{suffix}.csv\"\nmodel_checkpoint = f\"fully-unsupervised-2025-10-21-{suffix}/models/best/best.pth\"  # Path to a saved model checkpoint. Modify accordingly.\n</pre> edge_embedding_file_name = f\"associations-{suffix}.csv\" model_checkpoint = f\"fully-unsupervised-2025-10-21-{suffix}/models/best/best.pth\"  # Path to a saved model checkpoint. Modify accordingly. <p>Uncomment the next few lines to use the trained model to infer the associations!</p> In\u00a0[14]: Copied! <pre># infer(\n#    model_checkpoint= model_checkpoint,\n#    transformer=model,\n#    zarr_img_channel=0,\n#    zarr_img_key=\"img\",\n#    zarr_mask_channel=0,\n#    zarr_mask_key=\"mask\",\n#    zarr_path=data_dir + \"/Bacteria.zarr\",\n#    test_zarr_sequences=test_sequences,\n#    output_csv_file_name=edge_embedding_file_name,\n#    edge_threshold=0.01,\n#    test_time_augmentation=True,\n# )\n</pre> # infer( #    model_checkpoint= model_checkpoint, #    transformer=model, #    zarr_img_channel=0, #    zarr_img_key=\"img\", #    zarr_mask_channel=0, #    zarr_mask_key=\"mask\", #    zarr_path=data_dir + \"/Bacteria.zarr\", #    test_zarr_sequences=test_sequences, #    output_csv_file_name=edge_embedding_file_name, #    edge_threshold=0.01, #    test_time_augmentation=True, # ) In\u00a0[15]: Copied! <pre>result_dir_name = f\"results-position-and-associations-{suffix}\"\n</pre> result_dir_name = f\"results-position-and-associations-{suffix}\" In\u00a0[16]: Copied! <pre>args = {\n    \"num_nearest_neighbours\": 10,\n    \"direction_candidate_graph\": \"backward\",\n    \"pin_nodes\": True,\n    \"use_edge_distance\": True,\n    \"edge_embedding_exists\": True,\n    \"use_different_weights_hyper\": True,\n    \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},\n    \"test_csv_file_name\": detections_csv,\n    \"edge_embedding_file_name\": edge_embedding_file_name,\n    \"embedding_type\": \"affinity\",\n    \"sequence_names\": test_sequences,\n    \"result_dir_name\": result_dir_name,\n    \"verbose\": False,\n}\n</pre> args = {     \"num_nearest_neighbours\": 10,     \"direction_candidate_graph\": \"backward\",     \"pin_nodes\": True,     \"use_edge_distance\": True,     \"edge_embedding_exists\": True,     \"use_different_weights_hyper\": True,     \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},     \"test_csv_file_name\": detections_csv,     \"edge_embedding_file_name\": edge_embedding_file_name,     \"embedding_type\": \"affinity\",     \"sequence_names\": test_sequences,     \"result_dir_name\": result_dir_name,     \"verbose\": False, } In\u00a0[17]: Copied! <pre>motile_infer(args)\n</pre> motile_infer(args) <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 150309-04\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 6387\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 92/92 [00:00&lt;00:00, 1700.40it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 63363\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 382454\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 46.66863321787835\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 21.828665413474187\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 32.74583982931663\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 16.856507768282484\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.06957931156144787\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.19130560670574645\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.06639899398827638\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.12676806848173158\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 231, max in edges: 161\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 6035\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/6386 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6386/6386 [00:00&lt;00:00, 307197.13it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 6387 out of 6387 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 6387 out of 6387 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/6387 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6387/6387 [00:00&lt;00:00, 576293.85it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/6386 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6386/6386 [00:00&lt;00:00, 944258.10it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/6386 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6386/6386 [00:00&lt;00:00, 999433.78it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 65.0,\n              'DET': 1.0,\n              'LNK': 0.9932143229982253,\n              'TRA': 0.999115032199213,\n              'fn_edges': 18,\n              'fn_nodes': 0,\n              'fp_edges': 18,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 20},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.9601139601139601,\n                                 'Division Precision': 0.9601139601139601,\n                                 'Division Recall': 0.9601139601139601,\n                                 'False Negative Divisions': 11,\n                                 'False Positive Divisions': 11,\n                                 'Mitotic Branching Correctness': 0.930939226519337,\n                                 'Total GT Divisions': 351,\n                                 'Total Predicted Divisions': 351,\n                                 'True Positive Divisions': 337,\n                                 'Wrong Children Divisions': 3}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-associations-Bacteria-v1/150309-04/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 150309-04\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 150310-11\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 550\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 29/29 [00:00&lt;00:00, 4932.67it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 5157\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 34766\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 53.21799456985325\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 25.15642099619311\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 39.28573919870244\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 20.89419060346398\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.05573133792780919\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.13316196516264825\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.047971081466935635\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.08342053344437397\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 351, max in edges: 186\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 474\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                               | 0/547 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 547/547 [00:00&lt;00:00, 264257.58it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 550 out of 550 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 550 out of 550 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                             | 0/550 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 550/550 [00:00&lt;00:00, 570441.94it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                          | 0/547 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 547/547 [00:00&lt;00:00, 974632.24it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                          | 0/548 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 548/548 [00:00&lt;00:00, 1017025.93it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 144.0,\n              'DET': 1.0,\n              'LNK': 0.8248175182481752,\n              'TRA': 0.9772223979753243,\n              'fn_edges': 46,\n              'fn_nodes': 0,\n              'fp_edges': 45,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 30},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.5850340136054422,\n                                 'Division Precision': 0.589041095890411,\n                                 'Division Recall': 0.581081081081081,\n                                 'False Negative Divisions': 17,\n                                 'False Positive Divisions': 16,\n                                 'Mitotic Branching Correctness': 0.4777777777777778,\n                                 'Total GT Divisions': 74,\n                                 'Total Predicted Divisions': 73,\n                                 'True Positive Divisions': 43,\n                                 'Wrong Children Divisions': 14}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-associations-Bacteria-v1/150310-11/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 150310-11\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151029_E1-1\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 3519\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 53/53 [00:00&lt;00:00, 1785.41it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 34764\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 223483\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 54.977630344171835\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 29.493654973523615\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 40.21937014949374\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 24.1673141110037\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.05128941253218669\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.1286985318539703\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.04750021515276166\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.08389906712736749\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 300, max in edges: 187\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 3160\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/3515 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3515/3515 [00:00&lt;00:00, 282670.81it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 3519 out of 3519 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 3519 out of 3519 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/3519 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3519/3519 [00:00&lt;00:00, 573506.21it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/3515 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3515/3515 [00:00&lt;00:00, 942645.69it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/3517 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3517/3517 [00:00&lt;00:00, 1036274.48it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 423.0,\n              'DET': 1.0,\n              'LNK': 0.9198180267273244,\n              'TRA': 0.9895466508507247,\n              'fn_edges': 126,\n              'fn_nodes': 0,\n              'fp_edges': 124,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 110},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.7679324894514769,\n                                 'Division Precision': 0.7690140845070422,\n                                 'Division Recall': 0.7668539325842697,\n                                 'False Negative Divisions': 61,\n                                 'False Positive Divisions': 60,\n                                 'Mitotic Branching Correctness': 0.65625,\n                                 'Total GT Divisions': 356,\n                                 'Total Predicted Divisions': 355,\n                                 'True Positive Divisions': 273,\n                                 'Wrong Children Divisions': 22}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-associations-Bacteria-v1/151029_E1-1/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151029_E1-1\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151029_E1-5\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 2868\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 53/53 [00:00&lt;00:00, 2152.99it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 28242\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 177199\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 50.44153575203126\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 24.798470682141513\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 36.37385187823484\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 19.90996249605498\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.053719739362908234\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.13711325932933172\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.05028499195039044\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.0907775086263346\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 231, max in edges: 160\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 2610\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/2863 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2863/2863 [00:00&lt;00:00, 260579.66it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2868 out of 2868 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2868 out of 2868 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/2868 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2868/2868 [00:00&lt;00:00, 573477.49it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/2863 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2863/2863 [00:00&lt;00:00, 952132.28it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/2866 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2866/2866 [00:00&lt;00:00, 1019236.50it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 165.5,\n              'DET': 1.0,\n              'LNK': 0.9615026750407072,\n              'TRA': 0.9949816549925711,\n              'fn_edges': 51,\n              'fn_nodes': 0,\n              'fp_edges': 48,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 41},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.8503937007874015,\n                                 'Division Precision': 0.8537549407114624,\n                                 'Division Recall': 0.8470588235294118,\n                                 'False Negative Divisions': 25,\n                                 'False Positive Divisions': 23,\n                                 'Mitotic Branching Correctness': 0.7769784172661871,\n                                 'Total GT Divisions': 255,\n                                 'Total Predicted Divisions': 253,\n                                 'True Positive Divisions': 216,\n                                 'Wrong Children Divisions': 14}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-associations-Bacteria-v1/151029_E1-5/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151029_E1-5\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151101_E3-12\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 2526\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 55/55 [00:00&lt;00:00, 2533.15it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 24747\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 159056\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 58.07910323942435\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 33.97910604140836\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 43.344790661411494\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 27.59030250825304\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.05406737500777522\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.13216254822414678\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.049215101839077506\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.08507045831767336\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 300, max in edges: 176\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 2279\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/2520 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2520/2520 [00:00&lt;00:00, 282951.31it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2526 out of 2526 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2526 out of 2526 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/2526 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2526/2526 [00:00&lt;00:00, 583222.06it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/2520 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2520/2520 [00:00&lt;00:00, 893234.69it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/2524 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2524/2524 [00:00&lt;00:00, 976067.06it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 217.0,\n              'DET': 1.0,\n              'LNK': 0.9426835710512415,\n              'TRA': 0.9925290917854438,\n              'fn_edges': 60,\n              'fn_nodes': 0,\n              'fp_edges': 56,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 71},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.8024691358024691,\n                                 'Division Precision': 0.8091286307053942,\n                                 'Division Recall': 0.7959183673469388,\n                                 'False Negative Divisions': 39,\n                                 'False Positive Divisions': 35,\n                                 'Mitotic Branching Correctness': 0.6964285714285714,\n                                 'Total GT Divisions': 245,\n                                 'Total Predicted Divisions': 241,\n                                 'True Positive Divisions': 195,\n                                 'Wrong Children Divisions': 11}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-associations-Bacteria-v1/151101_E3-12/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151101_E3-12\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 160112-06\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 1633\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 55/55 [00:00&lt;00:00, 3631.83it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 15851\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 100439\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 36.420020364149636\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 19.695178950638855\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 26.820009069607462\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 15.641332439978912\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.06420497193670016\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.16882017823437487\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.05848114411464092\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.10883780819133848\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 276, max in edges: 161\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 1491\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/1632 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1632/1632 [00:00&lt;00:00, 281436.73it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 1633 out of 1633 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 1633 out of 1633 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/1633 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1633/1633 [00:00&lt;00:00, 563496.37it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/1632 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1632/1632 [00:00&lt;00:00, 955486.34it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/1632 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1632/1632 [00:00&lt;00:00, 970936.76it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 57.0,\n              'DET': 1.0,\n              'LNK': 0.9767156862745098,\n              'TRA': 0.9969645329641069,\n              'fn_edges': 18,\n              'fn_nodes': 0,\n              'fp_edges': 18,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 12},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.8865248226950354,\n                                 'Division Precision': 0.8865248226950354,\n                                 'Division Recall': 0.8865248226950354,\n                                 'False Negative Divisions': 7,\n                                 'False Positive Divisions': 7,\n                                 'Mitotic Branching Correctness': 0.8445945945945946,\n                                 'Total GT Divisions': 141,\n                                 'Total Predicted Divisions': 141,\n                                 'True Positive Divisions': 125,\n                                 'Wrong Children Divisions': 9}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-associations-Bacteria-v1/160112-06/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 160112-06\n</pre> In\u00a0[18]: Copied! <pre>sort(\n    detection_csv_file_name=detections_csv,\n    prediction_csv_file_name=edge_embedding_file_name,\n    ilp_csv_file_name=f\"{result_dir_name}/tracking_results.csv\",\n    output_csv_file_name=\"sorted.csv\",\n    method=\"confidence\",\n    sequences=test_sequences,\n    suffix=suffix,\n)\n</pre> sort(     detection_csv_file_name=detections_csv,     prediction_csv_file_name=edge_embedding_file_name,     ilp_csv_file_name=f\"{result_dir_name}/tracking_results.csv\",     output_csv_file_name=\"sorted.csv\",     method=\"confidence\",     sequences=test_sequences,     suffix=suffix, ) <pre>INFO:root:Sorted dictionary has 17483 keys.\n</pre> In\u00a0[19]: Copied! <pre>result_test_sequences = [\n    result_dir_name + \"/\" + test_sequence for test_sequence in test_sequences\n]\ncumulate_scores(sequence_names=result_test_sequences)\n</pre> result_test_sequences = [     result_dir_name + \"/\" + test_sequence for test_sequence in test_sequences ] cumulate_scores(sequence_names=result_test_sequences) <pre>AOGM | MBC | division_f1 | fp_divs | fn_divs | tp_divs | ws_edges | fp_edges | fn_edges | TRA\n178.583 | 0.730 | 0.809 | 25.333 | 26.667 | 198.167 | 47.333 | 51.500 | 53.167 | 0.992\n</pre>"},{"location":"examples/Bacteria/03-attrackt-unsupervised/#03-train-trackastra-model-with-attrackt-unsupervised-loss","title":"03 - Train trackastra model with attrackt unsupervised loss.\u00b6","text":"<p>This notebook uses the zarr container (created in the first notebook) and the embeddings (exported to a csv in the second notebook) to train a trackastra model with the attrackt unsupervised loss.</p>"},{"location":"examples/Bacteria/03-attrackt-unsupervised/#create-train-and-val-datasets","title":"Create train and val datasets.\u00b6","text":""},{"location":"examples/Bacteria/03-attrackt-unsupervised/#create-model","title":"Create model\u00b6","text":""},{"location":"examples/Bacteria/03-attrackt-unsupervised/#train-model","title":"Train model\u00b6","text":""},{"location":"examples/Bacteria/03-attrackt-unsupervised/#infer-using-the-trained-model","title":"Infer using the trained model\u00b6","text":""},{"location":"examples/Bacteria/03-attrackt-unsupervised/#compute-tracking-performance-using-dposition-and-predicted-associations-as-edge-costs","title":"Compute Tracking Performance using d(position) and predicted associations as edge costs.\u00b6","text":"<p>Please ensure <code>gurobi</code> is installed for a faster solving experience.</p>"},{"location":"examples/Bacteria/03-attrackt-unsupervised/#sort-the-nodes-using-an-uncertainty-measure","title":"Sort the nodes using an uncertainty measure.\u00b6","text":""},{"location":"examples/Bacteria/03-attrackt-unsupervised/#cumulate-scores","title":"Cumulate scores\u00b6","text":""},{"location":"examples/Bacteria/04-finetuning/","title":"04 - Fine-tune trackastra model with supervision on nodes.","text":"In\u00a0[1]: Copied! <pre>from attrackt.trackastra.data import CTCZarrData\nimport torch\nfrom torch.utils.data import ConcatDataset\nfrom attrackt.trackastra.model import TrackingTransformer\nfrom functools import partial\nfrom attrackt.scripts.trackastra.train_finetuned import train\nfrom attrackt.scripts.identify_valid_sequences import identify_valid_sequences\nfrom attrackt.scripts.motile import motile_infer\nfrom attrackt.scripts.cumulate_scores import cumulate_scores\nfrom attrackt.scripts.trackastra.infer_finetuned import infer\n</pre> from attrackt.trackastra.data import CTCZarrData import torch from torch.utils.data import ConcatDataset from attrackt.trackastra.model import TrackingTransformer from functools import partial from attrackt.scripts.trackastra.train_finetuned import train from attrackt.scripts.identify_valid_sequences import identify_valid_sequences from attrackt.scripts.motile import motile_infer from attrackt.scripts.cumulate_scores import cumulate_scores from attrackt.scripts.trackastra.infer_finetuned import infer <pre>/Users/lalitm/miniforge3/envs/attrackt/lib/python3.10/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n  from .autonotebook import tqdm as notebook_tqdm\n</pre> In\u00a0[2]: Copied! <pre>suffix = \"Bacteria-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed.\ndata_dir = \"./data/Bacteria/\"\ndetections_csv = data_dir + \"/detections.csv\"\nembeddings_csv = f\"embeddings-{suffix}.csv\"\n</pre> suffix = \"Bacteria-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed. data_dir = \"./data/Bacteria/\" detections_csv = data_dir + \"/detections.csv\" embeddings_csv = f\"embeddings-{suffix}.csv\" In\u00a0[3]: Copied! <pre>sequences = [\n    \"150309-04\",\n    \"150310-11\",\n    \"151029_E1-1\",\n    \"151029_E1-5\",\n    \"151101_E3-12\",\n    \"160112-06\",\n]\n</pre> sequences = [     \"150309-04\",     \"150310-11\",     \"151029_E1-1\",     \"151029_E1-5\",     \"151101_E3-12\",     \"160112-06\", ] In\u00a0[4]: Copied! <pre>crop_size = (256, 256)\nzarr_path = data_dir + \"/Bacteria.zarr\"\n</pre> crop_size = (256, 256) zarr_path = data_dir + \"/Bacteria.zarr\" In\u00a0[5]: Copied! <pre>ndim = 2\nwindow = 6\nmax_tokens = 2048\naugment = 2\nzarr_img_key = \"img\"\nzarr_mask_key = \"mask\"\nzarr_img_channel = 0\nzarr_mask_channel = 0\nn_jobs = 8\n</pre> ndim = 2 window = 6 max_tokens = 2048 augment = 2 zarr_img_key = \"img\" zarr_mask_key = \"mask\" zarr_img_channel = 0 zarr_mask_channel = 0 n_jobs = 8 In\u00a0[6]: Copied! <pre>ds_factory = partial(\n    CTCZarrData,\n    ndim=ndim,\n    window_size=window,\n    max_tokens=max_tokens,\n    augment=augment,\n    crop_size=crop_size,\n    zarr_path=zarr_path,\n    zarr_img_key=zarr_img_key,\n    zarr_mask_key=zarr_mask_key,\n    zarr_img_channel=zarr_img_channel,\n    zarr_mask_channel=zarr_mask_channel,\n    embeddings_csv=embeddings_csv,\n    n_jobs=n_jobs,\n)\n</pre> ds_factory = partial(     CTCZarrData,     ndim=ndim,     window_size=window,     max_tokens=max_tokens,     augment=augment,     crop_size=crop_size,     zarr_path=zarr_path,     zarr_img_key=zarr_img_key,     zarr_mask_key=zarr_mask_key,     zarr_img_channel=zarr_img_channel,     zarr_mask_channel=zarr_mask_channel,     embeddings_csv=embeddings_csv,     n_jobs=n_jobs, ) In\u00a0[7]: Copied! <pre>train_unsupervised_datasets = [ds_factory(zarr_sequence=seq) for seq in sequences]\n</pre> train_unsupervised_datasets = [ds_factory(zarr_sequence=seq) for seq in sequences] <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150309-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  13%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                             | 12/92 [00:00&lt;00:00, 109.71it/s]</pre> <pre>\rNormalizing:  27%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                                | 25/92 [00:00&lt;00:00, 118.61it/s]</pre> <pre>\rNormalizing:  41%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                    | 38/92 [00:00&lt;00:00, 118.75it/s]</pre> <pre>\rNormalizing:  54%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                        | 50/92 [00:00&lt;00:00, 114.28it/s]</pre> <pre>\rNormalizing:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                            | 63/92 [00:00&lt;00:00, 116.10it/s]</pre> <pre>\rNormalizing:  83%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c               | 76/92 [00:00&lt;00:00, 118.32it/s]</pre> <pre>\rNormalizing:  99%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588 | 91/92 [00:00&lt;00:00, 126.88it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 33349 objects in 87 windows (6.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150310-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                           | 15/29 [00:00&lt;00:00, 148.72it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2300 objects in 24 windows (0.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-1, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  26%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                 | 14/53 [00:00&lt;00:00, 131.99it/s]</pre> <pre>\rNormalizing:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                          | 28/53 [00:00&lt;00:00, 128.00it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 42/53 [00:00&lt;00:00, 130.45it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\r</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 16592 objects in 48 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-5, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                       | 20/53 [00:00&lt;00:00, 192.77it/s]</pre> <pre>\rNormalizing:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                     | 40/53 [00:00&lt;00:00, 189.16it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 13576 objects in 48 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E3-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  22%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                     | 12/55 [00:00&lt;00:00, 108.70it/s]</pre> <pre>\rNormalizing:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                  | 24/55 [00:00&lt;00:00, 114.47it/s]</pre> <pre>\rNormalizing:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                              | 36/55 [00:00&lt;00:00, 115.93it/s]</pre> <pre>\rNormalizing:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e         | 49/55 [00:00&lt;00:00, 119.82it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 11832 objects in 50 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=160112-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-Bacteria-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                             | 27/55 [00:00&lt;00:00, 264.79it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7866 objects in 50 windows (1.1s)\n</pre> In\u00a0[8]: Copied! <pre># ## Create train and val supervised_datasets\nk = 100  # Number of supervised nodes! Choose one of {10, 100, 1000, 10000, 100000}\nsupervised_csv = f\"confidence-{suffix}/{k}/top/edges_sorted.csv\"\n</pre> # ## Create train and val supervised_datasets k = 100  # Number of supervised nodes! Choose one of {10, 100, 1000, 10000, 100000} supervised_csv = f\"confidence-{suffix}/{k}/top/edges_sorted.csv\" <p>identify valid sequences as those that have representation in the supervised_csv file</p> In\u00a0[9]: Copied! <pre>valid_sequences = identify_valid_sequences(sequences, supervised_csv)\n</pre> valid_sequences = identify_valid_sequences(sequences, supervised_csv) In\u00a0[10]: Copied! <pre>ds_factory = partial(\n    CTCZarrData,\n    ndim=ndim,\n    window_size=window,\n    max_tokens=max_tokens,\n    augment=augment,\n    crop_size=crop_size,\n    zarr_path=zarr_path,\n    zarr_img_key=zarr_img_key,\n    zarr_mask_key=zarr_mask_key,\n    zarr_img_channel=zarr_img_channel,\n    zarr_mask_channel=zarr_mask_channel,\n    supervised_csv=supervised_csv,\n    n_jobs=n_jobs,\n)\n</pre> ds_factory = partial(     CTCZarrData,     ndim=ndim,     window_size=window,     max_tokens=max_tokens,     augment=augment,     crop_size=crop_size,     zarr_path=zarr_path,     zarr_img_key=zarr_img_key,     zarr_mask_key=zarr_mask_key,     zarr_img_channel=zarr_img_channel,     zarr_mask_channel=zarr_mask_channel,     supervised_csv=supervised_csv,     n_jobs=n_jobs, ) In\u00a0[11]: Copied! <pre>train_supervised_datasets = [ds_factory(zarr_sequence=seq) for seq in valid_sequences]\nval_supervised_datasets = [\n    ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in valid_sequences\n]\n</pre> train_supervised_datasets = [ds_factory(zarr_sequence=seq) for seq in valid_sequences] val_supervised_datasets = [     ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in valid_sequences ] <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150309-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 39 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  13%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                             | 12/92 [00:00&lt;00:00, 108.46it/s]</pre> <pre>\rNormalizing:  27%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                                | 25/92 [00:00&lt;00:00, 117.75it/s]</pre> <pre>\rNormalizing:  40%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                     | 37/92 [00:00&lt;00:00, 117.36it/s]</pre> <pre>\rNormalizing:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                         | 49/92 [00:00&lt;00:00, 111.77it/s]</pre> <pre>\rNormalizing:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                              | 61/92 [00:00&lt;00:00, 114.51it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 73/92 [00:00&lt;00:00, 114.53it/s]</pre> <pre>\rNormalizing:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f    | 87/92 [00:00&lt;00:00, 121.13it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 33349 objects in 87 windows (2.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150310-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 5 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                           | 15/29 [00:00&lt;00:00, 148.51it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2300 objects in 24 windows (0.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-1, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 12 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  26%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                 | 14/53 [00:00&lt;00:00, 134.02it/s]</pre> <pre>\rNormalizing:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                          | 28/53 [00:00&lt;00:00, 129.90it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 42/53 [00:00&lt;00:00, 132.39it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\r</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 16592 objects in 48 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-5, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 20 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                       | 20/53 [00:00&lt;00:00, 194.31it/s]</pre> <pre>\rNormalizing:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                     | 40/53 [00:00&lt;00:00, 192.89it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 13576 objects in 48 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E3-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 15 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  22%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                     | 12/55 [00:00&lt;00:00, 109.66it/s]</pre> <pre>\rNormalizing:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                  | 24/55 [00:00&lt;00:00, 114.79it/s]</pre> <pre>\rNormalizing:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                              | 36/55 [00:00&lt;00:00, 116.97it/s]</pre> <pre>\rNormalizing:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e         | 49/55 [00:00&lt;00:00, 120.24it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 11832 objects in 50 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=160112-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 9 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                             | 27/55 [00:00&lt;00:00, 267.28it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7866 objects in 50 windows (1.1s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150309-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 39 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  12%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                                              | 11/92 [00:00&lt;00:00, 109.43it/s]</pre> <pre>\rNormalizing:  25%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                  | 23/92 [00:00&lt;00:00, 115.07it/s]</pre> <pre>\rNormalizing:  39%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                      | 36/92 [00:00&lt;00:00, 119.07it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                          | 48/92 [00:00&lt;00:00, 112.29it/s]</pre> <pre>\rNormalizing:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                              | 61/92 [00:00&lt;00:00, 114.64it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 73/92 [00:00&lt;00:00, 114.82it/s]</pre> <pre>\rNormalizing:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f    | 87/92 [00:00&lt;00:00, 121.38it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 33349 objects in 87 windows (2.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150310-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 5 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  55%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                        | 16/29 [00:00&lt;00:00, 151.55it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2300 objects in 24 windows (0.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-1, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 12 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  26%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                 | 14/53 [00:00&lt;00:00, 132.97it/s]</pre> <pre>\rNormalizing:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                          | 28/53 [00:00&lt;00:00, 130.57it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 42/53 [00:00&lt;00:00, 132.06it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\r</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 16592 objects in 48 windows (1.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-5, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 20 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                       | 20/53 [00:00&lt;00:00, 194.03it/s]</pre> <pre>\rNormalizing:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                     | 40/53 [00:00&lt;00:00, 192.08it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 13576 objects in 48 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E3-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 15 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  20%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                                       | 11/55 [00:00&lt;00:00, 109.73it/s]</pre> <pre>\rNormalizing:  42%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                                   | 23/55 [00:00&lt;00:00, 112.78it/s]</pre> <pre>\rNormalizing:  64%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                | 35/55 [00:00&lt;00:00, 114.61it/s]</pre> <pre>\rNormalizing:  87%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b           | 48/55 [00:00&lt;00:00, 119.03it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 11832 objects in 50 windows (1.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=160112-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 9 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  49%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                             | 27/55 [00:00&lt;00:00, 266.80it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7866 objects in 50 windows (1.0s)\n</pre> In\u00a0[12]: Copied! <pre># ## Create train and val pseudo-supervised datasets\npseudo_supervised_csv = f\"confidence-{suffix}/{k}/bottom/edges_sorted.csv\"\n</pre> # ## Create train and val pseudo-supervised datasets pseudo_supervised_csv = f\"confidence-{suffix}/{k}/bottom/edges_sorted.csv\" In\u00a0[13]: Copied! <pre>valid_sequences = identify_valid_sequences(sequences, pseudo_supervised_csv)\nds_factory = partial(\n    CTCZarrData,\n    ndim=ndim,\n    window_size=window,\n    max_tokens=max_tokens,\n    augment=augment,\n    crop_size=crop_size,\n    zarr_path=zarr_path,\n    zarr_img_key=zarr_img_key,\n    zarr_mask_key=zarr_mask_key,\n    zarr_img_channel=zarr_img_channel,\n    zarr_mask_channel=zarr_mask_channel,\n    supervised_csv=pseudo_supervised_csv,\n    n_jobs=n_jobs,\n)\n</pre> valid_sequences = identify_valid_sequences(sequences, pseudo_supervised_csv) ds_factory = partial(     CTCZarrData,     ndim=ndim,     window_size=window,     max_tokens=max_tokens,     augment=augment,     crop_size=crop_size,     zarr_path=zarr_path,     zarr_img_key=zarr_img_key,     zarr_mask_key=zarr_mask_key,     zarr_img_channel=zarr_img_channel,     zarr_mask_channel=zarr_mask_channel,     supervised_csv=pseudo_supervised_csv,     n_jobs=n_jobs, ) In\u00a0[14]: Copied! <pre>train_pseudo_supervised_datasets = [\n    ds_factory(zarr_sequence=seq) for seq in valid_sequences\n]\nval_pseudo_supervised_datasets = [\n    ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in valid_sequences\n]\n</pre> train_pseudo_supervised_datasets = [     ds_factory(zarr_sequence=seq) for seq in valid_sequences ] val_pseudo_supervised_datasets = [     ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in valid_sequences ] <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150309-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 159 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  12%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                                              | 11/92 [00:00&lt;00:00, 109.55it/s]</pre> <pre>\rNormalizing:  25%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                  | 23/92 [00:00&lt;00:00, 114.35it/s]</pre> <pre>\rNormalizing:  39%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                      | 36/92 [00:00&lt;00:00, 117.89it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                          | 48/92 [00:00&lt;00:00, 111.42it/s]</pre> <pre>\rNormalizing:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                              | 61/92 [00:00&lt;00:00, 114.04it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 73/92 [00:00&lt;00:00, 114.18it/s]</pre> <pre>\rNormalizing:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f    | 87/92 [00:00&lt;00:00, 120.66it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 33349 objects in 87 windows (2.5s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150310-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 4 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                           | 15/29 [00:00&lt;00:00, 149.66it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2300 objects in 24 windows (0.9s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-1, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 47 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  26%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                 | 14/53 [00:00&lt;00:00, 131.72it/s]</pre> <pre>\rNormalizing:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                          | 28/53 [00:00&lt;00:00, 127.36it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 42/53 [00:00&lt;00:00, 131.12it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\r</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 16592 objects in 48 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-5, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 38 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                       | 20/53 [00:00&lt;00:00, 194.82it/s]</pre> <pre>\rNormalizing:  75%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                     | 40/53 [00:00&lt;00:00, 191.61it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 13576 objects in 48 windows (1.3s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E3-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 31 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  22%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                     | 12/55 [00:00&lt;00:00, 108.70it/s]</pre> <pre>\rNormalizing:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                  | 24/55 [00:00&lt;00:00, 113.98it/s]</pre> <pre>\rNormalizing:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                              | 36/55 [00:00&lt;00:00, 114.82it/s]</pre> <pre>\rNormalizing:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e         | 49/55 [00:00&lt;00:00, 118.93it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 11832 objects in 50 windows (1.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=160112-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 37 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                           | 28/55 [00:00&lt;00:00, 273.42it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7866 objects in 50 windows (1.1s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150309-04, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 159 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  12%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                                              | 11/92 [00:00&lt;00:00, 109.74it/s]</pre> <pre>\rNormalizing:  25%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                                                  | 23/92 [00:00&lt;00:00, 115.45it/s]</pre> <pre>\rNormalizing:  39%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                      | 36/92 [00:00&lt;00:00, 119.07it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                          | 48/92 [00:00&lt;00:00, 112.16it/s]</pre> <pre>\rNormalizing:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                              | 61/92 [00:00&lt;00:00, 114.94it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 73/92 [00:00&lt;00:00, 115.37it/s]</pre> <pre>\rNormalizing:  95%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f    | 87/92 [00:00&lt;00:00, 121.84it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 33349 objects in 87 windows (2.6s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=150310-11, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 4 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  52%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                           | 15/29 [00:00&lt;00:00, 149.88it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/24 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 2300 objects in 24 windows (0.9s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-1, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 47 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  26%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                                                                 | 14/53 [00:00&lt;00:00, 130.83it/s]</pre> <pre>\rNormalizing:  53%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                                          | 28/53 [00:00&lt;00:00, 128.66it/s]</pre> <pre>\rNormalizing:  79%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                  | 42/53 [00:00&lt;00:00, 132.12it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\r</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 16592 objects in 48 windows (1.7s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151029_E1-5, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 38 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  36%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                                                         | 19/53 [00:00&lt;00:00, 189.94it/s]</pre> <pre>\rNormalizing:  72%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                         | 38/53 [00:00&lt;00:00, 189.76it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/48 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 13576 objects in 48 windows (1.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=151101_E3-12, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 31 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  22%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                     | 12/55 [00:00&lt;00:00, 109.11it/s]</pre> <pre>\rNormalizing:  44%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                  | 24/55 [00:00&lt;00:00, 113.98it/s]</pre> <pre>\rNormalizing:  65%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                              | 36/55 [00:00&lt;00:00, 115.22it/s]</pre> <pre>\rNormalizing:  89%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e         | 49/55 [00:00&lt;00:00, 119.37it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 11832 objects in 50 windows (1.8s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/Bacteria/Bacteria.zarr (seq=160112-06, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-Bacteria-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 37 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  51%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                                           | 28/55 [00:00&lt;00:00, 270.79it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/50 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 7866 objects in 50 windows (1.1s)\n</pre> In\u00a0[15]: Copied! <pre>datasets = {\n    \"train_unsupervised\": ConcatDataset(train_unsupervised_datasets),\n    \"train_supervised\": ConcatDataset(train_supervised_datasets),\n    \"val_supervised\": ConcatDataset(val_supervised_datasets),\n    \"train_pseudo_supervised\": ConcatDataset(train_pseudo_supervised_datasets),\n    \"val_pseudo_supervised\": ConcatDataset(val_pseudo_supervised_datasets),\n}\n</pre> datasets = {     \"train_unsupervised\": ConcatDataset(train_unsupervised_datasets),     \"train_supervised\": ConcatDataset(train_supervised_datasets),     \"val_supervised\": ConcatDataset(val_supervised_datasets),     \"train_pseudo_supervised\": ConcatDataset(train_pseudo_supervised_datasets),     \"val_pseudo_supervised\": ConcatDataset(val_pseudo_supervised_datasets), } In\u00a0[16]: Copied! <pre>d_model = 256\nnum_encoder_layers = 6\nnum_decoder_layers = 6\nnhead = 4\npos_embed_per_dim = 32\nfeat_embed_per_dim = 8\nspatial_pos_cutoff = 256\nattn_positional_bias = \"rope\"\nattn_positional_bias_n_spatial = 16\ndropout = 0.1\ncausal_norm = \"quiet_softmax\"\n</pre> d_model = 256 num_encoder_layers = 6 num_decoder_layers = 6 nhead = 4 pos_embed_per_dim = 32 feat_embed_per_dim = 8 spatial_pos_cutoff = 256 attn_positional_bias = \"rope\" attn_positional_bias_n_spatial = 16 dropout = 0.1 causal_norm = \"quiet_softmax\" In\u00a0[17]: Copied! <pre>model = TrackingTransformer(\n    coord_dim=ndim,\n    feat_dim=datasets[\"train_unsupervised\"].datasets[0].feat_dim,\n    d_model=d_model,\n    pos_embed_per_dim=pos_embed_per_dim,\n    feat_embed_per_dim=feat_embed_per_dim,\n    num_encoder_layers=num_encoder_layers,\n    num_decoder_layers=num_decoder_layers,\n    dropout=dropout,\n    window=window,\n    spatial_pos_cutoff=spatial_pos_cutoff,\n    attn_positional_bias=attn_positional_bias,\n    attn_positional_bias_n_spatial=attn_positional_bias_n_spatial,\n    causal_norm=causal_norm,\n    nhead=nhead,\n)\n</pre> model = TrackingTransformer(     coord_dim=ndim,     feat_dim=datasets[\"train_unsupervised\"].datasets[0].feat_dim,     d_model=d_model,     pos_embed_per_dim=pos_embed_per_dim,     feat_embed_per_dim=feat_embed_per_dim,     num_encoder_layers=num_encoder_layers,     num_decoder_layers=num_decoder_layers,     dropout=dropout,     window=window,     spatial_pos_cutoff=spatial_pos_cutoff,     attn_positional_bias=attn_positional_bias,     attn_positional_bias_n_spatial=attn_positional_bias_n_spatial,     causal_norm=causal_norm,     nhead=nhead, ) In\u00a0[18]: Copied! <pre>learning_rate = 1e-4\nbatch_size = 8\nlambda_ = 0.1\nnum_iterations = 100 * k\nnum_workers = 2\nd_model = 64\nunsupervised_model_checkpoint = f\"fully-unsupervised-2025-10-11-{suffix}/models/best/best.pth\"  # Path to a saved model checkpoint. Modify accordingly.\ndo_lora = True\nlora_r = 32\nlora_alpha = 32\nlora_dropout = 0.1\n</pre> learning_rate = 1e-4 batch_size = 8 lambda_ = 0.1 num_iterations = 100 * k num_workers = 2 d_model = 64 unsupervised_model_checkpoint = f\"fully-unsupervised-2025-10-11-{suffix}/models/best/best.pth\"  # Path to a saved model checkpoint. Modify accordingly. do_lora = True lora_r = 32 lora_alpha = 32 lora_dropout = 0.1 In\u00a0[19]: Copied! <pre># train(\n#    datasets=datasets,\n#    model=model,\n#    checkpoint_path=unsupervised_model_checkpoint,\n#    batch_size=batch_size,\n#    learning_rate=learning_rate,\n#    device=\"cuda\" if torch.cuda.is_available() else \"mps\",\n#    num_iterations=num_iterations,\n#    num_workers=num_workers,\n#    causal_norm=causal_norm,\n#    lambda_=lambda_,\n#    window=window,\n#    d_model=d_model,\n#    do_lora=do_lora,\n#    lora_r=lora_r,\n#    lora_alpha=lora_alpha,\n#    lora_dropout=lora_dropout,\n#    suffix=suffix,\n# )\n</pre> # train( #    datasets=datasets, #    model=model, #    checkpoint_path=unsupervised_model_checkpoint, #    batch_size=batch_size, #    learning_rate=learning_rate, #    device=\"cuda\" if torch.cuda.is_available() else \"mps\", #    num_iterations=num_iterations, #    num_workers=num_workers, #    causal_norm=causal_norm, #    lambda_=lambda_, #    window=window, #    d_model=d_model, #    do_lora=do_lora, #    lora_r=lora_r, #    lora_alpha=lora_alpha, #    lora_dropout=lora_dropout, #    suffix=suffix, # ) In\u00a0[20]: Copied! <pre>associations_csv = f\"finetuned-associations-{k}-{suffix}.csv\"\nfinetuned_model_checkpoint_dir = f\"finetuned-2025-10-21-{suffix}/models/last/\"  # Path to finetuned model checkpoint directory. Modify accordingly.\n</pre> associations_csv = f\"finetuned-associations-{k}-{suffix}.csv\" finetuned_model_checkpoint_dir = f\"finetuned-2025-10-21-{suffix}/models/last/\"  # Path to finetuned model checkpoint directory. Modify accordingly. In\u00a0[21]: Copied! <pre># infer(\n#    unsupervised_model_checkpoint=unsupervised_model_checkpoint,\n#    transformer=model,\n#    finetuned_model_checkpoint_dir=finetuned_model_checkpoint_dir,\n#    zarr_img_channel=zarr_img_channel,\n#    zarr_img_key=zarr_img_key,\n#    zarr_mask_channel=zarr_mask_channel,\n#    zarr_mask_key=zarr_mask_key,\n#    zarr_path=zarr_path,\n#    test_zarr_sequences=sequences,\n#    output_csv_file_name=associations_csv,\n# )\n</pre> # infer( #    unsupervised_model_checkpoint=unsupervised_model_checkpoint, #    transformer=model, #    finetuned_model_checkpoint_dir=finetuned_model_checkpoint_dir, #    zarr_img_channel=zarr_img_channel, #    zarr_img_key=zarr_img_key, #    zarr_mask_channel=zarr_mask_channel, #    zarr_mask_key=zarr_mask_key, #    zarr_path=zarr_path, #    test_zarr_sequences=sequences, #    output_csv_file_name=associations_csv, # ) In\u00a0[22]: Copied! <pre>result_dir_name = f\"results-position-and-finetuned-associations-{suffix}\"\n</pre> result_dir_name = f\"results-position-and-finetuned-associations-{suffix}\" In\u00a0[23]: Copied! <pre>args = {\n    \"num_nearest_neighbours\": 10,\n    \"direction_candidate_graph\": \"backward\",\n    \"pin_nodes\": True,\n    \"use_edge_distance\": True,\n    \"edge_embedding_exists\": True,\n    \"use_different_weights_hyper\": True,\n    \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},\n    \"test_csv_file_name\": detections_csv,\n    \"edge_embedding_file_name\": associations_csv,\n    \"embedding_type\": \"affinity\",\n    \"sequence_names\": sequences,\n    \"supervised_csv\": supervised_csv,\n    \"result_dir_name\": result_dir_name,\n    \"verbose\": False,\n}\n</pre> args = {     \"num_nearest_neighbours\": 10,     \"direction_candidate_graph\": \"backward\",     \"pin_nodes\": True,     \"use_edge_distance\": True,     \"edge_embedding_exists\": True,     \"use_different_weights_hyper\": True,     \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},     \"test_csv_file_name\": detections_csv,     \"edge_embedding_file_name\": associations_csv,     \"embedding_type\": \"affinity\",     \"sequence_names\": sequences,     \"supervised_csv\": supervised_csv,     \"result_dir_name\": result_dir_name,     \"verbose\": False, } In\u00a0[24]: Copied! <pre>motile_infer(args)\n</pre> motile_infer(args) <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 150309-04\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 6387\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 92/92 [00:00&lt;00:00, 1707.02it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 63363\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 382454\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 46.66863321787835\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 21.828665413474187\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 32.74583982931663\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 16.856507768282484\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.09527402567442131\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.27524296576980856\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.0906867025735698\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.1817179194832178\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Number of keys in supervised dictionary is 39.\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 231, max in edges: 161\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 6387\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 6035\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/6386 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6386/6386 [00:00&lt;00:00, 310059.79it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 6387 out of 6387 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 6387 out of 6387 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/6387 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6387/6387 [00:00&lt;00:00, 568696.55it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/6386 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6386/6386 [00:00&lt;00:00, 963032.59it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/6386 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 6386/6386 [00:00&lt;00:00, 1012850.27it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 32.0,\n              'DET': 1.0,\n              'LNK': 0.9966593590145109,\n              'TRA': 0.999564323544228,\n              'fn_edges': 8,\n              'fn_nodes': 0,\n              'fp_edges': 8,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 12},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.9829059829059829,\n                                 'Division Precision': 0.9829059829059829,\n                                 'Division Recall': 0.9829059829059829,\n                                 'False Negative Divisions': 6,\n                                 'False Positive Divisions': 6,\n                                 'Mitotic Branching Correctness': 0.9663865546218487,\n                                 'Total GT Divisions': 351,\n                                 'Total Predicted Divisions': 351,\n                                 'True Positive Divisions': 345,\n                                 'Wrong Children Divisions': 0}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-finetuned-associations-Bacteria-v1/150309-04/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 150309-04\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 150310-11\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 550\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/29 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 29/29 [00:00&lt;00:00, 4822.95it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 5157\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 34766\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 53.21799456985325\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 25.15642099619311\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 39.28573919870244\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 20.89419060346398\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.08782833090800751\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.23199011969496966\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.07833623064672074\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.15092943042085868\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Number of keys in supervised dictionary is 5.\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 351, max in edges: 186\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 550\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 474\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                               | 0/547 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 547/547 [00:00&lt;00:00, 267898.68it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 550 out of 550 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 550 out of 550 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                             | 0/550 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 550/550 [00:00&lt;00:00, 588336.44it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                          | 0/547 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 547/547 [00:00&lt;00:00, 931878.26it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                          | 0/548 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 548/548 [00:00&lt;00:00, 1057744.40it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 76.0,\n              'DET': 1.0,\n              'LNK': 0.9075425790754258,\n              'TRA': 0.9879784878203101,\n              'fn_edges': 22,\n              'fn_nodes': 0,\n              'fp_edges': 21,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 22},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.7346938775510203,\n                                 'Division Precision': 0.7397260273972602,\n                                 'Division Recall': 0.7297297297297297,\n                                 'False Negative Divisions': 12,\n                                 'False Positive Divisions': 11,\n                                 'Mitotic Branching Correctness': 0.6352941176470588,\n                                 'Total GT Divisions': 74,\n                                 'Total Predicted Divisions': 73,\n                                 'True Positive Divisions': 54,\n                                 'Wrong Children Divisions': 8}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-finetuned-associations-Bacteria-v1/150310-11/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 150310-11\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151029_E1-1\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 3519\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 53/53 [00:00&lt;00:00, 1766.91it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 34764\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 223483\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 54.977630344171835\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 29.493654973523615\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 40.21937014949374\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 24.1673141110037\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.08391298476487447\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.22979122579047342\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.07841674125192725\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.15083509448555457\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Number of keys in supervised dictionary is 12.\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 300, max in edges: 187\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 3519\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 3160\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/3512 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3512/3512 [00:00&lt;00:00, 283342.23it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 3519 out of 3519 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 3519 out of 3519 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/3519 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3519/3519 [00:00&lt;00:00, 585913.85it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/3512 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3512/3512 [00:00&lt;00:00, 966181.01it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/3517 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 3517/3517 [00:00&lt;00:00, 1040000.51it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 323.0,\n              'DET': 1.0,\n              'LNK': 0.9387735759643636,\n              'TRA': 0.9920178917843595,\n              'fn_edges': 96,\n              'fn_nodes': 0,\n              'fp_edges': 91,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 88},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.8107344632768362,\n                                 'Division Precision': 0.8153409090909091,\n                                 'Division Recall': 0.8061797752808989,\n                                 'False Negative Divisions': 50,\n                                 'False Positive Divisions': 46,\n                                 'Mitotic Branching Correctness': 0.7139303482587065,\n                                 'Total GT Divisions': 356,\n                                 'Total Predicted Divisions': 352,\n                                 'True Positive Divisions': 287,\n                                 'Wrong Children Divisions': 19}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-finetuned-associations-Bacteria-v1/151029_E1-1/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151029_E1-1\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151029_E1-5\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 2868\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/53 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 53/53 [00:00&lt;00:00, 2156.04it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 28242\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 177199\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 50.44153575203126\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 24.798470682141513\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 36.37385187823484\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 19.90996249605498\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.08423527443375092\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.23187097666334397\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.07953848350618359\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.15315668410796873\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Number of keys in supervised dictionary is 20.\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 231, max in edges: 160\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 2868\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 2610\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/2865 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2865/2865 [00:00&lt;00:00, 251537.08it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2868 out of 2868 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2868 out of 2868 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/2868 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2868/2868 [00:00&lt;00:00, 590161.60it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/2865 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2865/2865 [00:00&lt;00:00, 948960.04it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/2866 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2866/2866 [00:00&lt;00:00, 1048393.10it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 83.0,\n              'DET': 1.0,\n              'LNK': 0.9806931844615027,\n              'TRA': 0.9974832469147032,\n              'fn_edges': 22,\n              'fn_nodes': 0,\n              'fp_edges': 21,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 29},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.9254901960784314,\n                                 'Division Precision': 0.9254901960784314,\n                                 'Division Recall': 0.9254901960784314,\n                                 'False Negative Divisions': 15,\n                                 'False Positive Divisions': 15,\n                                 'Mitotic Branching Correctness': 0.8740740740740741,\n                                 'Total GT Divisions': 255,\n                                 'Total Predicted Divisions': 255,\n                                 'True Positive Divisions': 236,\n                                 'Wrong Children Divisions': 4}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-finetuned-associations-Bacteria-v1/151029_E1-5/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151029_E1-5\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 151101_E3-12\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 2526\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 55/55 [00:00&lt;00:00, 2492.19it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 24747\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 159056\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 58.07910323942435\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 33.97910604140836\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 43.344790661411494\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 27.59030250825304\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.08692511067357547\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.23624176001315847\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.08030985631542462\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.1540769940409083\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Number of keys in supervised dictionary is 15.\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:++++++edge (('51_1663',), ('52_1994', '52_1995')) or (('51_1663',), ('52_1995', '52_1994')) not found in graph.++++++\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 300, max in edges: 176\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 2526\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 2277\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/2520 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2520/2520 [00:00&lt;00:00, 284459.08it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2526 out of 2526 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 2526 out of 2526 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/2526 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2526/2526 [00:00&lt;00:00, 580156.17it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/2520 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2520/2520 [00:00&lt;00:00, 843951.30it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/2524 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 2524/2524 [00:00&lt;00:00, 954936.25it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 143.0,\n              'DET': 1.0,\n              'LNK': 0.962229265715795,\n              'TRA': 0.9950767747710528,\n              'fn_edges': 40,\n              'fn_nodes': 0,\n              'fp_edges': 36,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 47},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.8811475409836065,\n                                 'Division Precision': 0.8847736625514403,\n                                 'Division Recall': 0.8775510204081632,\n                                 'False Negative Divisions': 26,\n                                 'False Positive Divisions': 24,\n                                 'Mitotic Branching Correctness': 0.7992565055762082,\n                                 'Total GT Divisions': 245,\n                                 'Total Predicted Divisions': 243,\n                                 'True Positive Divisions': 215,\n                                 'Wrong Children Divisions': 4}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-finetuned-associations-Bacteria-v1/151101_E3-12/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 151101_E3-12\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 160112-06\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 1633\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/55 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 55/55 [00:00&lt;00:00, 3615.61it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 15851\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 100439\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 36.420020364149636\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 19.695178950638855\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 26.820009069607462\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 15.641332439978912\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.09027255540976302\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.256781154763826\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.08229261192185694\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.16591952819738262\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Number of keys in supervised dictionary is 9.\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 276, max in edges: 161\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 1633\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 1491\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                              | 0/1632 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1632/1632 [00:00&lt;00:00, 291703.07it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 1633 out of 1633 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 1633 out of 1633 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                            | 0/1633 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1633/1633 [00:00&lt;00:00, 561371.89it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                         | 0/1632 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1632/1632 [00:00&lt;00:00, 934740.42it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                         | 0/1632 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1632/1632 [00:00&lt;00:00, 1019375.15it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 23.5,\n              'DET': 1.0,\n              'LNK': 0.9904003267973857,\n              'TRA': 0.9987485355202897,\n              'fn_edges': 7,\n              'fn_nodes': 0,\n              'fp_edges': 7,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 6},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.950354609929078,\n                                 'Division Precision': 0.950354609929078,\n                                 'Division Recall': 0.950354609929078,\n                                 'False Negative Divisions': 3,\n                                 'False Positive Divisions': 3,\n                                 'Mitotic Branching Correctness': 0.9305555555555556,\n                                 'Total GT Divisions': 141,\n                                 'Total Predicted Divisions': 141,\n                                 'True Positive Divisions': 134,\n                                 'Wrong Children Divisions': 4}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-finetuned-associations-Bacteria-v1/160112-06/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 160112-06\n</pre> In\u00a0[25]: Copied! <pre>result_sequences = [result_dir_name + \"/\" + sequence for sequence in sequences]\ncumulate_scores(sequence_names=result_sequences)\n</pre> result_sequences = [result_dir_name + \"/\" + sequence for sequence in sequences] cumulate_scores(sequence_names=result_sequences) <pre>AOGM | MBC | division_f1 | fp_divs | fn_divs | tp_divs | ws_edges | fp_edges | fn_edges | TRA\n113.417 | 0.820 | 0.881 | 17.500 | 18.667 | 211.833 | 34.000 | 30.667 | 32.500 | 0.995\n</pre>"},{"location":"examples/Bacteria/04-finetuning/#04-fine-tune-trackastra-model-with-supervision-on-k-nodes","title":"04 - Fine-tune trackastra model with supervision on <code>k</code> nodes.\u00b6","text":"<p>This notebook uses the zarr container (created in the first notebook), the embeddings (exported to a csv in the second notebook), and the model trained with unsupervised loss (in the third notebook) to fine-tune the model weights with GT supervision.</p>"},{"location":"examples/Bacteria/04-finetuning/#create-train-and-val-unsupervised-datasets","title":"Create train and val unsupervised datasets\u00b6","text":""},{"location":"examples/Bacteria/04-finetuning/#create-model","title":"Create model\u00b6","text":""},{"location":"examples/Bacteria/04-finetuning/#train-model","title":"Train model\u00b6","text":""},{"location":"examples/Bacteria/04-finetuning/#compute-tracking-performance-using-dposition-and-predicted-associations-as-edge-costs","title":"Compute Tracking Performance using d(position) and predicted associations as edge costs.\u00b6","text":"<p>Please ensure <code>gurobi</code> is installed for a faster solving experience.</p>"},{"location":"examples/Bacteria/04-finetuning/#cumulate-scores","title":"Cumulate scores\u00b6","text":""},{"location":"examples/HeLa/01-preprocessing/","title":"01 \u2013 Preprocessing Data","text":"In\u00a0[1]: Copied! <pre>from attrackt.scripts import extract_data, correct_gt_with_st, create_zarr, create_csv\nfrom attrackt.scripts.motile import motile_infer\nfrom attrackt.scripts.cumulate_scores import cumulate_scores\n</pre> from attrackt.scripts import extract_data, correct_gt_with_st, create_zarr, create_csv from attrackt.scripts.motile import motile_infer from attrackt.scripts.cumulate_scores import cumulate_scores In\u00a0[2]: Copied! <pre>suffix = \"HeLa-v1\"  # just a string placeholder to identify the results, in case running multiple experiments. You can modify as needed.\ndata_dir = \"./data/HeLa/\"\nzip_url = \"https://drive.google.com/uc?id=1Z-dGmuXVO7I-QeCN7dWksxFJrjM6vfwM\"\n</pre> suffix = \"HeLa-v1\"  # just a string placeholder to identify the results, in case running multiple experiments. You can modify as needed. data_dir = \"./data/HeLa/\" zip_url = \"https://drive.google.com/uc?id=1Z-dGmuXVO7I-QeCN7dWksxFJrjM6vfwM\" In\u00a0[3]: Copied! <pre>extract_data(\n    zip_url=zip_url,\n    data_dir=data_dir,\n)\n</pre> extract_data(     zip_url=zip_url,     data_dir=data_dir, ) <pre>INFO:root:Directory already exists at data/HeLa\n</pre> In\u00a0[4]: Copied! <pre>correct_gt_with_st(\n    silver_truth_dir_name=data_dir + \"/HeLa/01_ST/SEG/\",\n    gold_truth_dir_name=data_dir + \"/HeLa/01_GT/TRA/\",\n    combined_truth_dir_name=data_dir + \"/HeLa/01_GT/TRA/\",\n)\n</pre> correct_gt_with_st(     silver_truth_dir_name=data_dir + \"/HeLa/01_ST/SEG/\",     gold_truth_dir_name=data_dir + \"/HeLa/01_GT/TRA/\",     combined_truth_dir_name=data_dir + \"/HeLa/01_GT/TRA/\", ) <pre>INFO:root:Corrected gold truth segmentations using silver truth segmentations.\n</pre> In\u00a0[5]: Copied! <pre>correct_gt_with_st(\n    silver_truth_dir_name=data_dir + \"/HeLa/02_ST/SEG/\",\n    gold_truth_dir_name=data_dir + \"/HeLa/02_GT/TRA/\",\n    combined_truth_dir_name=data_dir + \"/HeLa/02_GT/TRA/\",\n)\n</pre> correct_gt_with_st(     silver_truth_dir_name=data_dir + \"/HeLa/02_ST/SEG/\",     gold_truth_dir_name=data_dir + \"/HeLa/02_GT/TRA/\",     combined_truth_dir_name=data_dir + \"/HeLa/02_GT/TRA/\", ) <pre>INFO:root:Corrected gold truth segmentations using silver truth segmentations.\n</pre> In\u00a0[6]: Copied! <pre>detections_csv_file_name = data_dir + \"/detections.csv\"\nsequence_names = [\n    \"01\",\n    \"02\",\n]\ntest_sequence_names = [\n    \"02\",\n]\nmask_dir_names = [\n    data_dir + \"/HeLa/01_GT/TRA\",\n    data_dir + \"/HeLa/02_GT/TRA\",\n]\nman_track_file_names = [\n    data_dir + \"/HeLa/01_GT/TRA/man_track.txt\",\n    data_dir + \"/HeLa/02_GT/TRA/man_track.txt\",\n]\nimg_dir_names = [\n    data_dir + \"/HeLa/01/\",\n    data_dir + \"/HeLa/02/\",\n]\n</pre> detections_csv_file_name = data_dir + \"/detections.csv\" sequence_names = [     \"01\",     \"02\", ] test_sequence_names = [     \"02\", ] mask_dir_names = [     data_dir + \"/HeLa/01_GT/TRA\",     data_dir + \"/HeLa/02_GT/TRA\", ] man_track_file_names = [     data_dir + \"/HeLa/01_GT/TRA/man_track.txt\",     data_dir + \"/HeLa/02_GT/TRA/man_track.txt\", ] img_dir_names = [     data_dir + \"/HeLa/01/\",     data_dir + \"/HeLa/02/\", ] In\u00a0[7]: Copied! <pre>create_csv(\n    mask_dir_names=mask_dir_names,\n    sequence_names=sequence_names,\n    man_track_file_names=man_track_file_names,\n    output_csv_file_name=detections_csv_file_name,\n)\n</pre> create_csv(     mask_dir_names=mask_dir_names,     sequence_names=sequence_names,     man_track_file_names=man_track_file_names,     output_csv_file_name=detections_csv_file_name, ) <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/HeLa//HeLa/01_GT/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Loaded manual track file: ./data/HeLa//HeLa/02_GT/TRA/man_track.txt\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing detections...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Processing manual track TXT...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Generating CSV output...\n</pre> <pre>INFO:attrackt.scripts.create_csv:Saving output CSVs to: ./data/HeLa//detections.csv\n</pre> <pre>INFO:attrackt.scripts.create_csv:CSV creation complete.\n</pre> In\u00a0[8]: Copied! <pre>container_path = data_dir + \"/HeLa.zarr\"\n</pre> container_path = data_dir + \"/HeLa.zarr\" In\u00a0[9]: Copied! <pre>create_zarr(\n    container_path=container_path,\n    img_dir_names=img_dir_names,\n    mask_dir_names=mask_dir_names,\n    sequence_names=sequence_names,\n    mapping_csv_file_name=detections_csv_file_name,\n)\n</pre> create_zarr(     container_path=container_path,     img_dir_names=img_dir_names,     mask_dir_names=mask_dir_names,     sequence_names=sequence_names,     mapping_csv_file_name=detections_csv_file_name, ) <pre>INFO:attrackt.scripts.create_zarr:Sequence '01': using 8639 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '01': relabeled masks written. Unique labels: 266 -&gt; 8640\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '02': using 25420 mapping rows.\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Sequence '02': relabeled masks written. Unique labels: 675 -&gt; 25421\n</pre> <pre>INFO:attrackt.scripts.create_zarr:Created/updated container at ./data/HeLa//HeLa.zarr.\n</pre> In\u00a0[10]: Copied! <pre>result_dir_name = f\"results-position-only-{suffix}\"\nargs = {\n    \"num_nearest_neighbours\": 10,\n    \"direction_candidate_graph\": \"backward\",\n    \"pin_nodes\": True,\n    \"use_edge_distance\": True,\n    \"edge_embedding_exists\": False,\n    \"use_different_weights_hyper\": True,\n    \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},\n    \"test_csv_file_name\": detections_csv_file_name,\n    \"sequence_names\": test_sequence_names,\n    \"result_dir_name\": result_dir_name,\n    \"verbose\": False,\n}\n</pre> result_dir_name = f\"results-position-only-{suffix}\" args = {     \"num_nearest_neighbours\": 10,     \"direction_candidate_graph\": \"backward\",     \"pin_nodes\": True,     \"use_edge_distance\": True,     \"edge_embedding_exists\": False,     \"use_different_weights_hyper\": True,     \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},     \"test_csv_file_name\": detections_csv_file_name,     \"sequence_names\": test_sequence_names,     \"result_dir_name\": result_dir_name,     \"verbose\": False, } In\u00a0[11]: Copied! <pre>motile_infer(args)\n</pre> motile_infer(args) <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 02\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 25420\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\r 38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                               | 35/92 [00:00&lt;00:00, 342.86it/s]</pre> <pre>\r 76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                        | 70/92 [00:00&lt;00:00, 317.27it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 92/92 [00:00&lt;00:00, 371.71it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 252950\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 1463909\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 58.90307159221014\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 31.392316177621304\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 41.304285782009245\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 22.929073291146057\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 190, max in edges: 141\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 24978\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                             | 0/25271 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25271/25271 [00:00&lt;00:00, 320271.75it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 25420 out of 25420 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 25420 out of 25420 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                           | 0/25420 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25420/25420 [00:00&lt;00:00, 559076.31it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                        | 0/25271 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25271/25271 [00:00&lt;00:00, 920256.79it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                        | 0/25168 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25168/25168 [00:00&lt;00:00, 978116.48it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 352.5,\n              'DET': 1.0,\n              'LNK': 0.9906627463445645,\n              'TRA': 0.9987926097440675,\n              'fn_edges': 65,\n              'fn_nodes': 0,\n              'fp_edges': 168,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 87},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.7808764940239044,\n                                 'Division Precision': 0.6689419795221843,\n                                 'Division Recall': 0.937799043062201,\n                                 'False Negative Divisions': 10,\n                                 'False Positive Divisions': 94,\n                                 'Mitotic Branching Correctness': 0.6468646864686468,\n                                 'Total GT Divisions': 209,\n                                 'Total Predicted Divisions': 293,\n                                 'True Positive Divisions': 196,\n                                 'Wrong Children Divisions': 3}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-only-HeLa-v1/02/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 02\n</pre> In\u00a0[12]: Copied! <pre>result_test_sequences = [\n    result_dir_name + \"/\" + test_sequence_name\n    for test_sequence_name in test_sequence_names\n]\n</pre> result_test_sequences = [     result_dir_name + \"/\" + test_sequence_name     for test_sequence_name in test_sequence_names ] In\u00a0[13]: Copied! <pre>cumulate_scores(sequence_names=result_test_sequences)\n</pre> cumulate_scores(sequence_names=result_test_sequences) <pre>AOGM | MBC | division_f1 | fp_divs | fn_divs | tp_divs | ws_edges | fp_edges | fn_edges | TRA\n352.500 | 0.647 | 0.781 | 94.000 | 10.000 | 196.000 | 87.000 | 168.000 | 65.000 | 0.999\n</pre>"},{"location":"examples/HeLa/01-preprocessing/#01-preprocessing-data","title":"01 \u2013 Preprocessing Data\u00b6","text":"<p>This notebook performs the following steps:</p> <ol> <li>Download data</li> <li>(Optional) Combine instance segmentation masks from silver and gold ground truth</li> <li>Convert image and label data to Zarr format</li> <li>Save detections into a CSV file</li> <li>Compute tracking accuracy metrics with only d(position) as edge cost</li> </ol>"},{"location":"examples/HeLa/01-preprocessing/#download-data","title":"Download Data\u00b6","text":"<p>The raw <code>.tif</code> images are first downloaded to the directory specified by <code>data_dir</code>.</p>"},{"location":"examples/HeLa/01-preprocessing/#optional-merge-silver-and-gold-segmentation-masks","title":"(Optional) Merge Silver and Gold Segmentation Masks\u00b6","text":"<p>In this optional step, we combine the segmentation masks from the silver and gold ground truth datasets.</p> <p>You can skip this step if:</p> <ul> <li>Your masks are already dense and gold-standard, or</li> <li>You do not have silver ground truth data available.</li> </ul> <p>Note: This step will overwrite the contents of <code>01_GT/TRA</code> and <code>02_GT/TRA</code> with the newly merged masks.</p>"},{"location":"examples/HeLa/01-preprocessing/#export-detection-data-to-csv","title":"Export Detection Data to CSV\u00b6","text":"<p>Next, we generate a single CSV file containing the locations of all detected instances. Each detection is assigned a unique ID.</p> <p>The CSV includes the following columns: <code>sequence</code>, <code>id</code>, <code>t</code>, <code>[z]</code>, <code>y</code>, <code>x</code>, <code>parent_id</code>, <code>original_id</code></p> <p>Note: The <code>man_track_file_names</code> input is optional. It is used here solely for evaluation purposes (e.g., assigning the values in the parent_id column), and is not required for model training or for solving the ILP.</p>"},{"location":"examples/HeLa/01-preprocessing/#convert-data-to-zarr-format","title":"Convert Data to Zarr Format\u00b6","text":"<p>Then, we convert the data into a single Zarr file. This file contains one group for each sequence in the dataset.</p> <p>Within each sequence group, you'll find two datasets:</p> <ul> <li><code>img</code> \u2013 the raw image data</li> <li><code>mask</code> \u2013 the corresponding instance segmentation masks All the masks will be relabeled to ensure unique instance IDs across the entire dataset.</li> </ul>"},{"location":"examples/HeLa/01-preprocessing/#compute-tracking-performance-using-only-dposition-as-edge-cost","title":"Compute Tracking Performance using only d(position) as edge cost\u00b6","text":"<p>Finally, to understand how well we perform using only position as a feature, we compute the tracking performance using only d(position) as edge cost. Please ensure <code>gurobi</code> is installed for a faster solving experience.</p>"},{"location":"examples/HeLa/01-preprocessing/#cumulate-scores","title":"Cumulate scores\u00b6","text":""},{"location":"examples/HeLa/02-autoencoder/","title":"02 - Train auto-encoder model.","text":"In\u00a0[1]: Copied! <pre>import torch\nimport csv\nfrom attrackt.autoencoder import (\n    ZarrCsvDatasetAutoencoder,\n    AutoencoderModel,\n    AutoencoderModel3d,\n)\nfrom attrackt.scripts.autoencoder.train_autoencoder import train_autoencoder\nfrom attrackt.scripts.autoencoder.infer_autoencoder import infer_autoencoder\nfrom attrackt.scripts.motile import motile_infer\nfrom attrackt.scripts.cumulate_scores import cumulate_scores\n</pre> import torch import csv from attrackt.autoencoder import (     ZarrCsvDatasetAutoencoder,     AutoencoderModel,     AutoencoderModel3d, ) from attrackt.scripts.autoencoder.train_autoencoder import train_autoencoder from attrackt.scripts.autoencoder.infer_autoencoder import infer_autoencoder from attrackt.scripts.motile import motile_infer from attrackt.scripts.cumulate_scores import cumulate_scores In\u00a0[2]: Copied! <pre>suffix = \"HeLa-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed.\ndata_dir = \"./data/HeLa/\"\ncontainer_path = data_dir + \"/HeLa.zarr\"\ndetections_csv_file_name = data_dir + \"/detections.csv\"\ncrop_size = [64, 64]\nnum_spatial_dims = 2\n</pre> suffix = \"HeLa-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed. data_dir = \"./data/HeLa/\" container_path = data_dir + \"/HeLa.zarr\" detections_csv_file_name = data_dir + \"/detections.csv\" crop_size = [64, 64] num_spatial_dims = 2 In\u00a0[3]: Copied! <pre>train_dataset = ZarrCsvDatasetAutoencoder(\n    zarr_container_name=container_path,\n    detections_csv_file_name=detections_csv_file_name,\n    num_spatial_dims=num_spatial_dims,\n    crop_size=crop_size,\n    length=None,\n)\n</pre> train_dataset = ZarrCsvDatasetAutoencoder(     zarr_container_name=container_path,     detections_csv_file_name=detections_csv_file_name,     num_spatial_dims=num_spatial_dims,     crop_size=crop_size,     length=None, ) <pre>INFO:attrackt.autoencoder.zarr_csv_dataset_autoencoder:Loaded detections file ./data/HeLa//detections.csv.\n</pre> In\u00a0[4]: Copied! <pre>val_dataset = ZarrCsvDatasetAutoencoder(\n    zarr_container_name=container_path,\n    detections_csv_file_name=detections_csv_file_name,\n    num_spatial_dims=num_spatial_dims,\n    crop_size=crop_size,\n    length=100,\n    shuffle=True,\n)\n</pre> val_dataset = ZarrCsvDatasetAutoencoder(     zarr_container_name=container_path,     detections_csv_file_name=detections_csv_file_name,     num_spatial_dims=num_spatial_dims,     crop_size=crop_size,     length=100,     shuffle=True, ) <pre>INFO:attrackt.autoencoder.zarr_csv_dataset_autoencoder:Loaded detections file ./data/HeLa//detections.csv.\n</pre> In\u00a0[5]: Copied! <pre>num_in_out_channels = 1  # Number of input and output channels, e.g. 1 for gray-scale images, 3 for RGB images.\nnum_intermediate_channels = 32\nnum_z_channels = 4\nattention_resolutions = [16]  # resolution level at which attention is applied.\nnum_res_blocks = 2\nchannels_multiply_factor = [\n    1,\n    1,\n    2,\n    2,\n    4,\n]  # how number of channels increase at each resolution level.\nvariational = False\nembedding_dimension = 4  # Dimension of the embedding vector, used for VAE. If variational is False, this is ignored.\n</pre> num_in_out_channels = 1  # Number of input and output channels, e.g. 1 for gray-scale images, 3 for RGB images. num_intermediate_channels = 32 num_z_channels = 4 attention_resolutions = [16]  # resolution level at which attention is applied. num_res_blocks = 2 channels_multiply_factor = [     1,     1,     2,     2,     4, ]  # how number of channels increase at each resolution level. variational = False embedding_dimension = 4  # Dimension of the embedding vector, used for VAE. If variational is False, this is ignored. In\u00a0[6]: Copied! <pre>kwargs = dict(\n    num_in_out_channels=num_in_out_channels,\n    num_intermediate_channels=num_intermediate_channels,\n    num_z_channels=num_z_channels,\n    attention_resolutions=attention_resolutions,\n    num_res_blocks=num_res_blocks,\n    resolution=crop_size[-1],\n    channels_multiply_factor=channels_multiply_factor,\n    device=\"cuda\" if torch.cuda.is_available() else \"mps\",\n    variational=variational,\n    embedding_dimension=embedding_dimension,  # Used for VAE.\n)\n</pre> kwargs = dict(     num_in_out_channels=num_in_out_channels,     num_intermediate_channels=num_intermediate_channels,     num_z_channels=num_z_channels,     attention_resolutions=attention_resolutions,     num_res_blocks=num_res_blocks,     resolution=crop_size[-1],     channels_multiply_factor=channels_multiply_factor,     device=\"cuda\" if torch.cuda.is_available() else \"mps\",     variational=variational,     embedding_dimension=embedding_dimension,  # Used for VAE. ) In\u00a0[7]: Copied! <pre>ModelClass = AutoencoderModel if num_spatial_dims == 2 else AutoencoderModel3d\nmodel = ModelClass(**kwargs)\n</pre> ModelClass = AutoencoderModel if num_spatial_dims == 2 else AutoencoderModel3d model = ModelClass(**kwargs) In\u00a0[8]: Copied! <pre>num_iterations = 100_000\nlearning_rate = 5e-5\nbatch_size = 8\nnum_workers = 2 if torch.cuda.is_available() else 0\n</pre> num_iterations = 100_000 learning_rate = 5e-5 batch_size = 8 num_workers = 2 if torch.cuda.is_available() else 0 <p>Now we can begin the training!  Uncomment the next few lines to train the model.</p> In\u00a0[9]: Copied! <pre># train_autoencoder(\n#    dataset=train_dataset,\n#    dataset_val=val_dataset,\n#    model=model,\n#    batch_size=batch_size,\n#    learning_rate=learning_rate,\n#    device=\"cuda\" if torch.cuda.is_available() else \"mps\",\n#    num_iterations=num_iterations,\n#    num_workers=num_workers,\n#    suffix=suffix,\n# )\n</pre> # train_autoencoder( #    dataset=train_dataset, #    dataset_val=val_dataset, #    model=model, #    batch_size=batch_size, #    learning_rate=learning_rate, #    device=\"cuda\" if torch.cuda.is_available() else \"mps\", #    num_iterations=num_iterations, #    num_workers=num_workers, #    suffix=suffix, # ) In\u00a0[10]: Copied! <pre>model_checkpoint = f\"autoencoder-2025-10-21-{suffix}/models_autoencoder/best.pth\"  # Path to a saved model checkpoint. Modify accordingly.\n</pre> model_checkpoint = f\"autoencoder-2025-10-21-{suffix}/models_autoencoder/best.pth\"  # Path to a saved model checkpoint. Modify accordingly. In\u00a0[11]: Copied! <pre>with open(detections_csv_file_name, newline=\"\") as f:\n    reader = csv.reader(f)\n    num_rows = sum(1 for row in reader) - 1  # subtract header row\nprint(f\"Number of detections in dataset is {num_rows}.\")\n</pre> with open(detections_csv_file_name, newline=\"\") as f:     reader = csv.reader(f)     num_rows = sum(1 for row in reader) - 1  # subtract header row print(f\"Number of detections in dataset is {num_rows}.\") <pre>Number of detections in dataset is 34059.\n</pre> In\u00a0[12]: Copied! <pre>test_dataset = ZarrCsvDatasetAutoencoder(\n    zarr_container_name=container_path,\n    detections_csv_file_name=detections_csv_file_name,\n    num_spatial_dims=num_spatial_dims,\n    crop_size=crop_size,\n    length=num_rows,\n    shuffle=False,\n)\n</pre> test_dataset = ZarrCsvDatasetAutoencoder(     zarr_container_name=container_path,     detections_csv_file_name=detections_csv_file_name,     num_spatial_dims=num_spatial_dims,     crop_size=crop_size,     length=num_rows,     shuffle=False, ) <pre>INFO:attrackt.autoencoder.zarr_csv_dataset_autoencoder:Loaded detections file ./data/HeLa//detections.csv.\n</pre> In\u00a0[13]: Copied! <pre>node_embedding_file_name = f\"embeddings-{suffix}.csv\"\n</pre> node_embedding_file_name = f\"embeddings-{suffix}.csv\" <p>Now we can begin the inference!  Uncomment the next few lines to infer using the trained model.</p> In\u00a0[14]: Copied! <pre># infer_autoencoder(\n#    dataset=test_dataset,\n#    model=model,\n#    model_checkpoint=model_checkpoint,\n#    device=\"cuda\" if torch.cuda.is_available() else \"mps\",\n#    output_csv_file_name=node_embedding_file_name,\n# )\n</pre> # infer_autoencoder( #    dataset=test_dataset, #    model=model, #    model_checkpoint=model_checkpoint, #    device=\"cuda\" if torch.cuda.is_available() else \"mps\", #    output_csv_file_name=node_embedding_file_name, # ) In\u00a0[15]: Copied! <pre>result_dir_name = f\"results-position-and-embeddings-{suffix}\"\ntest_sequence_names = [\"02\"]\nargs = {\n    \"num_nearest_neighbours\": 10,\n    \"direction_candidate_graph\": \"backward\",\n    \"pin_nodes\": True,\n    \"use_edge_distance\": True,\n    \"edge_embedding_exists\": True,\n    \"use_different_weights_hyper\": True,\n    \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},\n    \"test_csv_file_name\": detections_csv_file_name,\n    \"node_embedding_file_name\": node_embedding_file_name,\n    \"embedding_type\": \"distance\",\n    \"sequence_names\": test_sequence_names,\n    \"result_dir_name\": result_dir_name,\n    \"verbose\": False,\n}\n</pre> result_dir_name = f\"results-position-and-embeddings-{suffix}\" test_sequence_names = [\"02\"] args = {     \"num_nearest_neighbours\": 10,     \"direction_candidate_graph\": \"backward\",     \"pin_nodes\": True,     \"use_edge_distance\": True,     \"edge_embedding_exists\": True,     \"use_different_weights_hyper\": True,     \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},     \"test_csv_file_name\": detections_csv_file_name,     \"node_embedding_file_name\": node_embedding_file_name,     \"embedding_type\": \"distance\",     \"sequence_names\": test_sequence_names,     \"result_dir_name\": result_dir_name,     \"verbose\": False, } In\u00a0[16]: Copied! <pre>motile_infer(args)\n</pre> motile_infer(args) <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 02\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 25420\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\r 38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                               | 35/92 [00:00&lt;00:00, 343.77it/s]</pre> <pre>\r 76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                        | 70/92 [00:00&lt;00:00, 291.06it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 92/92 [00:00&lt;00:00, 348.14it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 252950\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 1463909\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 58.90307159221014\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 31.392316177621304\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 41.304285782009245\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 22.929073291146057\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 3.2603518962860107\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 4.264749050140381\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 2.7553412914276123\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 3.0214617252349854\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 190, max in edges: 141\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [1. 0. 1. 0. 1. 0. 1. 0. 0. 1. 1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 24825\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                             | 0/25094 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25094/25094 [00:00&lt;00:00, 316858.58it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 25420 out of 25420 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 25420 out of 25420 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                           | 0/25420 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25420/25420 [00:00&lt;00:00, 575672.80it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                        | 0/25094 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25094/25094 [00:00&lt;00:00, 907296.73it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                        | 0/25168 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25168/25168 [00:00&lt;00:00, 973543.02it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 677.5,\n              'DET': 1.0,\n              'LNK': 0.9820539309175673,\n              'TRA': 0.9976794130542007,\n              'fn_edges': 275,\n              'fn_nodes': 0,\n              'fp_edges': 201,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 64},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.803347280334728,\n                                 'Division Precision': 0.7137546468401487,\n                                 'Division Recall': 0.9186602870813397,\n                                 'False Negative Divisions': 16,\n                                 'False Positive Divisions': 76,\n                                 'Mitotic Branching Correctness': 0.6736842105263158,\n                                 'Total GT Divisions': 209,\n                                 'Total Predicted Divisions': 269,\n                                 'True Positive Divisions': 192,\n                                 'Wrong Children Divisions': 1}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-embeddings-HeLa-v1/02/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 02\n</pre> In\u00a0[17]: Copied! <pre>result_test_sequences = [\n    result_dir_name + \"/\" + test_sequence_name\n    for test_sequence_name in test_sequence_names\n]\n</pre> result_test_sequences = [     result_dir_name + \"/\" + test_sequence_name     for test_sequence_name in test_sequence_names ] In\u00a0[18]: Copied! <pre>cumulate_scores(sequence_names=result_test_sequences)\n</pre> cumulate_scores(sequence_names=result_test_sequences) <pre>AOGM | MBC | division_f1 | fp_divs | fn_divs | tp_divs | ws_edges | fp_edges | fn_edges | TRA\n677.500 | 0.674 | 0.803 | 76.000 | 16.000 | 192.000 | 64.000 | 201.000 | 275.000 | 0.998\n</pre>"},{"location":"examples/HeLa/02-autoencoder/#02-train-auto-encoder-model","title":"02 - Train auto-encoder model.\u00b6","text":"<p>This notebook performs the following steps:</p> <ol> <li>Train an autoencoder model Image crops centered on detections are extracted from the raw dataset and used to train the model. You can choose between:</li> </ol> <ul> <li>A standard autoencoder, trained using a reconstruction loss to reproduce the input crops.</li> <li>A variational autoencoder (VAE), trained using a combination of negative log-likelihood and KL divergence loss.</li> </ul> <ol> <li>Infer embeddings using the trained encoder</li> </ol> <ul> <li>For a standard autoencoder, the encoder\u2019s output is directly used as the embedding.</li> <li>For a variational autoencoder, the posterior mean is used as the embedding representation.</li> </ul>"},{"location":"examples/HeLa/02-autoencoder/#create-an-iterable-train-dataset","title":"Create an iterable, train dataset.\u00b6","text":"<p>It samples a random row from the detections file and extracts the image crop at that position.</p>"},{"location":"examples/HeLa/02-autoencoder/#create-model","title":"Create model\u00b6","text":""},{"location":"examples/HeLa/02-autoencoder/#train-model","title":"Train model\u00b6","text":""},{"location":"examples/HeLa/02-autoencoder/#infer-embeddings","title":"Infer embeddings\u00b6","text":"<p>Next, we use the trained model weights to infer the embeddings for each detection in the dataset.</p>"},{"location":"examples/HeLa/02-autoencoder/#compute-tracking-performance-using-dposition-and-dembedding-as-edge-costs","title":"Compute Tracking Performance using d(position) and d(embedding) as edge costs.\u00b6","text":"<p>Please ensure <code>gurobi</code> is installed for a faster solving experience.</p>"},{"location":"examples/HeLa/02-autoencoder/#cumulate-scores","title":"Cumulate scores\u00b6","text":""},{"location":"examples/HeLa/03-attrackt-unsupervised/","title":"03 - Train trackastra model with attrackt unsupervised loss.","text":"<p>Create a new dataset class that takes in the zarr container and the image and mask datasets.</p> In\u00a0[1]: Copied! <pre>from attrackt.trackastra.data import CTCZarrData\nimport torch\nfrom torch.utils.data import ConcatDataset\nfrom attrackt.trackastra.model import TrackingTransformer\nfrom functools import partial\nfrom attrackt.scripts.trackastra.train_fully_unsupervised import train\nfrom attrackt.scripts.trackastra.infer import infer\nfrom attrackt.scripts.motile import motile_infer\nfrom attrackt.scripts.cumulate_scores import cumulate_scores\nfrom attrackt.scripts.sort import sort\n</pre> from attrackt.trackastra.data import CTCZarrData import torch from torch.utils.data import ConcatDataset from attrackt.trackastra.model import TrackingTransformer from functools import partial from attrackt.scripts.trackastra.train_fully_unsupervised import train from attrackt.scripts.trackastra.infer import infer from attrackt.scripts.motile import motile_infer from attrackt.scripts.cumulate_scores import cumulate_scores from attrackt.scripts.sort import sort <pre>/Users/lalitm/miniforge3/envs/attrackt/lib/python3.10/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n  from .autonotebook import tqdm as notebook_tqdm\n</pre> In\u00a0[2]: Copied! <pre>suffix = \"HeLa-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed.\ndata_dir = \"./data/HeLa/\"\ndetections_csv = data_dir + \"/detections.csv\"\nembeddings_csv = f\"embeddings-{suffix}.csv\"\nsequences = [\"01\", \"02\"]\ntest_sequences = [\"02\"]\ncrop_size = (256, 256)\nzarr_path = data_dir + \"/HeLa.zarr\"\n</pre> suffix = \"HeLa-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed. data_dir = \"./data/HeLa/\" detections_csv = data_dir + \"/detections.csv\" embeddings_csv = f\"embeddings-{suffix}.csv\" sequences = [\"01\", \"02\"] test_sequences = [\"02\"] crop_size = (256, 256) zarr_path = data_dir + \"/HeLa.zarr\" In\u00a0[3]: Copied! <pre>ndim = 2\nwindow = 6\nmax_tokens = 2048\naugment = 2\nzarr_img_key = \"img\"\nzarr_mask_key = \"mask\"\nzarr_img_channel = 0\nzarr_mask_channel = 0\nn_jobs = 8\n</pre> ndim = 2 window = 6 max_tokens = 2048 augment = 2 zarr_img_key = \"img\" zarr_mask_key = \"mask\" zarr_img_channel = 0 zarr_mask_channel = 0 n_jobs = 8 In\u00a0[4]: Copied! <pre>ds_factory = partial(\n    CTCZarrData,\n    ndim=ndim,\n    window_size=window,\n    max_tokens=max_tokens,\n    augment=augment,\n    crop_size=crop_size,\n    zarr_path=zarr_path,\n    zarr_img_key=zarr_img_key,\n    zarr_mask_key=zarr_mask_key,\n    zarr_img_channel=zarr_img_channel,\n    zarr_mask_channel=zarr_mask_channel,\n    embeddings_csv=embeddings_csv,\n    n_jobs=n_jobs,\n)\n</pre> ds_factory = partial(     CTCZarrData,     ndim=ndim,     window_size=window,     max_tokens=max_tokens,     augment=augment,     crop_size=crop_size,     zarr_path=zarr_path,     zarr_img_key=zarr_img_key,     zarr_mask_key=zarr_mask_key,     zarr_img_channel=zarr_img_channel,     zarr_mask_channel=zarr_mask_channel,     embeddings_csv=embeddings_csv,     n_jobs=n_jobs, ) In\u00a0[5]: Copied! <pre>train_datasets = [ds_factory(zarr_sequence=seq) for seq in sequences]\nval_datasets = [\n    ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in sequences\n]\n</pre> train_datasets = [ds_factory(zarr_sequence=seq) for seq in sequences] val_datasets = [     ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in sequences ] <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/HeLa/HeLa.zarr (seq=01, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-HeLa-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  20%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                       | 18/92 [00:00&lt;00:00, 171.14it/s]</pre> <pre>\rNormalizing:  39%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                      | 36/92 [00:00&lt;00:00, 164.59it/s]</pre> <pre>\rNormalizing:  59%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                    | 54/92 [00:00&lt;00:00, 169.47it/s]</pre> <pre>\rNormalizing:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                    | 71/92 [00:00&lt;00:00, 169.64it/s]</pre> <pre>\rNormalizing:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 88/92 [00:00&lt;00:00, 167.38it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 49161 objects in 87 windows (6.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/HeLa/HeLa.zarr (seq=02, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-HeLa-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  20%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                       | 18/92 [00:00&lt;00:00, 178.16it/s]</pre> <pre>\rNormalizing:  42%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                   | 39/92 [00:00&lt;00:00, 195.65it/s]</pre> <pre>\rNormalizing:  66%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                              | 61/92 [00:00&lt;00:00, 204.56it/s]</pre> <pre>\rNormalizing:  90%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e        | 83/92 [00:00&lt;00:00, 208.77it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\rBuilding windows:  85%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d            | 74/87 [00:00&lt;00:00, 733.32it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 145106 objects in 87 windows (2.2s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/HeLa/HeLa.zarr (seq=01, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-HeLa-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  20%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                       | 18/92 [00:00&lt;00:00, 170.29it/s]</pre> <pre>\rNormalizing:  39%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                      | 36/92 [00:00&lt;00:00, 162.58it/s]</pre> <pre>\rNormalizing:  59%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                                    | 54/92 [00:00&lt;00:00, 168.01it/s]</pre> <pre>\rNormalizing:  77%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                    | 71/92 [00:00&lt;00:00, 166.97it/s]</pre> <pre>\rNormalizing:  96%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f   | 88/92 [00:00&lt;00:00, 165.10it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 49161 objects in 87 windows (2.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/HeLa/HeLa.zarr (seq=02, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-HeLa-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  21%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                      | 19/92 [00:00&lt;00:00, 184.84it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                  | 40/92 [00:00&lt;00:00, 194.20it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                             | 62/92 [00:00&lt;00:00, 203.61it/s]</pre> <pre>\rNormalizing:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 84/92 [00:00&lt;00:00, 208.55it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\rBuilding windows:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d             | 73/87 [00:00&lt;00:00, 727.95it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 145106 objects in 87 windows (2.1s)\n</pre> In\u00a0[6]: Copied! <pre>datasets = {\n    \"train\": ConcatDataset(train_datasets),\n    \"val\": ConcatDataset(val_datasets),\n}\n</pre> datasets = {     \"train\": ConcatDataset(train_datasets),     \"val\": ConcatDataset(val_datasets), } In\u00a0[7]: Copied! <pre>d_model = 256\nnum_encoder_layers = 6\nnum_decoder_layers = 6\nnhead = 4\npos_embed_per_dim = 32\nfeat_embed_per_dim = 8\nspatial_pos_cutoff = 256\nattn_positional_bias = \"rope\"\nattn_positional_bias_n_spatial = 16\ndropout = 0.1\ncausal_norm = \"quiet_softmax\"\n</pre> d_model = 256 num_encoder_layers = 6 num_decoder_layers = 6 nhead = 4 pos_embed_per_dim = 32 feat_embed_per_dim = 8 spatial_pos_cutoff = 256 attn_positional_bias = \"rope\" attn_positional_bias_n_spatial = 16 dropout = 0.1 causal_norm = \"quiet_softmax\" In\u00a0[8]: Copied! <pre>model = TrackingTransformer(\n    coord_dim=ndim,\n    feat_dim=datasets[\"train\"].datasets[0].feat_dim,\n    d_model=d_model,\n    pos_embed_per_dim=pos_embed_per_dim,\n    feat_embed_per_dim=feat_embed_per_dim,\n    num_encoder_layers=num_encoder_layers,\n    num_decoder_layers=num_decoder_layers,\n    dropout=dropout,\n    window=window,\n    spatial_pos_cutoff=spatial_pos_cutoff,\n    attn_positional_bias=attn_positional_bias,\n    attn_positional_bias_n_spatial=attn_positional_bias_n_spatial,\n    causal_norm=causal_norm,\n    nhead=nhead,\n)\n</pre> model = TrackingTransformer(     coord_dim=ndim,     feat_dim=datasets[\"train\"].datasets[0].feat_dim,     d_model=d_model,     pos_embed_per_dim=pos_embed_per_dim,     feat_embed_per_dim=feat_embed_per_dim,     num_encoder_layers=num_encoder_layers,     num_decoder_layers=num_decoder_layers,     dropout=dropout,     window=window,     spatial_pos_cutoff=spatial_pos_cutoff,     attn_positional_bias=attn_positional_bias,     attn_positional_bias_n_spatial=attn_positional_bias_n_spatial,     causal_norm=causal_norm,     nhead=nhead, ) In\u00a0[9]: Copied! <pre>num_iterations = 1000_000\nlearning_rate = 1e-4\nbatch_size = 8\nlambda_ = 0.1\nnum_workers = 2\nd_model = 64\n</pre> num_iterations = 1000_000 learning_rate = 1e-4 batch_size = 8 lambda_ = 0.1 num_workers = 2 d_model = 64 <p>Uncomment the next few lines to begin the training!</p> In\u00a0[10]: Copied! <pre># train(\n#    datasets=datasets,\n#    model=model,\n#    batch_size=batch_size,\n#    learning_rate=learning_rate,\n#    device=\"cuda\" if torch.cuda.is_available() else \"mps\",\n#    num_iterations=num_iterations,\n#    num_workers=num_workers,\n#    causal_norm=causal_norm,\n#    lambda_=lambda_,\n#    window=window,\n#    d_model=d_model,\n#    log_loss_every=1_000,\n#    suffix=suffix,\n# )\n</pre> # train( #    datasets=datasets, #    model=model, #    batch_size=batch_size, #    learning_rate=learning_rate, #    device=\"cuda\" if torch.cuda.is_available() else \"mps\", #    num_iterations=num_iterations, #    num_workers=num_workers, #    causal_norm=causal_norm, #    lambda_=lambda_, #    window=window, #    d_model=d_model, #    log_loss_every=1_000, #    suffix=suffix, # ) In\u00a0[11]: Copied! <pre>edge_embedding_file_name = f\"associations-{suffix}.csv\"\nmodel_checkpoint = f\"fully-unsupervised-2025-10-22-{suffix}/models/best/best.pth\"  # Path to a saved model checkpoint. Modify accordingly.\n</pre> edge_embedding_file_name = f\"associations-{suffix}.csv\" model_checkpoint = f\"fully-unsupervised-2025-10-22-{suffix}/models/best/best.pth\"  # Path to a saved model checkpoint. Modify accordingly. <p>Uncomment the next few lines to use the trained model to infer the associations!</p> In\u00a0[12]: Copied! <pre># infer(\n#    model_checkpoint= model_checkpoint,\n#    transformer=model,\n#    zarr_img_channel=0,\n#    zarr_img_key=\"img\",\n#    zarr_mask_channel=0,\n#    zarr_mask_key=\"mask\",\n#    zarr_path=data_dir + \"/HeLa.zarr\",\n#    test_zarr_sequences=test_sequences,\n#    output_csv_file_name=edge_embedding_file_name,\n#    edge_threshold=0.01,\n#    test_time_augmentation=True,\n# )\n</pre> # infer( #    model_checkpoint= model_checkpoint, #    transformer=model, #    zarr_img_channel=0, #    zarr_img_key=\"img\", #    zarr_mask_channel=0, #    zarr_mask_key=\"mask\", #    zarr_path=data_dir + \"/HeLa.zarr\", #    test_zarr_sequences=test_sequences, #    output_csv_file_name=edge_embedding_file_name, #    edge_threshold=0.01, #    test_time_augmentation=True, # ) In\u00a0[13]: Copied! <pre>result_dir_name = f\"results-position-and-associations-{suffix}\"\n</pre> result_dir_name = f\"results-position-and-associations-{suffix}\" In\u00a0[14]: Copied! <pre>args = {\n    \"num_nearest_neighbours\": 10,\n    \"direction_candidate_graph\": \"backward\",\n    \"pin_nodes\": True,\n    \"use_edge_distance\": True,\n    \"edge_embedding_exists\": True,\n    \"use_different_weights_hyper\": True,\n    \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},\n    \"test_csv_file_name\": detections_csv,\n    \"edge_embedding_file_name\": edge_embedding_file_name,\n    \"embedding_type\": \"affinity\",\n    \"sequence_names\": test_sequences,\n    \"result_dir_name\": result_dir_name,\n    \"verbose\": False,\n}\n</pre> args = {     \"num_nearest_neighbours\": 10,     \"direction_candidate_graph\": \"backward\",     \"pin_nodes\": True,     \"use_edge_distance\": True,     \"edge_embedding_exists\": True,     \"use_different_weights_hyper\": True,     \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},     \"test_csv_file_name\": detections_csv,     \"edge_embedding_file_name\": edge_embedding_file_name,     \"embedding_type\": \"affinity\",     \"sequence_names\": test_sequences,     \"result_dir_name\": result_dir_name,     \"verbose\": False, } In\u00a0[15]: Copied! <pre>motile_infer(args)\n</pre> motile_infer(args) <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 02\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 25420\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\r 38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                               | 35/92 [00:00&lt;00:00, 347.71it/s]</pre> <pre>\r 93%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e      | 86/92 [00:00&lt;00:00, 442.83it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 92/92 [00:00&lt;00:00, 279.84it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 252950\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 1463909\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 58.90307159221014\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 31.392316177621304\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 41.304285782009245\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 22.929073291146057\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.09629140656482318\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.27331626331799136\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.09226907825398349\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.17974097716387216\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 190, max in edges: 141\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 24974\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                             | 0/25225 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25225/25225 [00:00&lt;00:00, 315494.27it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 25420 out of 25420 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 25420 out of 25420 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                           | 0/25420 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25420/25420 [00:00&lt;00:00, 573129.11it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                        | 0/25225 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25225/25225 [00:00&lt;00:00, 921293.26it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                        | 0/25168 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25168/25168 [00:00&lt;00:00, 993835.67it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 229.0,\n              'DET': 1.0,\n              'LNK': 0.9939340962068235,\n              'TRA': 0.9992156244862169,\n              'fn_edges': 50,\n              'fn_nodes': 0,\n              'fp_edges': 107,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 47},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.8565217391304348,\n                                 'Division Precision': 0.7848605577689243,\n                                 'Division Recall': 0.9425837320574163,\n                                 'False Negative Divisions': 7,\n                                 'False Positive Divisions': 49,\n                                 'Mitotic Branching Correctness': 0.7635658914728682,\n                                 'Total GT Divisions': 209,\n                                 'Total Predicted Divisions': 251,\n                                 'True Positive Divisions': 197,\n                                 'Wrong Children Divisions': 5}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-associations-HeLa-v1/02/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 02\n</pre> In\u00a0[16]: Copied! <pre>sort(\n    detection_csv_file_name=detections_csv,\n    prediction_csv_file_name=edge_embedding_file_name,\n    ilp_csv_file_name=f\"{result_dir_name}/tracking_results.csv\",\n    output_csv_file_name=\"sorted.csv\",\n    method=\"confidence\",\n    sequences=test_sequences,\n    suffix=suffix,\n)\n</pre> sort(     detection_csv_file_name=detections_csv,     prediction_csv_file_name=edge_embedding_file_name,     ilp_csv_file_name=f\"{result_dir_name}/tracking_results.csv\",     output_csv_file_name=\"sorted.csv\",     method=\"confidence\",     sequences=test_sequences,     suffix=suffix, ) <pre>INFO:root:Sorted dictionary has 25420 keys.\n</pre> In\u00a0[17]: Copied! <pre># ## Cumulate scores\nresult_test_sequences = [\n    result_dir_name + \"/\" + test_sequence for test_sequence in test_sequences\n]\ncumulate_scores(sequence_names=result_test_sequences)\n</pre> # ## Cumulate scores result_test_sequences = [     result_dir_name + \"/\" + test_sequence for test_sequence in test_sequences ] cumulate_scores(sequence_names=result_test_sequences) <pre>AOGM | MBC | division_f1 | fp_divs | fn_divs | tp_divs | ws_edges | fp_edges | fn_edges | TRA\n229.000 | 0.764 | 0.857 | 49.000 | 7.000 | 197.000 | 47.000 | 107.000 | 50.000 | 0.999\n</pre>"},{"location":"examples/HeLa/03-attrackt-unsupervised/#03-train-trackastra-model-with-attrackt-unsupervised-loss","title":"03 - Train trackastra model with attrackt unsupervised loss.\u00b6","text":"<p>This notebook uses the zarr container (created in the first notebook) and the embeddings (exported to a csv in the second notebook) to train a trackastra model with the attrackt unsupervised loss.</p>"},{"location":"examples/HeLa/03-attrackt-unsupervised/#create-train-and-val-datasets","title":"Create train and val datasets.\u00b6","text":""},{"location":"examples/HeLa/03-attrackt-unsupervised/#create-model","title":"Create model\u00b6","text":""},{"location":"examples/HeLa/03-attrackt-unsupervised/#train-model","title":"Train model\u00b6","text":""},{"location":"examples/HeLa/03-attrackt-unsupervised/#infer-using-the-trained-model","title":"Infer using the trained model\u00b6","text":""},{"location":"examples/HeLa/03-attrackt-unsupervised/#compute-tracking-performance-using-dposition-and-predicted-associations-as-edge-costs","title":"Compute Tracking Performance using d(position) and predicted associations as edge costs.\u00b6","text":"<p>Please ensure <code>gurobi</code> is installed for a faster solving experience.</p>"},{"location":"examples/HeLa/03-attrackt-unsupervised/#sort-the-nodes-using-an-uncertainty-measure","title":"Sort the nodes using an uncertainty measure.\u00b6","text":""},{"location":"examples/HeLa/04-finetuning/","title":"04 - Fine-tune trackastra model with supervision on nodes.","text":"In\u00a0[1]: Copied! <pre>from attrackt.trackastra.data import CTCZarrData\nimport torch\nfrom torch.utils.data import ConcatDataset\nfrom attrackt.trackastra.model import TrackingTransformer\nfrom functools import partial\nfrom attrackt.scripts.trackastra.train_finetuned import train\nfrom attrackt.scripts.identify_valid_sequences import identify_valid_sequences\nfrom attrackt.scripts.motile import motile_infer\nfrom attrackt.scripts.cumulate_scores import cumulate_scores\nfrom attrackt.scripts.trackastra.infer_finetuned import infer\n</pre> from attrackt.trackastra.data import CTCZarrData import torch from torch.utils.data import ConcatDataset from attrackt.trackastra.model import TrackingTransformer from functools import partial from attrackt.scripts.trackastra.train_finetuned import train from attrackt.scripts.identify_valid_sequences import identify_valid_sequences from attrackt.scripts.motile import motile_infer from attrackt.scripts.cumulate_scores import cumulate_scores from attrackt.scripts.trackastra.infer_finetuned import infer <pre>/Users/lalitm/miniforge3/envs/attrackt/lib/python3.10/site-packages/tqdm/auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html\n  from .autonotebook import tqdm as notebook_tqdm\n</pre> In\u00a0[2]: Copied! <pre>suffix = \"HeLa-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed.\ndata_dir = \"./data/HeLa/\"\ndetections_csv = data_dir + \"/detections.csv\"\nembeddings_csv = f\"embeddings-{suffix}.csv\"\n</pre> suffix = \"HeLa-v1\"  # just a string placeholder to identify the model and results, in case running multiple experiments. You can modify as needed. data_dir = \"./data/HeLa/\" detections_csv = data_dir + \"/detections.csv\" embeddings_csv = f\"embeddings-{suffix}.csv\" In\u00a0[3]: Copied! <pre>sequences = [\"02\"]\ncrop_size = (256, 256)\nzarr_path = data_dir + \"/HeLa.zarr\"\n</pre> sequences = [\"02\"] crop_size = (256, 256) zarr_path = data_dir + \"/HeLa.zarr\" In\u00a0[4]: Copied! <pre>ndim = 2\nwindow = 6\nmax_tokens = 2048\naugment = 2\nzarr_img_key = \"img\"\nzarr_mask_key = \"mask\"\nzarr_img_channel = 0\nzarr_mask_channel = 0\nn_jobs = 8\n</pre> ndim = 2 window = 6 max_tokens = 2048 augment = 2 zarr_img_key = \"img\" zarr_mask_key = \"mask\" zarr_img_channel = 0 zarr_mask_channel = 0 n_jobs = 8 In\u00a0[5]: Copied! <pre>ds_factory = partial(\n    CTCZarrData,\n    ndim=ndim,\n    window_size=window,\n    max_tokens=max_tokens,\n    augment=augment,\n    crop_size=crop_size,\n    zarr_path=zarr_path,\n    zarr_img_key=zarr_img_key,\n    zarr_mask_key=zarr_mask_key,\n    zarr_img_channel=zarr_img_channel,\n    zarr_mask_channel=zarr_mask_channel,\n    embeddings_csv=embeddings_csv,\n    n_jobs=n_jobs,\n)\n</pre> ds_factory = partial(     CTCZarrData,     ndim=ndim,     window_size=window,     max_tokens=max_tokens,     augment=augment,     crop_size=crop_size,     zarr_path=zarr_path,     zarr_img_key=zarr_img_key,     zarr_mask_key=zarr_mask_key,     zarr_img_channel=zarr_img_channel,     zarr_mask_channel=zarr_mask_channel,     embeddings_csv=embeddings_csv,     n_jobs=n_jobs, ) In\u00a0[6]: Copied! <pre>train_unsupervised_datasets = [ds_factory(zarr_sequence=seq) for seq in sequences]\n</pre> train_unsupervised_datasets = [ds_factory(zarr_sequence=seq) for seq in sequences] <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/HeLa/HeLa.zarr (seq=02, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading embeddings from embeddings-HeLa-v1.csv\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  21%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                      | 19/92 [00:00&lt;00:00, 186.86it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                  | 40/92 [00:00&lt;00:00, 196.47it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                             | 62/92 [00:00&lt;00:00, 206.93it/s]</pre> <pre>\rNormalizing:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 84/92 [00:00&lt;00:00, 209.01it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\rBuilding windows:  84%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d             | 73/87 [00:00&lt;00:00, 720.84it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 145106 objects in 87 windows (6.4s)\n</pre> In\u00a0[7]: Copied! <pre># ## Create train and val supervised_datasets\nk = 100  # Number of supervised nodes! Choose one of {10, 100, 1000, 10000, 100000}\nsupervised_csv = f\"confidence-{suffix}/{k}/top/edges_sorted.csv\"\n</pre> # ## Create train and val supervised_datasets k = 100  # Number of supervised nodes! Choose one of {10, 100, 1000, 10000, 100000} supervised_csv = f\"confidence-{suffix}/{k}/top/edges_sorted.csv\" <p>identify valid sequences as those that have representation in the supervised_csv file</p> In\u00a0[8]: Copied! <pre>valid_sequences = identify_valid_sequences(sequences, supervised_csv)\n</pre> valid_sequences = identify_valid_sequences(sequences, supervised_csv) In\u00a0[9]: Copied! <pre>ds_factory = partial(\n    CTCZarrData,\n    ndim=ndim,\n    window_size=window,\n    max_tokens=max_tokens,\n    augment=augment,\n    crop_size=crop_size,\n    zarr_path=zarr_path,\n    zarr_img_key=zarr_img_key,\n    zarr_mask_key=zarr_mask_key,\n    zarr_img_channel=zarr_img_channel,\n    zarr_mask_channel=zarr_mask_channel,\n    supervised_csv=supervised_csv,\n    n_jobs=n_jobs,\n)\n</pre> ds_factory = partial(     CTCZarrData,     ndim=ndim,     window_size=window,     max_tokens=max_tokens,     augment=augment,     crop_size=crop_size,     zarr_path=zarr_path,     zarr_img_key=zarr_img_key,     zarr_mask_key=zarr_mask_key,     zarr_img_channel=zarr_img_channel,     zarr_mask_channel=zarr_mask_channel,     supervised_csv=supervised_csv,     n_jobs=n_jobs, ) In\u00a0[10]: Copied! <pre>train_supervised_datasets = [ds_factory(zarr_sequence=seq) for seq in valid_sequences]\nval_supervised_datasets = [\n    ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in valid_sequences\n]\n</pre> train_supervised_datasets = [ds_factory(zarr_sequence=seq) for seq in valid_sequences] val_supervised_datasets = [     ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in valid_sequences ] <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/HeLa/HeLa.zarr (seq=02, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-HeLa-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 95 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  21%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                      | 19/92 [00:00&lt;00:00, 187.40it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                  | 40/92 [00:00&lt;00:00, 193.95it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                             | 62/92 [00:00&lt;00:00, 204.38it/s]</pre> <pre>\rNormalizing:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 84/92 [00:00&lt;00:00, 207.99it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 145106 objects in 87 windows (2.0s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/HeLa/HeLa.zarr (seq=02, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-HeLa-v1/100/top/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 95 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  21%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                      | 19/92 [00:00&lt;00:00, 183.22it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                  | 40/92 [00:00&lt;00:00, 197.14it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                             | 62/92 [00:00&lt;00:00, 206.95it/s]</pre> <pre>\rNormalizing:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 84/92 [00:00&lt;00:00, 209.73it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 145106 objects in 87 windows (2.0s)\n</pre> In\u00a0[11]: Copied! <pre># ## Create train and val pseudo-supervised datasets\npseudo_supervised_csv = f\"confidence-{suffix}/{k}/bottom/edges_sorted.csv\"\n</pre> # ## Create train and val pseudo-supervised datasets pseudo_supervised_csv = f\"confidence-{suffix}/{k}/bottom/edges_sorted.csv\" In\u00a0[12]: Copied! <pre>valid_sequences = identify_valid_sequences(sequences, pseudo_supervised_csv)\nds_factory = partial(\n    CTCZarrData,\n    ndim=ndim,\n    window_size=window,\n    max_tokens=max_tokens,\n    augment=augment,\n    crop_size=crop_size,\n    zarr_path=zarr_path,\n    zarr_img_key=zarr_img_key,\n    zarr_mask_key=zarr_mask_key,\n    zarr_img_channel=zarr_img_channel,\n    zarr_mask_channel=zarr_mask_channel,\n    supervised_csv=pseudo_supervised_csv,\n    n_jobs=n_jobs,\n)\n</pre> valid_sequences = identify_valid_sequences(sequences, pseudo_supervised_csv) ds_factory = partial(     CTCZarrData,     ndim=ndim,     window_size=window,     max_tokens=max_tokens,     augment=augment,     crop_size=crop_size,     zarr_path=zarr_path,     zarr_img_key=zarr_img_key,     zarr_mask_key=zarr_mask_key,     zarr_img_channel=zarr_img_channel,     zarr_mask_channel=zarr_mask_channel,     supervised_csv=pseudo_supervised_csv,     n_jobs=n_jobs, ) In\u00a0[13]: Copied! <pre>train_pseudo_supervised_datasets = [\n    ds_factory(zarr_sequence=seq) for seq in valid_sequences\n]\nval_pseudo_supervised_datasets = [\n    ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in valid_sequences\n]\n</pre> train_pseudo_supervised_datasets = [     ds_factory(zarr_sequence=seq) for seq in valid_sequences ] val_pseudo_supervised_datasets = [     ds_factory(zarr_sequence=seq, augment=0, crop_size=None) for seq in valid_sequences ] <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/HeLa/HeLa.zarr (seq=02, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-HeLa-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 2165 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  21%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                      | 19/92 [00:00&lt;00:00, 185.34it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                  | 40/92 [00:00&lt;00:00, 195.97it/s]</pre> <pre>\rNormalizing:  67%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                             | 62/92 [00:00&lt;00:00, 204.15it/s]</pre> <pre>\rNormalizing:  91%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e       | 84/92 [00:00&lt;00:00, 208.18it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 145106 objects in 87 windows (1.9s)\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Using Zarr at data/HeLa/HeLa.zarr (seq=02, img=img[ch=0], mask=mask[ch=0])\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loading supervised labels from confidence-HeLa-v1/100/bottom/edges_sorted.csv\n</pre> <pre>INFO:attrackt.trackastra.data.ctc_zarr_data:Loaded 2165 supervised links.\n</pre> <pre>\rNormalizing:   0%|                                                                                                   | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\rNormalizing:  21%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                                                                      | 19/92 [00:00&lt;00:00, 186.27it/s]</pre> <pre>\rNormalizing:  43%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                                                  | 40/92 [00:00&lt;00:00, 196.20it/s]</pre> <pre>\rNormalizing:  68%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2589                            | 63/92 [00:00&lt;00:00, 207.42it/s]</pre> <pre>\rNormalizing:  92%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f      | 85/92 [00:00&lt;00:00, 211.23it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:DET MASK: Using Zarr masks\n</pre> <pre>\rBuilding windows:   0%|                                                                                              | 0/87 [00:00&lt;?, ?it/s]</pre> <pre>\r                                                                                                                                            </pre> <pre>\rINFO:attrackt.trackastra.data.ctc_zarr_data:Found 145106 objects in 87 windows (2.0s)\n</pre> In\u00a0[14]: Copied! <pre>datasets = {\n    \"train_unsupervised\": ConcatDataset(train_unsupervised_datasets),\n    \"train_supervised\": ConcatDataset(train_supervised_datasets),\n    \"val_supervised\": ConcatDataset(val_supervised_datasets),\n    \"train_pseudo_supervised\": ConcatDataset(train_pseudo_supervised_datasets),\n    \"val_pseudo_supervised\": ConcatDataset(val_pseudo_supervised_datasets),\n}\n</pre> datasets = {     \"train_unsupervised\": ConcatDataset(train_unsupervised_datasets),     \"train_supervised\": ConcatDataset(train_supervised_datasets),     \"val_supervised\": ConcatDataset(val_supervised_datasets),     \"train_pseudo_supervised\": ConcatDataset(train_pseudo_supervised_datasets),     \"val_pseudo_supervised\": ConcatDataset(val_pseudo_supervised_datasets), } In\u00a0[15]: Copied! <pre>d_model = 256\nnum_encoder_layers = 6\nnum_decoder_layers = 6\nnhead = 4\npos_embed_per_dim = 32\nfeat_embed_per_dim = 8\nspatial_pos_cutoff = 256\nattn_positional_bias = \"rope\"\nattn_positional_bias_n_spatial = 16\ndropout = 0.1\ncausal_norm = \"quiet_softmax\"\n</pre> d_model = 256 num_encoder_layers = 6 num_decoder_layers = 6 nhead = 4 pos_embed_per_dim = 32 feat_embed_per_dim = 8 spatial_pos_cutoff = 256 attn_positional_bias = \"rope\" attn_positional_bias_n_spatial = 16 dropout = 0.1 causal_norm = \"quiet_softmax\" In\u00a0[16]: Copied! <pre>model = TrackingTransformer(\n    coord_dim=ndim,\n    feat_dim=datasets[\"train_unsupervised\"].datasets[0].feat_dim,\n    d_model=d_model,\n    pos_embed_per_dim=pos_embed_per_dim,\n    feat_embed_per_dim=feat_embed_per_dim,\n    num_encoder_layers=num_encoder_layers,\n    num_decoder_layers=num_decoder_layers,\n    dropout=dropout,\n    window=window,\n    spatial_pos_cutoff=spatial_pos_cutoff,\n    attn_positional_bias=attn_positional_bias,\n    attn_positional_bias_n_spatial=attn_positional_bias_n_spatial,\n    causal_norm=causal_norm,\n    nhead=nhead,\n)\n</pre> model = TrackingTransformer(     coord_dim=ndim,     feat_dim=datasets[\"train_unsupervised\"].datasets[0].feat_dim,     d_model=d_model,     pos_embed_per_dim=pos_embed_per_dim,     feat_embed_per_dim=feat_embed_per_dim,     num_encoder_layers=num_encoder_layers,     num_decoder_layers=num_decoder_layers,     dropout=dropout,     window=window,     spatial_pos_cutoff=spatial_pos_cutoff,     attn_positional_bias=attn_positional_bias,     attn_positional_bias_n_spatial=attn_positional_bias_n_spatial,     causal_norm=causal_norm,     nhead=nhead, ) In\u00a0[17]: Copied! <pre>learning_rate = 1e-4\nbatch_size = 8\nlambda_ = 0.1\nnum_iterations = 100 * k\nnum_workers = 2\nd_model = 64\nunsupervised_model_checkpoint = f\"fully-unsupervised-2025-10-11-{suffix}/models/best/best.pth\"  # Path to a saved model checkpoint. Modify accordingly.\ndo_lora = True\nlora_r = 32\nlora_alpha = 32\nlora_dropout = 0.1\n</pre> learning_rate = 1e-4 batch_size = 8 lambda_ = 0.1 num_iterations = 100 * k num_workers = 2 d_model = 64 unsupervised_model_checkpoint = f\"fully-unsupervised-2025-10-11-{suffix}/models/best/best.pth\"  # Path to a saved model checkpoint. Modify accordingly. do_lora = True lora_r = 32 lora_alpha = 32 lora_dropout = 0.1 In\u00a0[18]: Copied! <pre># train(\n#    datasets=datasets,\n#    model=model,\n#    checkpoint_path=unsupervised_model_checkpoint,\n#    batch_size=batch_size,\n#    learning_rate=learning_rate,\n#    device=\"cuda\" if torch.cuda.is_available() else \"mps\",\n#    num_iterations=num_iterations,\n#    num_workers=num_workers,\n#    causal_norm=causal_norm,\n#    lambda_=lambda_,\n#    window=window,\n#    d_model=d_model,\n#    do_lora=do_lora,\n#    lora_r=lora_r,\n#    lora_alpha=lora_alpha,\n#    lora_dropout=lora_dropout,\n#    suffix=suffix,\n# )\n</pre> # train( #    datasets=datasets, #    model=model, #    checkpoint_path=unsupervised_model_checkpoint, #    batch_size=batch_size, #    learning_rate=learning_rate, #    device=\"cuda\" if torch.cuda.is_available() else \"mps\", #    num_iterations=num_iterations, #    num_workers=num_workers, #    causal_norm=causal_norm, #    lambda_=lambda_, #    window=window, #    d_model=d_model, #    do_lora=do_lora, #    lora_r=lora_r, #    lora_alpha=lora_alpha, #    lora_dropout=lora_dropout, #    suffix=suffix, # ) In\u00a0[19]: Copied! <pre>associations_csv = f\"finetuned-associations-{k}-{suffix}.csv\"\nfinetuned_model_checkpoint_dir = f\"finetuned-2025-10-11-{suffix}/models/last/\"\n# Path to finetuned model checkpoint directory. Modify accordingly.\n</pre> associations_csv = f\"finetuned-associations-{k}-{suffix}.csv\" finetuned_model_checkpoint_dir = f\"finetuned-2025-10-11-{suffix}/models/last/\" # Path to finetuned model checkpoint directory. Modify accordingly. In\u00a0[20]: Copied! <pre># infer(\n#    unsupervised_model_checkpoint=unsupervised_model_checkpoint,\n#    transformer=model,\n#    finetuned_model_checkpoint_dir=finetuned_model_checkpoint_dir,\n#    zarr_img_channel=zarr_img_channel,\n#    zarr_img_key=zarr_img_key,\n#    zarr_mask_channel=zarr_mask_channel,\n#    zarr_mask_key=zarr_mask_key,\n#    zarr_path=zarr_path,\n#    test_zarr_sequences=sequences,\n#    output_csv_file_name=associations_csv,\n# )\n</pre> # infer( #    unsupervised_model_checkpoint=unsupervised_model_checkpoint, #    transformer=model, #    finetuned_model_checkpoint_dir=finetuned_model_checkpoint_dir, #    zarr_img_channel=zarr_img_channel, #    zarr_img_key=zarr_img_key, #    zarr_mask_channel=zarr_mask_channel, #    zarr_mask_key=zarr_mask_key, #    zarr_path=zarr_path, #    test_zarr_sequences=sequences, #    output_csv_file_name=associations_csv, # ) In\u00a0[21]: Copied! <pre>result_dir_name = f\"results-position-and-finetuned-associations-{suffix}\"\n</pre> result_dir_name = f\"results-position-and-finetuned-associations-{suffix}\" In\u00a0[22]: Copied! <pre>args = {\n    \"num_nearest_neighbours\": 10,\n    \"direction_candidate_graph\": \"backward\",\n    \"pin_nodes\": True,\n    \"use_edge_distance\": True,\n    \"edge_embedding_exists\": True,\n    \"use_different_weights_hyper\": True,\n    \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},\n    \"test_csv_file_name\": detections_csv,\n    \"edge_embedding_file_name\": associations_csv,\n    \"embedding_type\": \"affinity\",\n    \"sequence_names\": sequences,\n    \"supervised_csv\": supervised_csv,\n    \"result_dir_name\": result_dir_name,\n    \"verbose\": False,\n}\n</pre> args = {     \"num_nearest_neighbours\": 10,     \"direction_candidate_graph\": \"backward\",     \"pin_nodes\": True,     \"use_edge_distance\": True,     \"edge_embedding_exists\": True,     \"use_different_weights_hyper\": True,     \"voxel_size\": {\"x\": 1.0, \"y\": 1.0},     \"test_csv_file_name\": detections_csv,     \"edge_embedding_file_name\": associations_csv,     \"embedding_type\": \"affinity\",     \"sequence_names\": sequences,     \"supervised_csv\": supervised_csv,     \"result_dir_name\": result_dir_name,     \"verbose\": False, } In\u00a0[23]: Copied! <pre>motile_infer(args)\n</pre> motile_infer(args) <pre>INFO:attrackt.scripts.motile.motile_infer:Processing sequence: 02\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting nodes from points list\n</pre> <pre>INFO:motile_toolbox.candidate_graph.compute_graph:Candidate nodes: 25420\n</pre> <pre>INFO:motile_toolbox.candidate_graph.utils:Extracting candidate edges\n</pre> <pre>\r  0%|                                                                                                                | 0/92 [00:00&lt;?, ?it/s]</pre> <pre>\r 38%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                                                               | 35/92 [00:00&lt;00:00, 344.60it/s]</pre> <pre>\r 76%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                        | 70/92 [00:00&lt;00:00, 218.27it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 92/92 [00:00&lt;00:00, 276.72it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.motile_infer:Flipping edges (backward direction)\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 252950\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nTrack Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:num_edges: 1463909\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_distance: 58.90307159221014\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_distance: 31.392316177621304\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_distance: 41.304285782009245\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_distance: 22.929073291146057\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nCandidate Graph Stats\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_regular_edge_embedding_distance: 0.0992900592731218\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_regular_edge_embedding_distance: 0.2907450637149937\n</pre> <pre>INFO:attrackt.scripts.motile.utils:mean_hyper_edge_embedding_distance: 0.09507836452493762\n</pre> <pre>INFO:attrackt.scripts.motile.utils:std_hyper_edge_embedding_distance: 0.1913965397067516\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Number of keys in supervised dictionary is 95.\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Max out edges: 190, max in edges: 141\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding EdgeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding NodeSelected variables...\n</pre> <pre>INFO:motile.solver:Adding Edge Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Regular cost...\n</pre> <pre>INFO:motile.solver:Adding Edge Embedding Distance Hyper cost...\n</pre> <pre>INFO:motile.solver:Adding Appear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeAppear variables...\n</pre> <pre>INFO:motile.solver:Adding Disappear cost...\n</pre> <pre>INFO:motile.solver:Adding NodeDisappear variables...\n</pre> <pre>INFO:motile.solver:Adding MaxParents constraint...\n</pre> <pre>INFO:motile.solver:Adding MaxChildren constraint...\n</pre> <pre>INFO:motile.solver:Adding Pin constraint...\n</pre> <pre>INFO:attrackt.scripts.motile.utils:Extracted weights: [ 1.  0.  1.  0. -1.  0. -1.  0.  0.  1.  1.]\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Solving ILP optimization...\n</pre> <pre>INFO:motile.solver:Computing costs...\n</pre> <pre>Set parameter NonConvex to value 2\n</pre> <pre>INFO:gurobipy:Set parameter NonConvex to value 2\n</pre> <pre>Set parameter Threads to value 1\n</pre> <pre>INFO:gurobipy:Set parameter Threads to value 1\n</pre> <pre>INFO:motile.solver:ILP solver returned with: OPTIMAL\n</pre> <pre>INFO:attrackt.scripts.motile.utils:====================\nOptimization Result\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_nodes: 25420\n</pre> <pre>INFO:attrackt.scripts.motile.utils:selected_edges: 24971\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Saving result and computing metrics...\n</pre> <pre>\r  0%|                                                                                                             | 0/25218 [00:00&lt;?, ?it/s]</pre> <pre>\r100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25218/25218 [00:00&lt;00:00, 315900.33it/s]</pre> <pre>\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using ground truth NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Using predicted NetworkX graph...\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Running CTC and Division metrics...\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 25420 out of 25420 ground truth nodes.\n</pre> <pre>INFO:traccuracy.matchers._base:Matched 25420 out of 25420 predicted nodes.\n</pre> <pre>\rEvaluating nodes:   0%|                                                                                           | 0/25420 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating nodes: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25420/25420 [00:00&lt;00:00, 564098.91it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FP edges:   0%|                                                                                        | 0/25218 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FP edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25218/25218 [00:00&lt;00:00, 909092.11it/s]</pre> <pre>\n</pre> <pre>\rEvaluating FN edges:   0%|                                                                                        | 0/25168 [00:00&lt;?, ?it/s]</pre> <pre>\rEvaluating FN edges: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 25168/25168 [00:00&lt;00:00, 971634.36it/s]</pre> <pre>\nINFO:attrackt.scripts.motile.run_traccuracy:Results:\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:[{'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'e_weights': {'fn': 1.5, 'fp': 1, 'ws': 1},\n             'name': 'CTCMetrics',\n             'v_weights': {'fn': 10, 'fp': 1, 'ns': 5},\n             'valid_match_types': ['one-to-one', 'many-to-one']},\n  'pred': 'pred',\n  'results': {'AOGM': 195.0,\n              'DET': 1.0,\n              'LNK': 0.9948347107438017,\n              'TRA': 0.9993320819860799,\n              'fn_edges': 44,\n              'fn_nodes': 0,\n              'fp_edges': 94,\n              'fp_nodes': 0,\n              'ns_nodes': 0,\n              'ws_edges': 35},\n  'version': '0.3.0'},\n {'gt': 'gt',\n  'matcher': {'_matching_type': 'one-to-one',\n              'matching type': 'one-to-one',\n              'name': 'PointMatcher',\n              'scale_factor': None,\n              'threshold': 10},\n  'metric': {'frame_buffer': 0,\n             'name': 'DivisionMetrics',\n             'valid_match_types': ['one-to-one']},\n  'pred': 'pred',\n  'results': {'Frame Buffer 0': {'Division F1': 0.8991228070175439,\n                                 'Division Precision': 0.8299595141700404,\n                                 'Division Recall': 0.9808612440191388,\n                                 'False Negative Divisions': 3,\n                                 'False Positive Divisions': 41,\n                                 'Mitotic Branching Correctness': 0.82,\n                                 'Total GT Divisions': 209,\n                                 'Total Predicted Divisions': 247,\n                                 'True Positive Divisions': 205,\n                                 'Wrong Children Divisions': 1}},\n  'version': '0.3.0'}]\n</pre> <pre>INFO:attrackt.scripts.motile.run_traccuracy:Results saved to: results-position-and-finetuned-associations-HeLa-v1/02/results.json\n</pre> <pre>INFO:attrackt.scripts.motile.motile_infer:Finished processing: 02\n</pre> In\u00a0[24]: Copied! <pre>result_sequences = [result_dir_name + \"/\" + sequence for sequence in sequences]\ncumulate_scores(sequence_names=result_sequences)\n</pre> result_sequences = [result_dir_name + \"/\" + sequence for sequence in sequences] cumulate_scores(sequence_names=result_sequences) <pre>AOGM | MBC | division_f1 | fp_divs | fn_divs | tp_divs | ws_edges | fp_edges | fn_edges | TRA\n195.000 | 0.820 | 0.899 | 41.000 | 3.000 | 205.000 | 35.000 | 94.000 | 44.000 | 0.999\n</pre>"},{"location":"examples/HeLa/04-finetuning/#04-fine-tune-trackastra-model-with-supervision-on-k-nodes","title":"04 - Fine-tune trackastra model with supervision on <code>k</code> nodes.\u00b6","text":"<p>This notebook uses the zarr container (created in the first notebook), the embeddings (exported to a csv in the second notebook), and the model trained with unsupervised loss (in the third notebook) to fine-tune the model weights with GT supervision.</p>"},{"location":"examples/HeLa/04-finetuning/#create-train-and-val-unsupervised-datasets","title":"Create train and val unsupervised datasets\u00b6","text":""},{"location":"examples/HeLa/04-finetuning/#create-model","title":"Create model\u00b6","text":""},{"location":"examples/HeLa/04-finetuning/#train-model","title":"Train model\u00b6","text":""},{"location":"examples/HeLa/04-finetuning/#compute-tracking-performance-using-dposition-and-predicted-associations-as-edge-costs","title":"Compute Tracking Performance using d(position) and predicted associations as edge costs.\u00b6","text":"<p>Please ensure <code>gurobi</code> is installed for a faster solving experience.</p>"},{"location":"examples/HeLa/04-finetuning/#cumulate-scores","title":"Cumulate scores\u00b6","text":""}]}